<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Developer Documentation · Korg</title><meta name="title" content="Developer Documentation · Korg"/><meta property="og:title" content="Developer Documentation · Korg"/><meta property="twitter:title" content="Developer Documentation · Korg"/><meta name="description" content="Documentation for Korg."/><meta property="og:description" content="Documentation for Korg."/><meta property="twitter:description" content="Documentation for Korg."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Korg logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Korg</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Quickstart</a></li><li><a class="tocitem" href="../install/">Install</a></li><li><a class="tocitem" href="../tutorials/">Tutorials</a></li><li><a class="tocitem" href="../API/">High-level API</a></li><li><a class="tocitem" href="../FAQ/">FAQ</a></li><li><a class="tocitem" href="../changelog/">Changelog</a></li><li class="is-active"><a class="tocitem" href>Developer Documentation</a><ul class="internal"><li><a class="tocitem" href="#Julia-development"><span>Julia development</span></a></li><li><a class="tocitem" href="#Code-guidelines"><span>Code guidelines</span></a></li><li><a class="tocitem" href="#Continuum-absorption"><span>Continuum absorption</span></a></li><li><a class="tocitem" href="#Manifest.toml-and-Project.toml"><span><code>Manifest.toml</code> and <code>Project.toml</code></span></a></li><li><a class="tocitem" href="#Where-to-put-data"><span>Where to put data</span></a></li><li><a class="tocitem" href="#Complete-API"><span>Complete API</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Developer Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Developer Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ajwheeler/Korg.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ajwheeler/Korg.jl/blob/main/docs/src/devdocs.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Developer-documentation"><a class="docs-heading-anchor" href="#Developer-documentation">Developer documentation</a><a id="Developer-documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Developer-documentation" title="Permalink"></a></h1><p>This page contains info for people interested in contributing code to Korg.  If you  have questions, do not hesitate to ask.</p><h2 id="Julia-development"><a class="docs-heading-anchor" href="#Julia-development">Julia development</a><a id="Julia-development-1"></a><a class="docs-heading-anchor-permalink" href="#Julia-development" title="Permalink"></a></h2><p>If you&#39;ve never developed a package in Julia, here are some tips.</p><ul><li>Once you have a local copy of Korg, you can make it importable locally by <code>dev</code>ing it from the Julia environment in which you would like to run it: <code>Pkg.dev(&quot;/path/to/Korg&quot;)</code>.  If you run <code>Pkg.dev(&quot;Korg&quot;)</code> instead, Julia will automatically clone the repo to <code>~/.julia/dev/Korg</code>.  (See the <a href="https://pkgdocs.julialang.org/">Pkg documentation</a> for details.)</li><li>When working on your local copy of Korg, <a href="https://github.com/timholy/Revise.jl">Revise</a> is easiest way to make and test changes without constantly restarting your Julia session.</li><li>To run the test suite locally, start a Julia session in the Korg root directory and run <code>]activate .</code> then <code>test</code>.  This will automatically run <code>test/runtests.jl</code> in the test environment.</li><li>Documentation is generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documentor</a>. Continuous integration on github will ensure that the documentation is generated without errors, but it won&#39;t catch all formatting problems.  If you wish to generate documentation locally in order to check that everything is as expected, start a Julia session in <code>Korg/docs</code>, activate the test environment (<code>]activate .</code>), and run <code>instantiate</code>.  This downloads and installs the docs dependences, and will only have to be run once.  To generate documentation, run <code>julia --project make.jl</code> on the command line (the <code>--project</code> flag activates the local environment).  The generated docs can be served from <code>docs/build</code>.</li></ul><h2 id="Code-guidelines"><a class="docs-heading-anchor" href="#Code-guidelines">Code guidelines</a><a id="Code-guidelines-1"></a><a class="docs-heading-anchor-permalink" href="#Code-guidelines" title="Permalink"></a></h2><ul><li>Try to be explicit about units throughout the code, particularly when not using CGS.</li><li>Whenever possible, calculations should be precise up to a factor of <span>$10^{-3}$</span>.  When it&#39;s easy and inexpensive, they should be precise to <span>$10^{-5}$</span> or better.  There are exceptions to this (e.g. the Voigt function), but ideally they will eventually be vanquished.</li><li>Ensure types are generic enough to support dual numbers and autodifferentiation. </li><li>Limit lines to 100 characters.</li><li>Use ASCII characters in the names of functions that are part of the public API.</li><li>Unless they will never be called elsewhere, provide docstrings describing the inputs, assumptions and outputs of any functions you write.</li></ul><h2 id="Continuum-absorption"><a class="docs-heading-anchor" href="#Continuum-absorption">Continuum absorption</a><a id="Continuum-absorption-1"></a><a class="docs-heading-anchor-permalink" href="#Continuum-absorption" title="Permalink"></a></h2><h3 id="Continuum-Absorption-Kwargs"><a class="docs-heading-anchor" href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a><a id="Continuum-Absorption-Kwargs-1"></a><a class="docs-heading-anchor-permalink" href="#Continuum-Absorption-Kwargs" title="Permalink"></a></h3><p>All bound-free and free-free absorption functions (other than <code>absorption_coef_bf_TOPBase</code>) support the following keyword arguments:</p><ul><li><code>error_oobounds::Bool</code>: specifies the function&#39;s behavior when it encounters invalid <code>ν</code> or <code>T</code> values. When <code>false</code> (the default), the function assumes that the absorption coefficient for these invalid <code>ν</code> or <code>T</code> values is <code>0.0</code>. Otherwise, a <code>DomainError</code> is thrown when invalid <code>ν</code> or <code>T</code> values are encountered.</li><li><code>out_α::Union{Nothing,AbstractVector}</code>: When this is <code>nothing</code> (the default case), the function will simply allocate a new vector to store the output continuum absorption coefficients. Alternatively, this can be a vector (with the same length as the function&#39;s <code>ν</code> argument). In this case, the function will directly add the computed continuum absorption to the elements of this vector, in-place (the vector is also returned by the function).</li></ul><h3 id="Steps-for-implementing-new-continuum-sources-of-absorption:"><a class="docs-heading-anchor" href="#Steps-for-implementing-new-continuum-sources-of-absorption:">Steps for implementing new continuum sources of absorption:</a><a id="Steps-for-implementing-new-continuum-sources-of-absorption:-1"></a><a class="docs-heading-anchor-permalink" href="#Steps-for-implementing-new-continuum-sources-of-absorption:" title="Permalink"></a></h3><ul><li>Define a helper function that computes a single absorption coefficient (in units of cm⁻²). The function should accept <code>ν</code> (in Hz) and <code>T</code> (in K) as the first and second arguments, respectively. The convention is for it should share a name with the corresponding public function, but have an underscore pre-appended (e.g. we define <code>_H_I_bf</code> to help implement <code>H_I_bf</code>).</li><li>The public function is the function constructed and returned by <code>Korg.ContinuumAbsorption.bounds_checked_absorption</code> that wraps the above helper function. This wrapper function implements bounds-checking for <code>ν</code> and <code>T</code> and supports the keyword arguments described in <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</li><li>Add a docstring describing the new function. At the very least, please describe any non-standard arguments and include a reference in the docstring to the source where the function was taken from.</li><li>Add a line to <code>doc/src/API.md</code> under the <code>Continuum absorption</code> heading to render the docstring of your new function.</li><li>Add a line to <code>total_continuum_absorption</code> that calls the new public function for absorption.</li></ul><p>The first two steps may not apply for sources that don&#39;t directly depend on <code>ν</code> and <code>T</code> (e.g. absorption from scattering).</p><h2 id="Manifest.toml-and-Project.toml"><a class="docs-heading-anchor" href="#Manifest.toml-and-Project.toml"><code>Manifest.toml</code> and <code>Project.toml</code></a><a id="Manifest.toml-and-Project.toml-1"></a><a class="docs-heading-anchor-permalink" href="#Manifest.toml-and-Project.toml" title="Permalink"></a></h2><p><a href="https://pkgdocs.julialang.org/v1/toml-files/">Read more about these files here.</a> These files are used by the julia package manager.  <code>Project.toml</code> records dependencies, and you&#39;ll  notice that the test and docs directories have their own <code>Project.toml</code>s for test and  documentation-specific dependencies.  <code>Manifest.toml</code> records exact package versions used when a  package was run.  It enables someone else to reproduce the exact environment and results later.   There are a few directories containing scripts that generate Korg&#39;s data files which have there own  <code>Projects.toml</code>s and <code>Manifest.toml</code>s, for example <code>data/bf_cross-sections/</code>.</p><h2 id="Where-to-put-data"><a class="docs-heading-anchor" href="#Where-to-put-data">Where to put data</a><a id="Where-to-put-data-1"></a><a class="docs-heading-anchor-permalink" href="#Where-to-put-data" title="Permalink"></a></h2><p>If you are adding data to Korg, <code>data/README</code> provides an overview of the options and how to decide  between them.</p><h2 id="Complete-API"><a class="docs-heading-anchor" href="#Complete-API">Complete API</a><a id="Complete-API-1"></a><a class="docs-heading-anchor-permalink" href="#Complete-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg._alpha_5000_default_linelist" href="#Korg._alpha_5000_default_linelist"><code>Korg._alpha_5000_default_linelist</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The default linelist for calculating the absorption coefficient at 5000 Å.  This for internal use when the provided linelist doesn&#39;t cover the region and a radiative transfer scheme using τ_5000 is used.</p><p>See also <a href="#Korg._load_alpha_5000_linelist"><code>_load_alpha_5000_linelist</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L877-L883">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.default_alpha_elements" href="#Korg.default_alpha_elements"><code>Korg.default_alpha_elements</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The &quot;alpha elements&quot; are defined as O, Ne, Mg, Si, S, Ar, Ca, Ti, i.e. all elements with even atomic numbers from 8-22. This definition is used by default in <a href="../API/#Korg.format_A_X"><code>format_A_X</code></a>, <a href="#Korg.get_metals_H-Tuple{Any}"><code>get_metals_H</code></a>, and <a href="#Korg.get_alpha_H-Tuple{Any}"><code>get_alpha_H</code></a>, but can be overridden with a keyword argument.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/abundances.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Formula" href="#Korg.Formula"><code>Korg.Formula</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Represents an atom or molecule, irrespective of its charge.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/species.jl#L5-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Line-Union{Tuple{F6}, Tuple{F5}, Tuple{F4}, Tuple{F3}, Tuple{F2}, Tuple{F1}, Tuple{F1, F2, Korg.Species, F3}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}, Union{Missing, Tuple{F6, F6}, F6}}} where {F1&lt;:Real, F2&lt;:Real, F3&lt;:Real, F4&lt;:Real, F5&lt;:Real, F6&lt;:Real}" href="#Korg.Line-Union{Tuple{F6}, Tuple{F5}, Tuple{F4}, Tuple{F3}, Tuple{F2}, Tuple{F1}, Tuple{F1, F2, Korg.Species, F3}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}, Union{Missing, Tuple{F6, F6}, F6}}} where {F1&lt;:Real, F2&lt;:Real, F3&lt;:Real, F4&lt;:Real, F5&lt;:Real, F6&lt;:Real}"><code>Korg.Line</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Line(wl::F, log_gf::F, species::Species, E_lower::F,
     gamma_rad::Union{F, Missing}=missing, gamma_stark::Union{F, Missing}=missing,
     vdw::Union{F, Tuple{F, F}, Missing}, missing) where F &lt;: Real</code></pre><p>Arguments:</p><ul><li><code>wl</code>: wavelength (Assumed to be in cm if &lt; 1, otherwise in Å)</li><li><code>log_gf</code>: (log base 10) oscillator strength (unitless)</li><li><code>species</code>: the <code>Species</code> associated with the line</li><li><code>E_lower</code>: The energy (excitiation potential) of the lower energy level (eV)</li></ul><p>Optional Arguments (these override default recipes):</p><ul><li><p><code>gamma_rad</code>: Fundemental width</p></li><li><p><code>gamma_stark</code>: per-perturber Stark broadening width at 10,000 K (s⁻¹).</p></li><li><p><code>vdW</code>: If this is present, it may may be</p><ul><li><code>log10(γ_vdW)</code>, assumed if negative</li><li>0, corresponding to no vdW broadening</li><li>A fudge factor for the Unsoeld approximation, assumed if between 0 and 20</li><li>The <a href="https://github.com/barklem/public-data/tree/master/broadening-howto">ABO parameters</a> as packed float (assumed if &gt;= 20) or a <code>Tuple</code>, <code>(σ, α)</code>.</li></ul><p>This behavior is intended to mirror that of Turbospectrum as closely as possible.</p></li></ul><p>See <a href="#Korg.approximate_gammas-Tuple{Any, Any, Any}"><code>approximate_gammas</code></a> for more information on the default recipes for <code>gamma_stark</code> and <code>vdW</code>.</p><p>Note the the &quot;gamma&quot; values here are FWHM, not HWHM, of the Lorenztian component of the line profile, and are in units of s⁻¹.</p><pre><code class="nohighlight hljs">Line(line::line; kwargs...)</code></pre><p>Construct a new <code>Line</code> by copying the values from an existing <code>Line</code>.  Any of the values can be modified with keyword arguments, e.g. <code>Line(line, log_gf=0.0)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L17-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.MolecularCrossSection-Tuple{Any, Vararg{Any}}" href="#Korg.MolecularCrossSection-Tuple{Any, Vararg{Any}}"><code>Korg.MolecularCrossSection</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MolecularCrossSection(linelist, wl_params...; cutoff_alpha=1e-30, log_temp_vals=3:0.025:5, verbose=true)</code></pre><p>Precompute the molecular absorption cross section for a given linelist and set of wavelengths. The <code>MolecularCrossSection</code> object can be passed to <a href="../API/#Korg.synthesize"><code>synthesize</code></a> and potentially speed up the calculation significantly.  At present, Korg only supports precomputed cross-sections created by this function, though they can be saved and loaded using <a href="#Korg.save_molecular_cross_section-Tuple{Any, Any}"><code>save_molecular_cross_section</code></a> and <a href="#Korg.read_molecular_cross_section-Tuple{Any}"><code>read_molecular_cross_section</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>linelist</code>: A vector of <code>Line</code> objects representing the molecular linelist.  These must be of the same species.</li><li><code>wl_params...</code>: Parameters specifying the wavelengths in the same format that <a href="../API/#Korg.synthesize"><code>synthesize</code></a> expects.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>cutoff_alpha</code> (default: 1e-30): The value of the single-line absorption coefficient (in cm^-1) at which to truncate the profile.</li><li><code>log_temp_vals</code> (default: 3:0.025:5): The log10 of the temperatures at which to precompute the cross-section.</li><li><code>verbose</code> (default: true): Whether to print progress information.</li></ul><div class="admonition is-success" id="Tip-bbb25ef9a3eaf0ae"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-bbb25ef9a3eaf0ae" title="Permalink"></a></header><div class="admonition-body"><p>The default values of <code>vmic_vals</code>, <code>log_temp_vals</code>, and <code></code>cutoff<em>alpha<code>were chosen to ensure that lines in the APOGEE linelist ([</code>get</em>APOGEE<em>DR17</em>linelist`](@ref)) could be accurately reproduced (better than 10^-3 everywhere). You should verify that they yield acceptable accuracy for other applications by comparing spectra synthesize with and without precomputing the molecular cross-section.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/molecular_cross_sections.jl#L10-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.PlanarAtmosphere" href="#Korg.PlanarAtmosphere"><code>Korg.PlanarAtmosphere</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PlanarAtmosphere(layers)</code></pre><p>A planar atmosphere is a flat atmosphere with its photosphere at <code>z = 0</code>.  The atmosphere is specified by a vector of <a href="#Korg.PlanarAtmosphereLayer"><code>PlanarAtmosphereLayer</code></a>s.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L29-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.PlanarAtmosphere-Tuple{Korg.ShellAtmosphere}" href="#Korg.PlanarAtmosphere-Tuple{Korg.ShellAtmosphere}"><code>Korg.PlanarAtmosphere</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PlanarAtmosphere(atm::ShellAtmosphere)</code></pre><p>Construct a planar atmosphere with the data from a shell atmosphere.  Mostly useful for testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L71-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.PlanarAtmosphereLayer" href="#Korg.PlanarAtmosphereLayer"><code>Korg.PlanarAtmosphereLayer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PlanarAtmosphereLayer(tau_5000, z, temp, nₑ, n)</code></pre><p>A layer of a planar atmosphere.</p><p><strong>Arguments</strong></p><ul><li><code>tau_5000</code>: the optical depth at 5000 Å.  This is useful for radiative transfer.</li><li><code>z</code>: the height (cm) of the layer relative to the photosphere.</li><li><code>temp</code>: the temperature (K) of the layer.</li><li><code>nₑ</code>: the electron number density (cm⁻³) of the layer.</li><li><code>n</code>: the total number density (cm⁻³) of the layer.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L8-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ShellAtmosphere" href="#Korg.ShellAtmosphere"><code>Korg.ShellAtmosphere</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ShellAtmosphere(layers, R)</code></pre><p><code>ShellAtmosphere</code>s (spherical atmospheres) are specified by a vector of <a href="#Korg.ShellAtmosphereLayer"><code>ShellAtmosphereLayer</code></a>s and a photospheric radius <code>R</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L60-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ShellAtmosphere-Tuple{Korg.PlanarAtmosphere, Any}" href="#Korg.ShellAtmosphere-Tuple{Korg.PlanarAtmosphere, Any}"><code>Korg.ShellAtmosphere</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ShellAtmosphere(atm::PlanarAtmosphere, R)</code></pre><p>Construct a shell atmosphere with the data from a planar atmosphere and an outer radius.  Mostly useful for testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L81-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ShellAtmosphereLayer" href="#Korg.ShellAtmosphereLayer"><code>Korg.ShellAtmosphereLayer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ShellAtmosphereLayer(tau_5000, z, temp, nₑ, n)</code></pre><p>A layer of a shell atmosphere.</p><p><strong>Arguments</strong></p><ul><li><code>tau_5000</code>: the optical depth at 5000 Å.  This is useful for radiative transfer.</li><li><code>z</code>: the height (cm) of the layer relative to the photosphere.</li><li><code>temp</code>: the temperature (K) of the layer.</li><li><code>nₑ</code>: the electron number density (cm⁻³) of the layer.</li><li><code>n</code>: the total number density (cm⁻³) of the layer.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L39-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Species" href="#Korg.Species"><code>Korg.Species</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Represents an atom or molecule (a <code>Formula</code>) with a particular number of electrons (regardless of their configuration).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/species.jl#L177-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Species-Tuple{AbstractString}" href="#Korg.Species-Tuple{AbstractString}"><code>Korg.Species</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Species(code)</code></pre><p>Parse the &quot;species code&quot; in many of the forms in which it is often specified and return an object representing the species. <code>code</code> can be either a string or a float.</p><p><strong>Examples</strong></p><ul><li>&quot;H I&quot; -&gt; H I</li><li>&quot;H 1&quot; -&gt; H I</li><li>&quot;H     1&quot; -&gt; H I</li><li>&quot;H_1&quot; -&gt; H I</li><li>&quot;H.I&quot; -&gt; H I</li><li>&quot;H 2&quot; -&gt; H II</li><li>&quot;H2&quot; -&gt; H₂</li><li>&quot;H&quot; -&gt; H I</li><li>&quot;01.00&quot; → H I</li><li>&quot;02.01&quot; → He II</li><li>&quot;02.1000&quot; → He II</li><li>&quot;0608&quot; → CO I</li></ul><div class="admonition is-info" id="Note-a486310c4b3cab30"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-a486310c4b3cab30" title="Permalink"></a></header><div class="admonition-body"><p>To parse at compile time, use the <code>species</code> string macro, i.e. <code>species&quot;H I&quot;</code>.  This is important in hot inner loops.</p></div></div><div class="admonition is-warning" id="Warning-99d400639aafc87a"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-99d400639aafc87a" title="Permalink"></a></header><div class="admonition-body"><p>MOOG codes which include isotopic information will not be parsed correctly by this function, though <a href="../API/#Korg.read_linelist"><code>read_linelist</code></a> handles them correctly. # leading 0s are safe to remove</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/species.jl#L193-L223">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.SynthesisResult" href="#Korg.SynthesisResult"><code>Korg.SynthesisResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SynthesisResult</code></pre><p>The result of a synthesis. Returned by <a href="../API/#Korg.synthesize"><code>synthesize</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>flux</code>: the output spectrum</li><li><code>cntm</code>: the continuum at each wavelength</li><li><code>intensity</code>: the intensity at each wavelength and mu value, and possibly each layer in the model atmosphere, depending on the radiative transfer scheme.</li><li><code>alpha</code>: the linear absorption coefficient at each wavelength and atmospheric layer a Matrix of size (layers x wavelengths)</li><li><code>mu_grid</code>: a vector of tuples containing the μ values and weights used in the radiative transfer calculation. Can be controlled with the <code>mu_values</code> keyword argument.</li><li><code>number_densities</code>: A dictionary mapping <code>Species</code> to vectors of number densities at each atmospheric layer</li><li><code>electron_number_density</code>: the electron number density at each atmospheric layer</li><li><code>wavelengths</code>: The vector of vacuum wavelengths (in Å) over which the synthesis was performed. If <code>air_wavelengths=true</code> this will not be the same as the input wavelengths.</li><li><code>subspectra</code>: A vector of ranges which can be used to index into <code>flux</code> to extract the spectrum for each range provided in <code>wavelength_ranges</code>.  If you use the standard <code>λ_start</code>, <code>λ_stop</code>, <code>λ_step</code> arguments, this will be a vector containing only one range.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/synthesize.jl#L5-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Wavelengths" href="#Korg.Wavelengths"><code>Korg.Wavelengths</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Korg.Wavelengths(wl_params...; air_wavelengths=false, wavelength_conversion_warn_threshold=1e-4)</code></pre><p>Construct a <code>Wavelengths</code> object which represents the (possibly non-contiguous) wavelengths for which to compute a spectrum.  The wavelengths can be specified with an upper and lower bound, or a vector of upper and lower bounds. For example,</p><pre><code class="nohighlight hljs">Korg.Wavelengths(5000, 5500)
Korg.Wavelengths([(5000, 5500), (6000, 6500)])</code></pre><p><strong>Keyword Arguments</strong></p><ul><li><code>air_wavelengths</code> (default: <code>false</code>): Whether or not the input wavelengths are air wavelengths to be converted to vacuum wavelengths by Korg.  The conversion will not be exact, so that the wavelength range can internally be represented by an evenly-spaced range.  If the approximation error is greater than <code>wavelength_conversion_warn_threshold</code>, an error will be thrown. (To do wavelength conversions yourself, see <a href="../API/#Korg.air_to_vacuum"><code>air_to_vacuum</code></a> and <a href="../API/#Korg.vacuum_to_air"><code>vacuum_to_air</code></a>.)</li><li><code>wavelength_conversion_warn_threshold</code> (default: 1e-4): see <code>air_wavelengths</code>. (In Å.)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/wavelengths.jl#L1-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Qfactor-NTuple{4, Any}" href="#Korg.Qfactor-NTuple{4, Any}"><code>Korg.Qfactor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Qfactor(synth_flux, synth_wl, obs_wl, LSF_mat; obs_mask=nothing)</code></pre><p>Compute the Q factor from the high-resolution theoretical spectrum, the high resolution wavelength grid, the low resolution (observed) wavelength grid, and the LSF matrix. Based on work from <a href="https://ui.adsabs.harvard.edu/abs/2001A%26A...374..733B/abstract">Bouchy et al. 2001, A&amp;A, 374, 733</a>. Note that the Q factor is an approximation when the flux uncertainty is not photon-dominated.</p><p><strong>Arguments</strong></p><ul><li><code>synth_flux</code>: High resolution theoretical spectrum</li><li><code>synth_wl</code>: High resolution wavelength grid</li><li><code>obs_wl</code>: Low resolution wavelength grid</li><li><code>LSF_mat</code>: LSF matrix (see <a href="../API/#Korg.compute_LSF_matrix"><code>compute_LSF_matrix</code></a>)</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs_mask::Vector{Bool}=nothing</code>: Mask for the low resolution spectrum to account for pixels masked from the observation</li></ul><p>See also: <a href="#Korg.RV_prec_from_Q-Tuple{Real, Real, Real}"><code>RV_prec_from_Q</code></a> and <a href="#Korg.RV_prec_from_noise-NTuple{5, Any}"><code>RV_prec_from_noise</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/qfactors.jl#L21-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RV_prec_from_Q-Tuple{Real, Real, Real}" href="#Korg.RV_prec_from_Q-Tuple{Real, Real, Real}"><code>Korg.RV_prec_from_Q</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RV_prec_from_Q(Q, RMS_SNR, Npix)</code></pre><p>Compute the RV precision (in m/s) from the Q factor, the RMS SNR per pixel, and the number of pixels in the spectrum.</p><p><strong>Arguments</strong></p><ul><li><code>Q::Real</code>: Q factor of the spectrum</li><li><code>RMS_SNR::Real</code>: The root mean squared per pixel SNR of the spectrum. For spectra which are not line-blanketed, this is approximately equal to the average SNR. approximately equal to the SNR.</li><li><code>Npix::Real</code>: Number of pixels in the spectrum</li></ul><p>See also: <a href="#Korg.Qfactor-NTuple{4, Any}"><code>Qfactor</code></a> and <a href="#Korg.RV_prec_from_noise-NTuple{5, Any}"><code>RV_prec_from_noise</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/qfactors.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RV_prec_from_noise-NTuple{5, Any}" href="#Korg.RV_prec_from_noise-NTuple{5, Any}"><code>Korg.RV_prec_from_noise</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RV_prec_from_noise(synth_flux, synth_wl, obs_wl, LSF_mat, obs_err; obs_mask=nothing)</code></pre><p>Compute the best achievable RV precision given the a spectrum with uncertainties.</p><p><strong>Arguments</strong></p><ul><li><code>synth_flux</code>: High-resolution theoretical spectrum</li><li><code>synth_wl</code>: High-resolution wavelength grid</li><li><code>obs_wl</code>: Low-resolution wavelength grid</li><li><code>LSF_mat</code>: LSF matrix (see <a href="../API/#Korg.compute_LSF_matrix"><code>compute_LSF_matrix</code></a>)</li><li><code>obs_err</code>: Noise in the continuum normalized spectrum</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs_mask=nothing</code>: Mask for the low resolution spectrum to account for pixels masked from the observation</li></ul><p>See also: <code>RV_prec_from_Q</code> and <code>Qfactor</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/qfactors.jl#L57-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg._get_multi_X_H-Tuple{Any, Any, Any}" href="#Korg._get_multi_X_H-Tuple{Any, Any, Any}"><code>Korg._get_multi_X_H</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Given a vector of abundances, <code>A_X</code>, get [I+J+K/H], where <code>Zs = [I,J,K]</code> is a vector of atomic numbers.  This is used to calculate, for example, [α/H] and [metals/H].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/abundances.jl#L158-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg._load_alpha_5000_linelist" href="#Korg._load_alpha_5000_linelist"><code>Korg._load_alpha_5000_linelist</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_load_alpha_5000_linelist([path])</code></pre><p>Load the default linelist for calculating the absorption coefficient at 5000 Å.  This for internal use when the provided linelist doesn&#39;t cover the region and a radiative transfer scheme using τ_5000 is used.</p><p>This linelist loaded into <code>Korg._alpha_5000_default_linelist</code> when Korg is imported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L852-L860">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.air_to_vacuum-Tuple{Any}" href="#Korg.air_to_vacuum-Tuple{Any}"><code>Korg.air_to_vacuum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">air_to_vacuum(λ; cgs=λ&lt;1)</code></pre><p>Convert λ from an air to vacuum.  λ is assumed to be in Å if it is ⩾ 1, in cm otherwise.  Formula from Birch and Downs (1994) via the VALD website.</p><p>See also: <a href="../API/#Korg.vacuum_to_air"><code>vacuum_to_air</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/utils.jl#L217-L224">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.all_atomic_species-Tuple{}" href="#Korg.all_atomic_species-Tuple{}"><code>Korg.all_atomic_species</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">all_atomic_species()</code></pre><p>Returns an iterator that runs over all atomic species supported by Korg.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/species.jl#L294-L298">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.apply_LSF-Union{Tuple{F}, Tuple{AbstractVector{F}, Any, Any}} where F&lt;:Real" href="#Korg.apply_LSF-Union{Tuple{F}, Tuple{AbstractVector{F}, Any, Any}} where F&lt;:Real"><code>Korg.apply_LSF</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_LSF(flux, wls, R; window_size=4)</code></pre><p>Applies a gaussian line spread function the the spectrum with flux vector <code>flux</code> and wavelengths <code>wls</code> in any format accepted by synthesize, e.g. as a pair <code>(λstart, λstop)</code>) with constant spectral resolution (, <span>$R = \lambda/\Delta\lambda$</span>, where <span>$\Delta\lambda$</span> is the LSF FWHM.  The <code>window_size</code> argument specifies how far out to extend the convolution kernel in standard deviations.</p><p>For the best match to data, your wavelength range should extend a couple <span>$\Delta\lambda$</span> outside the region you are going to compare.</p><p>If you are convolving many spectra defined on the same wavelenths to observational resolution, you will get much better performance using <a href="../API/#Korg.compute_LSF_matrix"><code>compute_LSF_matrix</code></a>.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>window_size</code> (default: 4): how far out to extend the convolution kernel in units of the LSF width (σ, not HWHM)</li><li><code>renormalize_edge</code> (default: <code>true</code>): whether or not to renormalize the LSF at the edge of the wl range.  This doen&#39;t matter as long as <code>synth_wls</code> extends to large and small enough wavelengths.</li></ul><div class="admonition is-warning" id="Warning-13d950d4d5264d00"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-13d950d4d5264d00" title="Permalink"></a></header><div class="admonition-body"><ul><li><p>This is a naive, slow implementation.  Do not use it when performance matters.</p></li><li><p><code>apply_LSF</code> will have weird behavior if your wavelength grid is not locally linearly-spaced. It is intended to be run on a fine wavelength grid, then downsampled to the observational (or otherwise desired) grid.</p></li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/utils.jl#L60-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.apply_rotation" href="#Korg.apply_rotation"><code>Korg.apply_rotation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_rotation(flux, wls, vsini, ε=0.6)</code></pre><p>Given a spectrum <code>flux</code> sampled at wavelengths <code>wls</code> for a non-rotating star, compute the spectrum that would emerge given projected rotational velocity <code>vsini</code> (in km/s) and linear limb-darkening coefficient <code>ε</code>: <span>$I(\mu) = I(1) (1 - \varepsilon + arepsilon \mu))$</span>.  See, for example, Gray equation 18.14.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/utils.jl#L148-L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.approximate_gammas-Tuple{Any, Any, Any}" href="#Korg.approximate_gammas-Tuple{Any, Any, Any}"><code>Korg.approximate_gammas</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">approximate_gammas(wl, species, E_lower; ionization_energies=Korg.ionization_energies)</code></pre><p>A simplified form of the Unsoeld (1955) approximation for van der Waals broadening and the <a href="https://ui.adsabs.harvard.edu/abs/1971Obs....91..139C/abstract">Cowley 1971</a> approximation for Stark broadening, evaluated at 10,000 K. Used for atomic lines with no vdW and stark broadening info in the linelist.</p><p>Returns <code>(γ_stark</code>, <code>log10(γ_vdW))</code> in Hz, where these are the per-perturber quantities. For autoionizing lines (those for which E<em>upper &gt; χ), Returns 0.0 for γ</em>vdW. Note the the &quot;gamma&quot; values here are FWHM, not HWHM, of the Lorenztian component of the line profile.</p><p>In the calculation of <code>n*²</code>, uses the approximation that <span>$\overbar{r^2} = 5/2 {n^*}^4 / Z^2$</span> which neglects the dependence on the angular momentum quantum number, l, in the the form given by <a href="https://ui.adsabs.harvard.edu/abs/1967MNRAS.136..381W/abstract">Warner 1967</a> (the earliest english work reporting the Unsoeld result).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L127-L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.approximate_line_strength-Tuple{Korg.Line, Any}" href="#Korg.approximate_line_strength-Tuple{Korg.Line, Any}"><code>Korg.approximate_line_strength</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">approximate_line_strength(line::Line, T)</code></pre><p>Approximate the line strength (<code>log10(gfλ) - θχ</code>, in arbitrary units) of a line at temperature <code>T</code> (K).  This can be used to very quickly filter a linelist, and is used to filter very large molecular linelists from ExoMol (see <a href="../API/#Korg.load_ExoMol_linelist"><code>load_ExoMol_linelist</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L265-L271">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.approximate_radiative_gamma-Tuple{Any, Any}" href="#Korg.approximate_radiative_gamma-Tuple{Any, Any}"><code>Korg.approximate_radiative_gamma</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">approximate_radiative_gamma(wl, log_gf)</code></pre><p>Approximate radiate broadening parameter.  When using this, make sure that <code>log_gf</code> is the true value (not adjusted for isotopic abundance).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L114-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.autodiffable_conv-Tuple{Any, Any}" href="#Korg.autodiffable_conv-Tuple{Any, Any}"><code>Korg.autodiffable_conv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">autodiffable_conv(f, g)</code></pre><p>Compute the convolution of two vectors, <code>f</code> and <code>g</code>. This is a wrapped version of <code>DSP.conv</code> that handles <code>ForwardDiff.Dual</code> types via the chain rule.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/autodiffable_conv.jl#L4-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.blackbody-Tuple{Any, Any}" href="#Korg.blackbody-Tuple{Any, Any}"><code>Korg.blackbody</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">blackbody(T, λ)</code></pre><p>The value of the Planck blackbody function for temperature <code>T</code> at wavelength <code>λ</code> [cm].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/synthesize.jl#L341-L345">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.bracket_line_interpolator" href="#Korg.bracket_line_interpolator"><code>Korg.bracket_line_interpolator</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bracket_line_interpolator(m, λ₀, T, nₑ, ξ, λmin, λmax; kwargs...)</code></pre><p>This routine numerically convolves the two components of the Brackett line stark profile (quasistatic/Holtsmark and impact) and the doppler profile, if necessary.  It returns a pair containing the interpolator and the distance from the line center at which it is defined.</p><p><strong>Arguments</strong></p><ul><li><code>m</code>: the principle quantum number of the upper level</li><li><code>λ₀</code>: the line center in Å</li><li><code>T</code>: the temperature [K]</li><li><code>nₑ</code>: the electron number density [cm^-3]</li><li><code>ξ</code>: the microturbulence [cm/s]</li><li><code>λmin</code>: the minimum wavelength at which the profile should be computed (used to avoid calculations outside the required region)</li><li><code>λmax</code>: the mxinimum wavelength at which the profile should be computed</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>n_wavelength_points</code> (default=201): the number of wavelengths at which to sample the profiles quasistatic profiles to be convolved.</li><li><code>window_size</code> (default=5): the size of the wavelength range over which the profiles should be calculated, in units of the characteristic profile width</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/hydrogen_line_absorption.jl#L188-L212">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.brackett_line_stark_profiles-NTuple{5, Any}" href="#Korg.brackett_line_stark_profiles-NTuple{5, Any}"><code>Korg.brackett_line_stark_profiles</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">brackett_line_stark_profiles(m, λs, λ₀, T, nₑ)</code></pre><p>Stark-broadened line profile (specialized to Brackett series).  Translated and heavily adapted from HLINOP.f by Barklem, who adapted it from Peterson and Kurucz.  Mostly follows <a href="https://doi.org/10.1086/146987">Griem 1960</a>, and <a href="https://doi.org/10.1086/149097">Griem 1967</a>.  Ions and distant electrons have E fields which can be treated quasi-statically, leading to a <a href="https://doi.org/10.1002/andp.19193630702">Holtsmark broadening profile</a>.</p><p>Returns a pair of vectors containing the impact and quasistatic profiles, respectively.</p><p>Arguents:</p><ul><li><code>m</code>: the upper level of the transition</li><li><code>λs</code>: the wavelengths at which to calculate the profile [cm]</li><li><code>λ₀</code>: the line center [cm]</li><li><code>T</code>: temperature [K]</li><li><code>nₑ</code>: electron number density [cm^-3]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/hydrogen_line_absorption.jl#L255-L273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.brackett_oscillator_strength-Tuple{Any, Any}" href="#Korg.brackett_oscillator_strength-Tuple{Any, Any}"><code>Korg.brackett_oscillator_strength</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">brackett_oscillator_strength(n, m)</code></pre><p>The oscillator strength of the transition from the 4th to the mth energy level of hydrogen. Adapted from HLINOP.f by Peterson and Kurucz.</p><p>Comparison to the values in <a href="https://doi.org/10.1086/190180">Goldwire 1968</a> indicates that this is accurate to 10^-4 for the Brackett series.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/hydrogen_line_absorption.jl#L167-L175">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.chemical_equilibrium-NTuple{7, Any}" href="#Korg.chemical_equilibrium-NTuple{7, Any}"><code>Korg.chemical_equilibrium</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">chemical_equilibrium(T, nₜ, nₑ, absolute_abundances, ionization_energies, 
                     partition_fns, log_equilibrium_constants; x0=nothing)</code></pre><p>Iteratively solve for the number density of each species. Returns a pair containing the electron number density and <code>Dict</code> mapping species to number densities.</p><p>arguments:</p><ul><li>the temperature, <code>T</code>, in K</li><li>the total number density <code>nₜ</code></li><li>the electron number density <code>nₑ</code></li><li>A Dict of <code>absolute_abundances</code>, N<em>X/N</em>total</li><li>a Dict of ionization energies, <code>ionization_energies</code>.  The keys of act as a list of all atoms.</li><li>a Dict of partition functions, <code>partition_fns</code></li><li>a Dict of log molecular equilibrium constants, <code>log_equilibrium_constants</code>, in partial pressure form. The keys of <code>equilibrium_constants</code> act as a list of all molecules.</li></ul><p>keyword arguments:</p><ul><li><code>x0</code> (default: <code>nothing</code>) is an initial guess for the solution (in the format internal to <code>chemical_equilibrium</code>). If not supplied, a good guess is computed by neglecting molecules.</li><li><code>electron_number_density_warn_threshold</code> (default: <code>0.1</code>) is the fractional difference between the calculated electron number density and the model atmosphere electron number density at which a warning is issued.</li><li><code>electron_number_density_warn_min_value</code> (default: <code>1e-4</code>) is the minimum value of the electron number density at which a warning is issued.  This is to avoid warnings when the electron number density is very small.</li></ul><p>The system of equations is specified with the number densities of the neutral atoms as free parameters.  Each equation specifies the conservation of a particular species, e.g. (simplified)</p><pre><code class="nohighlight hljs">n(O) = n(CO) + n(OH) + n(O I) + n(O II) + n(O III).</code></pre><p>In this equation:</p><ul><li><code>n(O)</code>, the number density of oxygen atoms in any form comes <code>absolute_abundances</code> and the total number density (supplied later)</li><li><code>n(O I)</code> is a free parameter.  The numerical solver is varying this to satisfy the system of equations.</li><li><code>n(O II)</code>, and <code>n(O III)</code> come from the Saha (ionization) equation given <code>n(O I)</code></li><li><code>n(CO)</code> and <code>n(OH)</code> come from the molecular equilibrium constants K, which are precomputed over a range of temperatures.</li></ul><p>Equilibrium constants are defined in terms of partial pressures, so e.g.</p><pre><code class="nohighlight hljs">K(OH)  ==  (p(O) p(H)) / p(OH)  ==  (n(O) n(H)) / n(OH)) kT</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/statmech.jl#L72-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.compute_LSF_matrix-Tuple{Any, Any, Any}" href="#Korg.compute_LSF_matrix-Tuple{Any, Any, Any}"><code>Korg.compute_LSF_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_LSF_matrix(synth_wls, obs_wls, R; kwargs...)</code></pre><p>Construct a sparse matrix, which when multiplied with a flux vector defined over wavelenths <code>synth_wls</code>, applies a gaussian line spead function (LSF) and resamples to the wavelenths <code>obswls</code>.</p><p><strong>Arguments</strong></p><ul><li><code>synth_wls</code>: the synthesis wavelengths in any form recognized by <code>synthesize</code>, e.g. a pair containing a lower and upper bound in Å, a vector of pairs, or a vector of Julia range objects.</li><li><code>obs_wls</code>: the wavelengths of the observed spectrum</li><li><code>R</code>: the resolving power, <span>$R = \lambda/\Delta\lambda$</span></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>window_size</code> (default: 4): how far out to extend the convolution kernel in units of the LSF width (σ, not HWHM)</li><li><code>verbose</code> (default: <code>true</code>): whether or not to emit warnings and information to stdout/stderr.</li><li><code>step_tolerance</code>: the maximum difference between adjacent wavelengths in <code>synth_wls</code> for them to be considered linearly spaced.  This is only used if <code>synth_wls</code> is a vector of wavelengths rather than a range or vector or ranges.</li></ul><p>For the best match to data, your wavelength range should extend a couple <span>$\Delta\lambda$</span> outside the region you are going to compare.</p><p><a href="../API/#Korg.apply_LSF"><code>Korg.apply_LSF</code></a> can apply an LSF to a single flux vector efficiently. This function is relatively slow, but one the LSF matrix is constructed, convolving spectra to observational resolution via matrix multiplication is fast.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/utils.jl#L100-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.contained-Tuple{Real, Korg.Interval}" href="#Korg.contained-Tuple{Real, Korg.Interval}"><code>Korg.contained</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">contained(value, interval)</code></pre><p>Returns whether <code>value</code> is contained by <code>interval</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; contained(0.5, Interval(1.0, 10.0))
false

julia&gt; contained(5.0, Interval(1.0, 10.0))
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/utils.jl#L281-L295">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.contained_slice-Tuple{AbstractVector, Korg.Interval}" href="#Korg.contained_slice-Tuple{AbstractVector, Korg.Interval}"><code>Korg.contained_slice</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">contained_slice(vals, interval)</code></pre><p>Returns a range of indices denoting the elements of <code>vals</code> (which are assumed to be sorted in increasing order) that are contained by <code>interval</code>. When no entries are contained by interval, this returns <code>(1,0)</code> (which is a valid empty slice).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/utils.jl#L298-L304">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.doppler_width-NTuple{4, Any}" href="#Korg.doppler_width-NTuple{4, Any}"><code>Korg.doppler_width</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">doppler_width(λ₀ T, m, ξ)</code></pre><p>The standard deviation of of the doppler-broadening profile.  In standard spectroscopy texts, the Doppler width often refers to σ√2, but this is σ</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/line_absorption.jl#L169-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.eachfreq-Tuple{Korg.Wavelengths}" href="#Korg.eachfreq-Tuple{Korg.Wavelengths}"><code>Korg.eachfreq</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eachfreq(wls::Wavelengths)</code></pre><p>Returns an array of the frequencies corresponding to the wavelengths in <code>wls</code> (in Hz). They are sorted, i.e. in reverse order of the wavelengths.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/wavelengths.jl#L124-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.eachwindow-Tuple{Korg.Wavelengths}" href="#Korg.eachwindow-Tuple{Korg.Wavelengths}"><code>Korg.eachwindow</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eachwindows(wls::Wavelengths)</code></pre><p>Returns an iterator over the wavelength ranges <code>(λ_low, λ_hi)</code> in <code>wls</code> (in cm, not Å).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/wavelengths.jl#L117-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.exponential_integral_1-Tuple{Any}" href="#Korg.exponential_integral_1-Tuple{Any}"><code>Korg.exponential_integral_1</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exponential_integral_1(x)</code></pre><p>Compute the first exponential integral, E1(x).  This is a rough approximation lifted from Kurucz&#39;s VCSE1F. Used in <code>brackett_line_profile</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/line_absorption.jl#L148-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.filter_linelist-Tuple{Any, Any, Any}" href="#Korg.filter_linelist-Tuple{Any, Any, Any}"><code>Korg.filter_linelist</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">filter_linelist(linelist, wls, line_buffer)</code></pre><p>Return a new linelist containing only lines within the provided wavelength ranges.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/synthesize.jl#L280-L284">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.format_A_X-Union{Tuple{}, Tuple{R2}, Tuple{R1}, Tuple{V}, Tuple{K}, Tuple{R1, R2}, Tuple{R1, R2, AbstractDict{K, V}}} where {K, V, R1&lt;:Real, R2&lt;:Real}" href="#Korg.format_A_X-Union{Tuple{}, Tuple{R2}, Tuple{R1}, Tuple{V}, Tuple{K}, Tuple{R1, R2}, Tuple{R1, R2, AbstractDict{K, V}}} where {K, V, R1&lt;:Real, R2&lt;:Real}"><code>Korg.format_A_X</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">format_A_X(default_metals_H, default_alpha_H, abundances; kwargs... )</code></pre><p>Returns a 92 element vector containing abundances in <span>$A(X)$</span> (<span>$\log_{10}(X/H) + 12$</span>) format for elements from hydrogen to uranium.</p><p><strong>Arguments</strong></p><p>You can specify abundance with these positional arguments.  All are optional, but if <code>default_alpha_H</code> is provided, <code>default_metals_H</code> must be as well.</p><ul><li><code>default_metals_H</code> (default: 0), i.e. [metals/H] is the <span>$\log_{10}$</span> solar-relative abundance of elements heavier than He. It is overridden by <code>default_alpha</code> and <code>abundances</code> on a per-element basis.</li><li><code>default_alpha_H</code> (default: same as <code>default_metals_H</code>), i.e. [alpha/H] is the <span>$\log_{10}$</span> solar-relative abundance of the alpha elements (See <code>alpha_elements</code>, below). It is overridden by <code>abundances</code> on a per-element basis.</li><li><code>abundances</code> is a <code>Dict</code> mapping atomic numbers or symbols to [<span>$X$</span>/H] abundances.  (Set <code>solar_relative=false</code> to use <span>$A(X)$</span> abundances instead.) These override <code>default_metals_H</code>. This is the only way to specify an abundance of He that is non-solar.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>solar_relative</code> (default: true): When true, interpret abundances as being in [<span>$X$</span>/H] (<span>$\log_{10}$</span> solar-relative) format.  When false, interpret them as <span>$A(X)$</span> abundances, i.e. <span>$A(x) = \log_{10}(n_X/n_\mathrm{H}) + 12$</span>, where <span>$n_X$</span> is the number density of <span>$X$</span>. Note that abundances not specified default to the solar value still depend on the solar value, as they are set according to <code>default_metals_H</code> and <code>default_alpha_H</code>.</li><li><code>solar_abundances</code> (default: <code>Korg.asplund_2020_solar_abundances</code>) is the set of solar abundances to use, as a vector indexed by atomic number. <code>Korg.asplund_2009_solar_abundances</code> and <code>Korg.grevesse_2007_solar_abundances</code> are also provided for convenience.</li><li><code>alpha_elements</code> (default: <a href="#Korg.default_alpha_elements"><code>Korg.default_alpha_elements</code></a>): vector of atomic numbers of the alpha elements. (Useful since conventions vary.)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/abundances.jl#L12-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_APOGEE_DR17_linelist-Tuple{}" href="#Korg.get_APOGEE_DR17_linelist-Tuple{}"><code>Korg.get_APOGEE_DR17_linelist</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_APOGEE_DR17_linelist(; include_water=true)</code></pre><p>The APOGEE DR 17 linelist.  It ranges from roughly 15,000 Å to 17,000 Å.  It is nearly the same at the DR 16 linelist described in <a href="https://ui.adsabs.harvard.edu/abs/2021AJ....161..254S/abstract">Smith+ 2021</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L744-L750">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_GALAH_DR3_linelist-Tuple{}" href="#Korg.get_GALAH_DR3_linelist-Tuple{}"><code>Korg.get_GALAH_DR3_linelist</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_GALAH_DR3_linelist()</code></pre><p>The GALAH <a href="https://www.galah-survey.org/dr3/overview/">DR 3</a> linelist (also used for <a href="https://github.com/svenbuder/GALAH_DR4">DR 4</a>). It ranges from roughly 4,675 Å to 7,930 Å. This linelist is based on, but distinct from <a href="https://ui.adsabs.harvard.edu/abs/2021A%26A...645A.106H/">Heiter 2021</a>. See <a href="https://ui.adsabs.harvard.edu/abs/2021MNRAS.506..150B%2F/abstract">Buder et al. 2021</a> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L774-L784">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_GES_linelist-Tuple{}" href="#Korg.get_GES_linelist-Tuple{}"><code>Korg.get_GES_linelist</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_GES_linelist()</code></pre><p>The Gaia-ESO survey linelist from <a href="https://ui.adsabs.harvard.edu/abs/2021A&amp;A...645A.106H/abstract">Heiter et al. 2021</a>.  This linelist contains &gt; 15 million lines, which means that it can take a while to synthesize spectra.  If you don&#39;t need molecular lines, you can set <code>include_molecules=false</code> to speed things up.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>include_molecules</code> (default: <code>true</code>): whether to include molecular lines.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L813-L824">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_VALD_solar_linelist-Tuple{}" href="#Korg.get_VALD_solar_linelist-Tuple{}"><code>Korg.get_VALD_solar_linelist</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_VALD_solar_linelist()</code></pre><p>Get a VALD &quot;extract stellar&quot; linelist produced at solar parameters, with the &quot;threshold&quot; value set to 0.01.  It was downloaded on 2021-05-20. It is intended to be used for quick tests only.</p><p>If you use this in a paper, please <a href="https://www.astro.uu.se/valdwiki/Acknowledgement">cite VALD appropriately</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L732-L739">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_alpha_5000_linelist-Tuple{Any}" href="#Korg.get_alpha_5000_linelist-Tuple{Any}"><code>Korg.get_alpha_5000_linelist</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_alpha_5000_linelist(linelist)</code></pre><p>Arguments:</p><ul><li><code>linelist</code>: the synthesis linelist, which will be used if it covers the 5000 Å region.</li></ul><p>Return a linelist which can be used to calculate the absorption at 5000 Å, which is required for the standard radiative transfer scheme.  If the provided linelist doesn&#39;t contain lines near 5000 Å, use the built-in one. (see <a href="#Korg._load_alpha_5000_linelist"><code>_load_alpha_5000_linelist</code></a>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/synthesize.jl#L306-L316">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_alpha_H-Tuple{Any}" href="#Korg.get_alpha_H-Tuple{Any}"><code>Korg.get_alpha_H</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_alpha_H(A_X; kwargs...)</code></pre><p>Calculate [α/H] given a vector, <code>A_X</code> of absolute abundances, <span>$A(X) = \log_{10}(n_α/n_\mathrm{H})$</span>. Here, the alpha elements are defined to be O, Ne, Mg, Si, S, Ar, Ca, Ti.  See also <a href="#Korg.get_metals_H-Tuple{Any}"><code>get_metals_H</code></a>.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>solar_abundances</code> (default: <code>Korg.asplund_2020_solar_abundances</code>) is the set of solar abundances to use, as a vector indexed by atomic number. <code>Korg.asplund_2009_solar_abundances</code>, <code>Korg.grevesse_2007_solar_abundances</code>, and <code>Korg.magg_2022_solar_abundances</code> are also provided for convenience.</li><li><code>alpha_elements</code> (default: <a href="#Korg.default_alpha_elements"><code>Korg.default_alpha_elements</code></a>): vector of atomic numbers of the alpha elements. (Useful since conventions vary.)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/abundances.jl#L136-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_atom-Tuple{Korg.Formula}" href="#Korg.get_atom-Tuple{Korg.Formula}"><code>Korg.get_atom</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_atom(x)</code></pre><p>Returns the atomic number of an atomic Korg.Species or Korg.Formula.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/species.jl#L108-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_atoms-Tuple{Korg.Formula}" href="#Korg.get_atoms-Tuple{Korg.Formula}"><code>Korg.get_atoms</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_atoms(x)</code></pre><p>Returns an array view containing the atomic number of each atom that makes up the formula or species x.  E.g. <code>get_atoms(Korg.species&quot;H2O&quot;)</code> yields [1, 1, 8].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/species.jl#L93-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_electron_number_densities-Tuple{Korg.ModelAtmosphere}" href="#Korg.get_electron_number_densities-Tuple{Korg.ModelAtmosphere}"><code>Korg.get_electron_number_densities</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>get<em>electron</em>number<em>densities(atm::ModelAtmosphere) = [l.electron</em>number_density for l in atm.layers]</p><p>This is a convienince functions for making plots, etc.  Note that it doesn&#39;t access quantities in a memory-efficient order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L118-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_gas_pressures-Tuple{Any}" href="#Korg.get_gas_pressures-Tuple{Any}"><code>Korg.get_gas_pressures</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_gas_pressures(atm::ModelAtmosphere)</code></pre><p>This is a convienince functions for making plots, etc.  Note that it doesn&#39;t access quantities in a memory-efficient order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L133-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_log_nK-Tuple{Any, Any, Any}" href="#Korg.get_log_nK-Tuple{Any, Any, Any}"><code>Korg.get_log_nK</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_log_nK(mol, T, log_equilibrium_constants)</code></pre><p>Given a molecule, <code>mol</code>, a temperature, <code>T</code>, and a dictionary of log equilibrium constants in partial pressure form, return the base-10 log equilibrium constant in number density form, i.e. <code>log10(nK)</code> where <code>nK = n(A)n(B)/n(AB)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/statmech.jl#L54-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_mass-Tuple{Korg.Formula}" href="#Korg.get_mass-Tuple{Korg.Formula}"><code>Korg.get_mass</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_mass(f::Formula)</code></pre><p>Returns the mass [g] of <code>f</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/species.jl#L170-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_metals_H-Tuple{Any}" href="#Korg.get_metals_H-Tuple{Any}"><code>Korg.get_metals_H</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_metals_H(A_X; kwargs...)</code></pre><p>Calculate [metals/H] given a vector, <code>A_X</code> of absolute abundances, <span>$A(X) = \log_{10}(n_M/n_\mathrm{H})$</span>. See also <a href="#Korg.get_alpha_H-Tuple{Any}"><code>get_alpha_H</code></a>.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>solar_abundances</code> (default: <code>Korg.asplund_2020_solar_abundances</code>) is the set of solar abundances to use, as a vector indexed by atomic number. <code>Korg.asplund_2009_solar_abundances</code>, <code>Korg.grevesse_2007_solar_abundances</code>, and <code>Korg.magg_2022_solar_abundances</code> are also provided for convenience.</li><li><code>ignore_alpha</code> (default: <code>true</code>): Whether or not to ignore the alpha elements when calculating [metals/H].  If <code>true</code>, [metals/H] is calculated using all elements heavier than He.  If <code>false</code>, then both carbon and the alpha elements are ignored.</li><li><code>alpha_elements</code> (default: <a href="#Korg.default_alpha_elements"><code>Korg.default_alpha_elements</code></a>): vector of atomic numbers of the alpha elements. (Useful since conventions vary.)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/abundances.jl#L107-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_number_densities-Tuple{Korg.ModelAtmosphere}" href="#Korg.get_number_densities-Tuple{Korg.ModelAtmosphere}"><code>Korg.get_number_densities</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_number_densities(atm::ModelAtmosphere) = [l.number_density for l in atm.layers]</code></pre><p>This is a convienince functions for making plots, etc.  Note that it doesn&#39;t access quantities in a memory-efficient order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L126-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_tau_5000s-Tuple{Korg.ModelAtmosphere}" href="#Korg.get_tau_5000s-Tuple{Korg.ModelAtmosphere}"><code>Korg.get_tau_5000s</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_tau_5000s(atm::ModelAtmosphere) = [l.tau_5000 for l in atm.layers]</code></pre><p>This is a convienince functions for making plots, etc.  Note that it doesn&#39;t access quantities in a memory-efficient order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L97-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_temps-Tuple{Korg.ModelAtmosphere}" href="#Korg.get_temps-Tuple{Korg.ModelAtmosphere}"><code>Korg.get_temps</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>get_temps(atm::ModelAtmosphere) = [l.temp for l in atm.layers]</p><p>This is a convienince functions for making plots, etc.  Note that it doesn&#39;t access quantities in a memory-efficient order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L111-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.get_zs-Tuple{Korg.ModelAtmosphere}" href="#Korg.get_zs-Tuple{Korg.ModelAtmosphere}"><code>Korg.get_zs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>get_zs(atm::ModelAtmosphere) = [l.z for l in atm.layers]</p><p>This is a convienince functions for making plots, etc.  Note that it doesn&#39;t access quantities in a memory-efficient order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L104-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.greim_1960_Knm-Tuple{Any, Any}" href="#Korg.greim_1960_Knm-Tuple{Any, Any}"><code>Korg.greim_1960_Knm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">greim_1960_Knm(n, m)</code></pre><p>Knm constants as defined by <a href="https://doi.org/10.1086/146987">Griem 1960</a> for the long range Holtsmark profile. This function includes only the values for Brackett lines.</p><p><span>$K_{nm} = C_{nm} 2 π c / λ^2$</span> where <span>$C_{nm} F = Δω$</span> and <span>$F$</span> is the ion field. See Griem 1960 EQs 7 and 12. This works out to <span>$K_{nm} = λ/F$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/hydrogen_line_absorption.jl#L376-L385">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.holtsmark_profile-Tuple{Any, Any}" href="#Korg.holtsmark_profile-Tuple{Any, Any}"><code>Korg.holtsmark_profile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">holtsmark_profile(β, P)</code></pre><p>Calculates the Holtsmark profile for broadening of hydrogen lines by quasistatic charged particles. Adapted from SOFBET in HLINOP by Peterson and Kurucz. Draws heavily from <a href="https://doi.org/10.1086/146987">Griem 1960</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/hydrogen_line_absorption.jl#L396-L402">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.hummer_mihalas_U_H-NTuple{4, Any}" href="#Korg.hummer_mihalas_U_H-NTuple{4, Any}"><code>Korg.hummer_mihalas_U_H</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hummer_mihalas_U_H(T, nH, nHe, ne)</code></pre><p>!!!note This is experimental, and not used by Korg for spectral synthesis.</p><p>Calculate the partition function of neutral hydrogen using the occupation probability formalism from Hummer and Mihalas 1988.  See <a href="#Korg.hummer_mihalas_w-NTuple{5, Any}"><code>hummer_mihalas_w</code></a> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/statmech.jl#L434-L442">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.hummer_mihalas_w-NTuple{5, Any}" href="#Korg.hummer_mihalas_w-NTuple{5, Any}"><code>Korg.hummer_mihalas_w</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hummer_mihalas_w(T, n_eff, nH, nHe, ne; use_hubeny_generalization=false)</code></pre><p>Calculate the correction, w, to the occupation fraction of a hydrogen energy level using the occupation probability formalism from Hummer and Mihalas 1988, optionally with the generalization by Hubeny+ 1994.  (Sometimes Daeppen+ 1987 is cited instead, but H&amp;M seems to be where the theory originated. Presumably it was delayed in publication.)</p><p>The expression for w is in equation 4.71 of H&amp;M.  K, the QM correction used in defined in equation 4.24. Note that H&amp;M&#39;s &quot;N&quot;s are numbers (not number densities), and their &quot;V&quot; is volume.  These quantities apear only in the form N/V, so we use the number densities instead.</p><p>This is based partially on Paul Barklem and Kjell Eriksson&#39;s <a href="https://github.com/barklem/hlinop/blob/master/hbop.f">WCALC fortran routine</a> (part of HBOP.f), which is used by (at least) Turbospectrum and SME.  As in that routine, we do consider hydrogen and helium as the relevant neutral species, and assume them to be in the ground state.  All ions are assumed to have charge 1.  Unlike that routine, the generalization to the formalism from Hubeny+ 1994 is turned off by default because I haven&#39;t closely checked it.  The difference effects the charged<em>term only, and temperature is only used when `use</em>hubeny_generalization<code>is set to</code>true`.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/statmech.jl#L345-L365">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.hydrogen_line_absorption!-Tuple{Any, Korg.Wavelengths, Vararg{Any, 7}}" href="#Korg.hydrogen_line_absorption!-Tuple{Any, Korg.Wavelengths, Vararg{Any, 7}}"><code>Korg.hydrogen_line_absorption!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hydrogen_line_absorption!(αs, λs, T, nₑ, nH_I, UH_I, ξ, window_size; kwargs...)</code></pre><p>Calculate contribution to the the absorption coefficient, αs, from hydrogen lines in units of cm^-1, at wavelengths <code>λs</code> (a vector of ranges).</p><p>Uses profiles from <a href="https://ui.adsabs.harvard.edu/abs/1999A%26AS..140...93S/abstract">Stehlé &amp; Hutcheon (1999)</a>, which include Stark and Doppler broadening. For Halpha, Hbeta, and Hgamma, the p-d approximated profiles from <a href="https://ui.adsabs.harvard.edu/abs/2000A%26A...363.1091B/abstract">Barklem, Piskunovet, and O&#39;Mara 2000</a> are added to the absortion coefficient.  This &quot;convolution by summation&quot; is inexact, but true convolution is expensive.</p><p>Arguments:</p><ul><li><code>αs</code>: the absorption coefficient [cm^-1] vector into which to add the line absorption</li><li><code>λs</code>: the wavelengths at which to calculate the absorption [cm]</li><li><code>T</code>: temperature [K]</li><li><code>nₑ</code>: electron number density [cm^-3]</li><li><code>nH_I</code>: neutral hydrogen number density [cm^-3]</li><li><code>UH_I</code>: the value of the neutral hydrogen partition function</li><li><code>ξ</code>: microturbulent velocity [cm/s]. This is only applied to Hα-Hγ.  Other hydrogen lines profiles are dominated by stark broadening, and the stark broadened profiles are pre-convolved with a doppler profile.</li><li><code>window_size</code>: the max distance from each line center [cm] at which to calculate the Stark and self-broadening profiles absorption for Hα-Hγ (those dominated by self-broadening).</li></ul><p>Keyword arguments:</p><ul><li><code>stark_profiles</code> (default: <code>Korg._hline_stark_profiles</code>): tables from which to interpolate Stark profiles</li><li><code>use_MHD</code>: whether or not to use the Mihalas-Daeppen-Hummer formalism to adjust the occupation probabilities of each hydrogen orbital for plasma effects.  Default: <code>true</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/hydrogen_line_absorption.jl#L44-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.interpolate_marcs-Tuple{Any, Any, AbstractVector{&lt;:Real}}" href="#Korg.interpolate_marcs-Tuple{Any, Any, AbstractVector{&lt;:Real}}"><code>Korg.interpolate_marcs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">interpolate_marcs(Teff, logg, A_X; kwargs...)
interpolate_marcs(Teff, logg, m_H=0, alpha_m=0, C_m=0; kwargs...)</code></pre><p>Returns a model atmosphere computed by interpolating models from <a href="https://marcs.astro.uu.se/">MARCS</a> ((Gustafsson+ 2008)[https://ui.adsabs.harvard.edu/abs/2008A&amp;A...486..951G/abstract]). Along with <code>Teff</code> and <code>logg</code>, the atmosphere is specified by <code>m_H</code>, <code>alpha_m</code>, and <code>C_m</code>, which can be automatically determined from an <code>A_X</code> abundance vector (the recommended method, see <a href="../API/#Korg.format_A_X"><code>format_A_X</code></a>). Note that the MARCS atmosphere models were constructed with the Grevesse+ 2007 solar abundances (<code>Korg.grevesse_2007_solar_abundances</code>). This is handled automatically when <code>A_X</code> is provided.</p><p><code>interpolate_marcs</code> uses three different interpolation schemes for different stellar parameter regimes. In the standard case the model atmosphere grid is <a href="https://dr17.sdss.org/sas/dr17/apogee/spectro/speclib/atmos/marcs/MARCS_v3_2016/Readme_MARCS_v3_2016.txt">the one generated for SDSS</a>, transformed and linearly interpolated. For cool dwarfs (<code>Teff</code> ≤ 4000 K, <code>logg</code> ≥ 3.5), the grid is resampled onto unchanging <code>tau_5000</code> values and interpolated with a cubic spline. For low-metallicity models (-5 ≤ <code>m_H</code> &lt; -2.5), a grid of standard composition (i.e. fixed alpha and C) atmospheres is used.  (The microturbulence is 1km/s for dwarfs and 2km/s for giants and the mass for spherical models is 1 solar mass.) The interpolation method is the same as in the standard case. See <a href="https://ui.adsabs.harvard.edu/abs/2023arXiv231019823W/abstract">Wheeler+ 2024</a> for more details and a discussion of errors introduced by model atmosphere interpolation. (Note that the cubic scheme for cool dwarfs is referred to as not-yet-implemented in the paper but is now available.)</p><p><strong>keyword arguments</strong></p><ul><li><code>spherical</code>: whether or not to return a ShellAtmosphere (as opposed to a PlanarAtmosphere).  By default true when <code>logg</code> &lt; 3.5.</li><li><code>solar_abundances</code>: (default: <code>grevesse_2007_solar_abundances</code>) The solar abundances to use when <code>A_X</code> is provided instead of <code>M_H</code>, <code>alpha_M</code>, and <code>C_M</code>. The default is chosen to match that of the atmosphere grid, and if you change it you are likely trying to do something else.</li><li><code>clamp_abundances</code>: (default: <code>false</code>) allowed only when specifying <code>A_X</code>. Whether or not to clamp the abundance parameters to be within range to avoid throwing an out of bounds error.</li><li><code>perturb_at_grid_values</code> (default: <code>true</code>): whether or not to add or a subtract a very small number to each parameter which is exactly at a grid value. This prevents null derivatives, which can cause problems for minimizers.</li><li><code>resampled_cubic_for_cool_dwarfs</code> (default: <code>true</code>): whether or not to used specialized method for cool dwarfs.</li><li><code>archives</code>: A tuple containing the atmosphere grids to use.  For testing purposes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L267-L305">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.interpolate_molecular_cross_sections!-Union{Tuple{R}, Tuple{AbstractArray{R}, Any, Korg.Wavelengths, Any, Any, Any}} where R&lt;:Real" href="#Korg.interpolate_molecular_cross_sections!-Union{Tuple{R}, Tuple{AbstractArray{R}, Any, Korg.Wavelengths, Any, Any, Any}} where R&lt;:Real"><code>Korg.interpolate_molecular_cross_sections!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">interpolate_molecular_cross_sections!(α, molecular_cross_sections, λs, Ts, vmic, number_densities)</code></pre><p>Interpolate the molecular cross-sections and add them to the total absorption coefficient <code>α</code>. See <a href="#Korg.MolecularCrossSection-Tuple{Any, Vararg{Any}}"><code>MolecularCrossSection</code></a> for more information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/molecular_cross_sections.jl#L83-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.inverse_gaussian_density-Tuple{Any, Any}" href="#Korg.inverse_gaussian_density-Tuple{Any, Any}"><code>Korg.inverse_gaussian_density</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inverse_gaussian_density(ρ, σ)</code></pre><p>Calculate the inverse of a (0-centered) Gaussian PDF with standard deviation <code>σ</code>, i.e. the value of <code>x</code> for which <code>ρ = exp(-0.5 x^2/σ^2}) / √[2π]</code>, which is given by <code>σ √[-2 log (√[2π]σρ)]</code>.  Returns 0 when ρ is larger than any value taken on by the PDF.</p><p>See also: <a href="#Korg.inverse_lorentz_density-Tuple{Any, Any}"><code>inverse_lorentz_density</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/line_absorption.jl#L116-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.inverse_lorentz_density-Tuple{Any, Any}" href="#Korg.inverse_lorentz_density-Tuple{Any, Any}"><code>Korg.inverse_lorentz_density</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inverse_lorentz_density(ρ, γ)</code></pre><p>Calculate the inverse of a (0-centered) Lorentz PDF with width <code>γ</code>, i.e. the value of <code>x</code> for which <code>ρ = 1 / (π γ (1 + x^2/γ^2))</code>, which is given by <code>√[γ/(πρ) - γ^2]</code>. Returns 0 when ρ is larger than any value taken on by the PDF.</p><p>See also: <a href="#Korg.inverse_gaussian_density-Tuple{Any, Any}"><code>inverse_gaussian_density</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/line_absorption.jl#L132-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ismolecule-Tuple{Korg.Formula}" href="#Korg.ismolecule-Tuple{Korg.Formula}"><code>Korg.ismolecule</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ismolecule(f::Formula)</code></pre><p><code>true</code> when <code>f</code> is composed of more than one atom</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/species.jl#L163-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.lazy_multilinear_interpolation-Tuple{Any, Any, Any}" href="#Korg.lazy_multilinear_interpolation-Tuple{Any, Any, Any}"><code>Korg.lazy_multilinear_interpolation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lazy_multilinear_interpolation(params, nodes, grid; kwargs...)</code></pre><p>This function is does multidimensional linear interpolation on a grid where the first two dimensions represent the values being interpolated.  In other words, it interpolates matrices. It is written to minimize the number of reads from the grid, and access things in an efficient order. It is much faster than Interpolations.linear_interpolation when applied to memory-mapped grids. At present it is used only for model atmosphere and departure coefficient interpolation.</p><p>See also: <a href="../API/#Korg.interpolate_marcs"><code>interpolate_marcs</code></a>, <a href="#Korg.CubicSplines.CubicSpline-Tuple{Any, Any}"><code>Korg.CubicSplines.CubicSpline</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/lazy_multilinear_interpolation.jl#L8-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.line_absorption!-Tuple{Any, Any, Korg.Wavelengths, Vararg{Any, 6}}" href="#Korg.line_absorption!-Tuple{Any, Any, Korg.Wavelengths, Vararg{Any, 6}}"><code>Korg.line_absorption!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">line_absorption!(α, linelist, λs, temp, nₑ, n_densities, partition_fns, ξ
               ; α_cntm=nothing, cutoff_threshold=1e-3, window_size=20.0*1e-8)</code></pre><p>Calculate the opacity coefficient, α, in units of cm^-1 from all lines in <code>linelist</code>, at wavelengths <code>λs</code> [cm^-1].</p><p>other arguments:</p><ul><li><code>temp</code> the temerature in K (as a vector, for multiple layers, if you like)</li><li><code>n_densities</code>, a Dict mapping species to absolute number density in cm^-3 (as a vector, if temp is a vector).</li><li><code>partition_fns</code>, a Dict containing the partition function of each species</li><li><code>ξ</code> is the microturbulent velocity in cm/s (n.b. NOT km/s)</li><li><code>α_cntm</code> is as a callable returning the continuum opacity as a function of wavelength. The window within which a line is calculated will extend to the wavelength at which the Lorentz wings or Doppler core of the line are at <code>cutoff_threshold * α_cntm[line.wl]</code>, whichever is greater.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>cuttoff_threshold</code> (default: 3e-4): see <code>α_cntm</code></li><li><code>tasks_per_thread</code> (default: 1): the number of tasks to run per Julia thread. This function is multithreaded over the lines in <code>linelist</code>.</li><li><code>verbose</code> (deprecated): no longer used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/line_absorption.jl#L5-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.line_profile-NTuple{5, Real}" href="#Korg.line_profile-NTuple{5, Real}"><code>Korg.line_profile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">line_profile(λ₀, σ, γ, amplitude, λ)</code></pre><p>A voigt profile centered on λ₀ with Doppler width σ (NOT √[2] σ, as the &quot;Doppler width&quot; is often defined) and Lorentz HWHM γ evaluated at <code>λ</code> (cm).  Returns values in units of cm^-1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/line_absorption.jl#L224-L229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.load_ExoMol_linelist-NTuple{5, Any}" href="#Korg.load_ExoMol_linelist-NTuple{5, Any}"><code>Korg.load_ExoMol_linelist</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_ExoMol_linelist(specs, states_file, transitions_file, upper_wavelength, lower_wavelength)</code></pre><p>Load a linelist from ExoMol. Returns a vector of <a href="#Korg.Line-Union{Tuple{F6}, Tuple{F5}, Tuple{F4}, Tuple{F3}, Tuple{F2}, Tuple{F1}, Tuple{F1, F2, Korg.Species, F3}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}, Union{Missing, Tuple{F6, F6}, F6}}} where {F1&lt;:Real, F2&lt;:Real, F3&lt;:Real, F4&lt;:Real, F5&lt;:Real, F6&lt;:Real}"><code>Line</code></a>s, the same as <a href="../API/#Korg.read_linelist"><code>read_linelist</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>spec</code>: the species, i.e. the molecule that the linelist is for</li><li><code>states_file</code>: the path to the ExoMol states file</li><li><code>transitions_file</code>: the path to the ExoMol, transitions file</li><li><code>upper_wavelength</code>: the upper limit of the wavelength range to load (Å)</li><li><code>lower_wavelength</code>: the lower limit of the wavelength range to load (Å)</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>line_strength_cutoff</code>: the cutoff for the line strength (default: -15) used to filter the linelist. See <a href="#Korg.approximate_line_strength-Tuple{Korg.Line, Any}"><code>approximate_line_strength</code></a> for more information.</li><li><code>T_line_strength</code>: the temperature (K) at which to evaluate the line strength (default: 3500.0)</li></ul><div class="admonition is-warning" id="Warning-2e90b3b560491071"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-2e90b3b560491071" title="Permalink"></a></header><div class="admonition-body"><p>This functionality is in beta.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L181-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.load_atomic_partition_functions" href="#Korg.load_atomic_partition_functions"><code>Korg.load_atomic_partition_functions</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_atomic_partition_functions()</code></pre><p>Loads saved tabulated values for atomic partition functions from disk. Returns a dictionary mapping species to interpolators over log(T).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/read_statmech_quantities.jl#L166-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.load_exomol_partition_functions-Tuple{}" href="#Korg.load_exomol_partition_functions-Tuple{}"><code>Korg.load_exomol_partition_functions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_exomol_partition_functions()</code></pre><p>Loads the exomol partition functions for polyatomic molecules from the HDF5 archive. Returns a dictionary mapping species to interpolators over log(T).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/read_statmech_quantities.jl#L200-L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.merge_bounds" href="#Korg.merge_bounds"><code>Korg.merge_bounds</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge_bounds(bounds, merge_distance=0.0)</code></pre><p>Sort a vector of lower-bound, upper-bound pairs and merge overlapping ranges.</p><p>Returns a pair containing:</p><ul><li>a vector of merged bounds</li><li>a vector of vectors of indices of the original bounds which were merged into each merged bound</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/utils.jl#L7-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.merge_close_lines-Tuple{Any}" href="#Korg.merge_close_lines-Tuple{Any}"><code>Korg.merge_close_lines</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge_close_lines(linelist; merge_distance=0.2)</code></pre><p>Produce a list of the species and wavelengths of the lines in <code>linelist</code>, merging lines of the same species that are within <code>merge_distance</code> (default: 0.2 Å).  This is useful for labeling lines in a plot after running <a href="../API/#Korg.prune_linelist"><code>prune_linelist</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>linelist</code>: the linelist (a vector of <code>Line</code> objects)</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>merge_distance=0.2</code>: The maximum distance in Å between lines of the same species to be merged into a single entry</li></ul><p><strong>Returns</strong></p><p>A vector of tuples <code>(wl, wl_low, wl_high, species)</code> where <code>wl</code> is gf-weighted wavelength of each set of merged lines (Å), <code>wl_low</code> and <code>wl_high</code> are their highest and lowest wavelength, and <code>species</code> is a string (not a <code>Korg.Species</code>) identifying the species of the line. These will be in wavelength order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/prune_linelist.jl#L111-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.n_atoms-Tuple{Korg.Formula}" href="#Korg.n_atoms-Tuple{Korg.Formula}"><code>Korg.n_atoms</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">n_atoms(x)</code></pre><p>The number of atoms in the Korg.Species or Korg.Formula x.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/species.jl#L120-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.prune_linelist-Tuple{Any, Any, Any, Vararg{Any}}" href="#Korg.prune_linelist-Tuple{Any, Any, Any, Vararg{Any}}"><code>Korg.prune_linelist</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prune_linelist(atm, linelist, A_X, wls...; threshold=1.0, sort=true, synthesis_kwargs...)</code></pre><p>Return the vector containing the strongest lines in  <code>linelist</code>, (optionally) sorted by approximate equivalent width.</p><p><strong>Arguments</strong></p><ul><li><code>atm</code>: the atmosphere model</li><li><code>linelist</code>: the linelist (a vector of <code>Line</code> objects)</li><li><code>A_X</code>: the abundance of each element (see <a href="../API/#Korg.format_A_X"><code>format_A_X</code></a>)</li><li><code>wls...</code>: the wavelength ranges to synthesize over.  These are specified the same way as the <code>wls</code> for <a href="../API/#Korg.synthesize"><code>synthesize</code></a>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>threshold=0.1</code>: The threshold ratio in the line center absorption to the continuum absorption computed at the photosphere for a line to be included in the returned list. <code>0.1</code> is a reasonable default for getting a sense of what might be measurable in a high-res, high-quality spectrum, but it should not be used to create a linelist for synthesis.</li><li><code>sort_by_EW=true</code>: If <code>true</code>, the returned linelist will be sorted by approximate reduced equivalent width.  If <code>false</code>, the linelist will be in wavelength order. Leaving the list in wavelength order is much faster, but sorting by strength is useful for visualizing the strongest lines.</li><li><code>verbose=true</code>: If <code>true</code>, a progress bar will be displayed while measuring the EWs. All other kwargs are passed to internal calls to <a href="../API/#Korg.synthesize"><code>synthesize</code></a>.</li><li><code>max_distance=0.0</code>, how far from <code>wls</code> lines can be (in Å) before they are excluded from the returned list.</li></ul><div class="admonition is-category-caution" id="Caution-1288e31dfb53c929"><header class="admonition-header">Caution<a class="admonition-anchor" href="#Caution-1288e31dfb53c929" title="Permalink"></a></header><div class="admonition-body"><p>While this function can be used to prune a linelist for synthesis, the default behavior too aggressive for this purpose.  Set a much lower threshold (e.g. <code>threshold=1e-4</code>) and use <code>sort_by_EW=false</code> if you are pruning the linelist to speedup synthesis.  Note that Korg will dynamically choose which lines to include even if you use a large linelist (see the <code>line_cutoff_threshold</code> keyword argument to <a href="../API/#Korg.synthesize"><code>synthesize</code></a>).</p></div></div><p>See also <a href="../API/#Korg.merge_close_lines"><code>merge_close_lines</code></a> if you are using this for plotting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/prune_linelist.jl#L1-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.read_Barklem_Collet_logKs-Tuple{Any}" href="#Korg.read_Barklem_Collet_logKs-Tuple{Any}"><code>Korg.read_Barklem_Collet_logKs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_Barklem_Collet_logKs(fname)</code></pre><p>Reads the equilibrium constants from the HDF5 file produced by the Barklem and Collet 2016 paper. Returns a Dict from Korg.Species to Korg.CubicSplines from ln(T) to log10(K).</p><p>As recommended by <a href="https://ui.adsabs.harvard.edu/abs/2024MNRAS.531.4538A/">Aquilina+ 2024</a>, we modify the C2 equilibrium constant reflect the dissociation energy reported by <a href="https://doi.org/10.1080/00268976.2018.1564849">Visser+ 2019</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/read_statmech_quantities.jl#L101-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.read_Barklem_Collet_table-Tuple{Any}" href="#Korg.read_Barklem_Collet_table-Tuple{Any}"><code>Korg.read_Barklem_Collet_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function read_Barklem_Collet_table(fname; transform=identity)</code></pre><p>Constructs a Dict holding tables containing partition function or equilibrium constant values across ln(temperature).  Applies transform (which you can use to, e.g. change units) to each example.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/read_statmech_quantities.jl#L131-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.read_linelist-Tuple{String}" href="#Korg.read_linelist-Tuple{String}"><code>Korg.read_linelist</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_linelist(filename; format=&quot;vald&quot;, isotopic_abundances=Korg.isotopic_abundances)</code></pre><p>Parse a linelist file, returning a vector of <a href="#Korg.Line-Union{Tuple{F6}, Tuple{F5}, Tuple{F4}, Tuple{F3}, Tuple{F2}, Tuple{F1}, Tuple{F1, F2, Korg.Species, F3}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}, Union{Missing, Tuple{F6, F6}, F6}}} where {F1&lt;:Real, F2&lt;:Real, F3&lt;:Real, F4&lt;:Real, F5&lt;:Real, F6&lt;:Real}"><code>Line</code></a>s.</p><p>The <code>format</code> keyword argument can be used to specify one of these linelist formats (default: <code>&quot;vald&quot;</code>):</p><ul><li><code>&quot;vald&quot;</code> for a <a href="http://vald.astro.uu.se/%7Evald/php/vald.php">VALD</a> linelist. These can be either &quot;short&quot; or &quot;long&quot; format, &quot;extract all&quot; or &quot;extract stellar&quot;.  Air wavelengths will automatically be converted into vacuum wavelengths, and energy levels will be automatically converted from cm<span>$^{-1}$</span> to eV.</li><li><code>&quot;kurucz&quot;</code> for an atomic or molecular <a href="http://kurucz.harvard.edu/linelists.html">Kurucz linelist</a> (format=kurucz_vac if it uses vacuum wavelengths; be warned that Korg will not assume that wavelengths are vacuum below 2000 Å),</li><li><code>&quot;moog&quot;</code> for a <a href="http://www.as.utexas.edu/%7Echris/moog.html">MOOG linelist</a> (doesn&#39;t support broadening parameters or dissociation energies, assumed to be in vacuum wavelengths).</li><li><code>&quot;moog_air&quot;</code> for a MOOG linelist in air wavelengths.</li><li><code>&quot;turbospectrum&quot;</code> for a <a href="https://github.com/bertrandplez/Turbospectrum2019/blob/master/DOC/Readme-Linelist_format_v.19">Turbospectrum linelist</a> in air wavelengths. Note that Korg doesn&#39;t make use of the (optional) orbital angular momentum quantum number, l, for the upper or lower levels, so it won&#39;t fall back on generic ABO recipes when the ABO parameters are not available. Korg&#39;s interpretation of the <code>fdamp</code> parameter is also slightly different from Turbospectrum&#39;s. See the documentation of the <code>vdW</code> parameter of <a href="#Korg.Line-Union{Tuple{F6}, Tuple{F5}, Tuple{F4}, Tuple{F3}, Tuple{F2}, Tuple{F1}, Tuple{F1, F2, Korg.Species, F3}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}, Union{Missing, Tuple{F6, F6}, F6}}} where {F1&lt;:Real, F2&lt;:Real, F3&lt;:Real, F4&lt;:Real, F5&lt;:Real, F6&lt;:Real}"><code>Line</code></a> for details.  Korg will error if encounters an Unsoeld fudge factor, which it does not support.</li><li>&quot;turbospectrum_vac&quot; for a Turbospectrum linelist in vacuum wavelengths.</li><li>&quot;korg&quot; for a Korg linelist (saved with hdf5). If the filename ends in <code>.h5</code>, this will be used by default.</li></ul><p>For VALD and Turbospectrum linelists with isotope information available, Korg will scale log gf values by isotopic abundance (unless VALD has already pre-scaled them), using isotopic abundances from <a href="https://www.nist.gov/pml/atomic-weights-and-isotopic-compositions-relative-atomic-masses">NIST</a> ([Korg.isotopic<em>abundances]). To use custom isotopic abundances, just pass `isotopic</em>abundances` with the same structure: a dict mapping atomic number to a dict mapping from atomic weight to abundance.</p><p>Be warned that for linelists which are pre-scaled for isotopic abundance, the estimation of radiative broadening from log(gf) is not accurate.</p><p>See also: <a href="../API/#Korg.load_ExoMol_linelist"><code>load_ExoMol_linelist</code></a>, <a href="#Korg.save_linelist-Tuple{Any, Any}"><code>save_linelist</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L276-L317">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.read_model_atmosphere-Tuple{AbstractString}" href="#Korg.read_model_atmosphere-Tuple{AbstractString}"><code>Korg.read_model_atmosphere</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_model_atmosphere(filename)</code></pre><p>Parse the provided model atmosphere file in MARCS &quot;.mod&quot; format.  Returns either a <code>PlanarAtmosphere</code> or a <code>ShellAtmosphere</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/atmosphere.jl#L141-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.read_molecular_cross_section-Tuple{Any}" href="#Korg.read_molecular_cross_section-Tuple{Any}"><code>Korg.read_molecular_cross_section</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_molecular_cross_section(filename)</code></pre><p>Read a precomputed molecular cross-section from a file created by <a href="#Korg.save_molecular_cross_section-Tuple{Any, Any}"><code>save_molecular_cross_section</code></a>. See also <a href="#Korg.MolecularCrossSection-Tuple{Any, Vararg{Any}}"><code>MolecularCrossSection</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/molecular_cross_sections.jl#L126-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.saha_ion_weights-Tuple{Any, Any, Any, Any, Dict}" href="#Korg.saha_ion_weights-Tuple{Any, Any, Any, Any, Dict}"><code>Korg.saha_ion_weights</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">saha_ion_weights(T, nₑ, atom, ionization_energies, partition_functions)</code></pre><p>Returns <code>(wII, wIII)</code>, where <code>wII</code> is the ratio of singly ionized to neutral atoms of a given element, and <code>wIII</code> is the ration of doubly ionized to neutral atoms.</p><p>arguments:</p><ul><li>temperature <code>T</code> [K]</li><li>electron number density <code>nₑ</code> [cm^-3]</li><li>atom, the atomic number of the element</li><li><code>ionization_energies</code> is a collection indexed by integers (e.g. a <code>Vector</code>) mapping elements&#39; atomic numbers to their first three ionization energies</li><li><code>partition_funcs</code> is a <code>Dict</code> mapping species to their partition functions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/statmech.jl#L3-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.save_linelist-Tuple{Any, Any}" href="#Korg.save_linelist-Tuple{Any, Any}"><code>Korg.save_linelist</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_linelist(path, linelist)</code></pre><p>Save a Korg linelist (a <code>Vector{Line}</code>) to an HDF5 file which can be read by <code>read_linelist</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/linelist.jl#L671-L675">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.save_molecular_cross_section-Tuple{Any, Any}" href="#Korg.save_molecular_cross_section-Tuple{Any, Any}"><code>Korg.save_molecular_cross_section</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_molecular_cross_section(filename, cross_section)</code></pre><p>Save a precomputed molecular cross-section to a file. See also <a href="#Korg.MolecularCrossSection-Tuple{Any, Vararg{Any}}"><code>MolecularCrossSection</code></a>, <a href="#Korg.read_molecular_cross_section-Tuple{Any}"><code>read_molecular_cross_section</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/molecular_cross_sections.jl#L106-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.scaled_stark-Tuple{Any, Any}" href="#Korg.scaled_stark-Tuple{Any, Any}"><code>Korg.scaled_stark</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>the stark broadening gamma scaled acording to its temperature dependence</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/line_absorption.jl#L177-L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.scaled_vdW-Union{Tuple{F}, Tuple{Tuple{F, F}, Any, Any}} where F&lt;:Real" href="#Korg.scaled_vdW-Union{Tuple{F}, Tuple{Tuple{F, F}, Any, Any}} where F&lt;:Real"><code>Korg.scaled_vdW</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scaled_vdW(vdW, m, T)</code></pre><p>The vdW broadening gamma scaled acording to its temperature dependence, using either simple scaling or ABO. See Anstee &amp; O&#39;Mara (1995) or <a href="https://github.com/barklem/public-data/tree/master/broadening-howto">Paul Barklem&#39;s notes</a> for the definition of the ABO γ.</p><p><code>vdW</code> should be either <code>γ_vdW</code> evaluated at 10,000 K, or tuple containing the ABO params <code>(σ, α)</code>. The species mass, <code>m</code>, is ignored in the former case.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/line_absorption.jl#L182-L192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.setup_ionization_energies" href="#Korg.setup_ionization_energies"><code>Korg.setup_ionization_energies</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setup_ionization_energies([filename])</code></pre><p>Parses the table of ionization energies and returns it as a dictionary mapping elements to their ionization energies, <code>[χ₁, χ₂, χ₃]</code> in eV.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/read_statmech_quantities.jl#L4-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.setup_partition_funcs_and_equilibrium_constants-Tuple{}" href="#Korg.setup_partition_funcs_and_equilibrium_constants-Tuple{}"><code>Korg.setup_partition_funcs_and_equilibrium_constants</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setup_partition_funcs_and_equilibrium_constants()</code></pre><p>Returns two dictionaries. One holding the default partition functions, and one holding the default log10 equilibrium constants.</p><p><strong>Default partition functions</strong></p><p>The partition functions are custom (calculated from NIST levels) for atoms, from Barklem &amp; Collet 2016 for diatomic molecules, and from <a href="https://exomol.com">exomol</a> for polyatomic molecules. For each molecule, we include only the most abundant isotopologue.</p><p>Note than none of these partition functions include plasma effects, e.g. via the Mihalas Hummer Daeppen occupation probability formalism. They are for isolated species. This can lead to a couple percent error for neutral alkalis and to greater errors for hydrogen in some atmospheres, particularly those of hot stars.</p><p><strong>Default equilibrium constants</strong></p><p>Molecules have equilibrium constants in addition to partition functions.  For the diatomics, these are provided by Barklem and Collet, which extensively discusses the dissociation energies.  For polyatomics, we calculate these ourselves, using atomization energies calculated from the enthalpies of formation at 0K from <a href="https://cccbdb.nist.gov/hf0k.asp">NIST&#39;s CCCDB</a>.</p><p>Korg&#39;s equilibrium constants are in terms of partial pressures, since that&#39;s what Barklem and Collet provide.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/read_statmech_quantities.jl#L26-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.sigma_line-Tuple{Real}" href="#Korg.sigma_line-Tuple{Real}"><code>Korg.sigma_line</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sigma_line(wl)</code></pre><p>The cross-section (divided by gf) at wavelength <code>wl</code> in Ångstroms of a transition for which the product of the degeneracy and oscillator strength is <code>10^log_gf</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/line_absorption.jl#L208-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.subspectrum_indices-Tuple{Korg.Wavelengths}" href="#Korg.subspectrum_indices-Tuple{Korg.Wavelengths}"><code>Korg.subspectrum_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subspectrum_indices(wls::Wavelengths)</code></pre><p>Returns a vector of Julia ranges, which can be used to index into the full spectrum to get the sub-spectrum corresponding to each wavelength range in <code>wls</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/wavelengths.jl#L132-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.synth-Tuple{}" href="#Korg.synth-Tuple{}"><code>Korg.synth</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">synth(kwargs...)</code></pre><p>This function creates a synthetic spectrum. It&#39;s easier to use than <a href="../API/#Korg.synthesize"><code>synthesize</code></a>, but it gives you less control. Unlike <a href="../API/#Korg.synthesize"><code>synthesize</code></a>, it <strong>returns a tuple of <code>(wavelengths, rectified_flux, cntm)</code></strong> (Wavelength in Å, rectified flux as a unitless number between 0 and 1, and continuum in erg/s/cm^5).  <code>Korg.synth</code> also provides shortcuts for some ways you might want to post-process the spectrum (applying a LSF, rotation, etc).</p><p><strong>Keyword arguments</strong></p><ul><li><code>Teff</code>: effective temperature in K (default: 5000)</li><li><code>logg</code>: surface gravity in cgs units (default: 4.5)</li><li><code>m_H</code>: metallicity, [metals/H], (default: 0.0) (See <a href="../API/#Korg.format_A_X"><code>format_A_X</code></a> for precisely how this is interpreted.)</li><li><code>alpha_H</code>: alpha enhancement, [α/H], (default: <code>m_H</code>) (See <a href="../API/#Korg.format_A_X"><code>format_A_X</code></a> for precisely how this is interpreted.)</li><li><em>Any atomic symbol</em> (e.g. <code>Fe</code> or <code>C</code>) can be used to to specify a (solar relative, [<em>X</em>/H]) abundance. These override <code>m_H</code> and <code>alpha_H</code>. Specifying an individual abundance means that the true metallicity and alpha will not correspond precisely to the values of <code>m_H</code> and <code>alpha_H</code>. See <a href="../API/#Korg.format_A_X"><code>format_A_X</code></a> for details.</li><li><code>linelist</code>: a linelist, (default: <a href="#Korg.get_VALD_solar_linelist-Tuple{}"><code>get_VALD_solar_linelist()</code></a>). See also <a href="../API/#Korg.read_linelist"><code>read_linelist</code></a>.</li><li><code>wavelengths</code>: a tuple of the start and end wavelengths (default: (5000, 6000)), or a vector of <code>(λstart, λstop)</code> pairs. See <a href="#Korg.Wavelengths"><code>Wavelengths</code></a> for all the ways the wavelengths can be specified.</li><li><code>rectify</code>: whether to rectify (continuum normalize) the spectrum (default: true)</li><li><code>R</code>: resolution (default: <code>Inf</code>, no LSF applied). <code>R</code> can be a scalar, or a function from wavelength (in Å) to resolving power. See <a href="../API/#Korg.apply_LSF"><code>apply_LSF</code></a> for details on how to do this manually.</li><li><code>vsini</code>: projected rotational velocity in km/s (default: 0). This calls <a href="#Korg.apply_rotation"><code>apply_rotation</code></a> under the hood.</li><li><code>vmic</code>: microturbulent velocity in km/s (default: 1.0).</li><li><code>synthesize_kwargs</code>: additional keyword arguments pass to <a href="../API/#Korg.synthesize"><code>synthesize</code></a>.</li><li><code>format_A_X_kwargs</code>: additional keyword arguments pass to <a href="../API/#Korg.format_A_X"><code>format_A_X</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/synth.jl#L1-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.synthesize-Tuple{Korg.ModelAtmosphere, Any, AbstractVector{&lt;:Real}, Vararg{Any}}" href="#Korg.synthesize-Tuple{Korg.ModelAtmosphere, Any, AbstractVector{&lt;:Real}, Vararg{Any}}"><code>Korg.synthesize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">synthesize(atm, linelist, A_X, λ_start, λ_stop; kwargs... )
synthesize(atm, linelist, A_X, wavelength_ranges; kwargs... )</code></pre><p>Compute a synthetic spectrum. Returns a <a href="#Korg.SynthesisResult"><code>SynthesisResult</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>atm</code>: the model atmosphere (see <a href="../API/#Korg.interpolate_marcs"><code>interpolate_marcs</code></a> and <a href="../API/#Korg.read_model_atmosphere"><code>read_model_atmosphere</code></a>)</li><li><code>linelist</code>: A vector of <a href="#Korg.Line-Union{Tuple{F6}, Tuple{F5}, Tuple{F4}, Tuple{F3}, Tuple{F2}, Tuple{F1}, Tuple{F1, F2, Korg.Species, F3}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}, Union{Missing, Tuple{F6, F6}, F6}}} where {F1&lt;:Real, F2&lt;:Real, F3&lt;:Real, F4&lt;:Real, F5&lt;:Real, F6&lt;:Real}"><code>Line</code></a>s (see <a href="../API/#Korg.read_linelist"><code>read_linelist</code></a>, <a href="../API/#Korg.get_APOGEE_DR17_linelist"><code>get_APOGEE_DR17_linelist</code></a>, <a href="../API/#Korg.get_GES_linelist"><code>get_GES_linelist</code></a>, <a href="../API/#Korg.get_GALAH_DR3_linelist"><code>get_GALAH_DR3_linelist</code></a>, and <a href="../API/#Korg.get_VALD_solar_linelist"><code>get_VALD_solar_linelist</code></a>).</li><li><code>A_X</code>: a vector containing the A(X) abundances (log(X/H) + 12) for elements from hydrogen to uranium.  <a href="../API/#Korg.format_A_X"><code>format_A_X</code></a> can be used to easily create this vector.</li><li>The wavelengths at which to synthesize the spectrum.  They can be specified either as a pair <code>(λstart, λstop)</code>, or as a list of pairs <code>[(λstart1, λstop1), (λstart2, λstop2), ...]</code> (or as an valid arugments to the <a href="#Korg.Wavelengths"><code>Wavelengths</code></a> constructor).</li></ul><p><strong>Example</strong></p><p>To synthesize a spectrum between 5000 Å and 5100 Å, with all metal abundances set to 0.5 dex less than the solar value except carbon, which we set to [C/H]=-0.25:</p><pre><code class="nohighlight hljs">atm = read_model_atmosphere(&quot;path/to/atmosphere.mod&quot;)
linelist = read_linelist(&quot;path/to/linelist.vald&quot;)
A_X = format_A_X(-0.5, Dict(&quot;C&quot; =&gt; -0.25))
result = synthesize(atm, linelist, A_X, 5000, 5100)</code></pre><p><strong>Optional arguments:</strong></p><ul><li><code>vmic</code> (default: 0) is the microturbulent velocity, <span>$\xi$</span>, in km/s.</li><li><code>line_buffer</code> (default: 10): the farthest (in Å) any line can be from the provided wavelength range before it is discarded.  If the edge of your window is near a strong line, you may have to turn this up.</li><li><code>cntm_step</code> (default 1): the distance (in Å) between point at which the continuum opacity is calculated.</li><li><code>hydrogen_lines</code> (default: <code>true</code>): whether or not to include H lines in the synthesis.</li><li><code>use_MHD_for_hydrogen_lines</code> (default: <code>true</code>): whether or not to use the MHD occupation probability formalism for hydrogen lines. (MHD is always used for hydrogen bound-free absorption.)</li><li><code>hydrogen_line_window_size</code> (default: 150): the maximum distance (in Å) from each hydrogen line center at which to calculate its contribution to the total absorption coefficient.</li><li><code>mu_values</code> (default: 20): the number of μ values at which to calculate the surface flux, or a vector of the specific values to use when doing transfer in spherical geometry. If <code>mu_points</code> is an integer, the values are chosen per Gauss-Legendre integration. If they are specified directly, the trapezoid rule is used for the astrophysical flux. The default values is sufficient for accuracy at the 10^-3 level. Note that if you are using the default radiative transfer scheme, with a plane-parallel model atmosphere, the integral over μ is exact, so this parameter has no effect. The points and weights are returned in the <code>mu_grid</code> field of the output.</li><li><code>line_cutoff_threshold</code> (default: <code>3e-4</code>): the fraction of the continuum absorption coefficient at which line profiles are truncated.  This has major performance impacts, since line absorption calculations dominate more syntheses.  Turn it down for more precision at the expense of runtime. The default value should effect final spectra below the 10^-3 level.</li><li><code>electron_number_density_warn_threshold</code> (default: <code>Inf</code>): if the relative difference between the calculated electron number density and the input electron number density is greater than this value, a warning is printed.  By default, this warning is suppress (threshold is <code>Inf</code>) because it is very easily raised in cases where it is of no observable consequence. See also <code>electron_number_density_warn_min_value</code>, below.</li><li><code>electron_number_density_warn_min_value</code> (default: <code>1e-4</code>): The minimum value of the ratio of the electron number density to the total number density at which a warning is printed.</li><li><code>return_cntm</code> (default: <code>true</code>): whether or not to return the continuum at each wavelength.  If this is false, <code>solution.cntm</code> will be <code>nothing</code>.</li><li><code>ionization_energies</code>, a <code>Dict</code> mapping <code>Species</code> to their first three ionization energies, defaults to <code>Korg.ionization_energies</code>.</li><li><code>partition_funcs</code>, a <code>Dict</code> mapping <code>Species</code> to partition functions (in terms of ln(T)). Defaults to data from Barklem &amp; Collet 2016, <code>Korg.default_partition_funcs</code>.</li><li><code>equilibrium_constants</code>, a <code>Dict</code> mapping <code>Species</code> representing diatomic molecules to the base-10 log of their molecular equilibrium constants in partial pressure form.  Defaults to data from Barklem and Collet 2016, <code>Korg.default_log_equilibrium_constants</code>.</li><li><code>use_chemical_equilibrium_from</code> (default: <code>nothing</code>): Takes another solution returned by <code>synthesize</code>. When provided, the chemical equilibrium solution will be taken from this object, rather than being recomputed. This is physically self-consistent only when the abundances, <code>A_X</code>, and model atmosphere, <code>atm</code>, are unchanged.</li><li><code>molecular_cross_sections</code> (default: <code>[]</code>): A vector of precomputed molecular cross-sections. See <a href="#Korg.MolecularCrossSection-Tuple{Any, Vararg{Any}}"><code>MolecularCrossSection</code></a> for how to generate these. If you are using the default radiative transfer scheme, your molecular cross-sections should cover 5000 Å only if your linelist does.</li><li><code>tau_scheme</code> (default: &quot;linear&quot;): how to compute the optical depth.  Options are &quot;linear&quot; and &quot;bezier&quot; (testing only–not recommended).</li><li><code>I_scheme</code> (default: <code>&quot;linear_flux_only&quot;</code>): how to compute the intensity.  Options are <code>&quot;linear&quot;</code>, <code>&quot;linear_flux_only&quot;</code>, and <code>&quot;bezier&quot;</code>.  <code>&quot;linear_flux_only&quot;</code> is the fastest, but does not return the intensity values anywhere except at the top of the atmosphere.  &quot;linear&quot; performs an equivalent calculation, but stores the intensity at every layer. <code>&quot;bezier&quot;</code> is for testing and not recommended.</li><li><code>verbose</code> (default: <code>false</code>): Whether or not to print information about progress, etc.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/synthesize.jl#L42-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.translational_U-Tuple{Any, Any}" href="#Korg.translational_U-Tuple{Any, Any}"><code>Korg.translational_U</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">translational_U(m, T)</code></pre><p>The (possibly inverse) contribution to the partition function from the free movement of a particle. Used in the Saha equation.</p><p>arguments</p><ul><li><code>m</code> is the particle mass</li><li><code>T</code> is the temperature in K</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/statmech.jl#L37-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.vacuum_to_air-Tuple{Any}" href="#Korg.vacuum_to_air-Tuple{Any}"><code>Korg.vacuum_to_air</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vacuum_to_air(λ; cgs=λ&lt;1)</code></pre><p>convert λ from a vacuum to air.  λ is assumed to be in Å if it is ⩾ 1, in cm otherwise.  Formula from Birch and Downs (1994) via the VALD website.</p><p>See also: <a href="../API/#Korg.air_to_vacuum"><code>air_to_vacuum</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/utils.jl#L238-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.voigt_hjerting-Tuple{Any, Any}" href="#Korg.voigt_hjerting-Tuple{Any, Any}"><code>Korg.voigt_hjerting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">voigt_hjerting(α, v)</code></pre><p>The <a href="https://en.wikipedia.org/wiki/Voigt_profile#Voigt_functions">Hjerting function</a>, <span>$H$</span>, somtimes called the Voigt-Hjerting function. <span>$H$</span> is defined as <code>H(α, v) = ∫^∞_∞ exp(-y^2) / ((u-y)^2 + α^2) dy</code> (see e.g. the unnumbered equation after Gray equation 11.47).  It is equal to the ratio of the absorption coefficient to the value of the absorption coefficient obtained at the line center with only Doppler broadening.</p><p>If <code>x = λ-λ₀</code>, <code>Δλ_D = σ√2</code> is the Doppler width, and <code>Δλ_L = 4πγ</code> is the Lorentz width,</p><pre><code class="nohighlight hljs">voigt(x|Δλ_D, Δλ_L) = H(Δλ_L/(4πΔλ_D), x/Δλ_D) / (Δλ_D√π)
                    = H(γ/(σ√2), x/(σ√2)) / (σ√(2π))</code></pre><p>Approximation from <a href="https://ui.adsabs.harvard.edu/abs/1956ZA.....39...36H/abstract">Hunger 1965</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/line_absorption.jl#L252-L270">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.λ_to_ν_bound-Tuple{Korg.Interval}" href="#Korg.λ_to_ν_bound-Tuple{Korg.Interval}"><code>Korg.λ_to_ν_bound</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">λ_to_ν_bound(λ_bound)</code></pre><p>Converts a λ <code>Inverval</code> (in cm) to an equivalent ν <code>Interval</code> (in Hz), correctly accounting for tricky floating point details at the bounds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/utils.jl#L335-L340">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Fit" href="#Korg.Fit"><code>Korg.Fit</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Functions for fitting to data.</p><div class="admonition is-warning" id="Warning-2cef068ca8894221"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-2cef068ca8894221" title="Permalink"></a></header><div class="admonition-body"><p>This submodule is in beta. It&#39;s API may change.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/Fit/Fit.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Fit.calculate_EWs-Tuple{Any, Any, Any}" href="#Korg.Fit.calculate_EWs-Tuple{Any, Any, Any}"><code>Korg.Fit.calculate_EWs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_EWs(atm, linelist, A_X; kwargs...)</code></pre><p>Calculate the equivalent widths of the lines in <code>linelist</code> in the spectrum synthesized from <code>atm</code> with abundances <code>A_X</code>.</p><p><strong>Arguments:</strong></p><ul><li><code>atm</code>: the model atmosphere (see <a href="../API/#Korg.read_model_atmosphere"><code>Korg.read_model_atmosphere</code></a> and <a href="../API/#Korg.interpolate_marcs"><code>Korg.interpolate_marcs</code></a>).</li><li><code>linelist</code>: A vector of <a href="#Korg.Line-Union{Tuple{F6}, Tuple{F5}, Tuple{F4}, Tuple{F3}, Tuple{F2}, Tuple{F1}, Tuple{F1, F2, Korg.Species, F3}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}, Union{Missing, Tuple{F6, F6}, F6}}} where {F1&lt;:Real, F2&lt;:Real, F3&lt;:Real, F4&lt;:Real, F5&lt;:Real, F6&lt;:Real}"><code>Korg.Line</code></a>s (see <a href="../API/#Korg.read_linelist"><code>Korg.read_linelist</code></a>).  The lines must be sorted by wavelength.</li><li><code>A_X</code>: a vector containing the A(X) abundances (log(n<em>X/n</em>H) + 12) for elements from hydrogen to uranium (<a href="../API/#Korg.format_A_X"><code>Korg.format_A_X</code></a> exists as a convenience for creating this vector). All syntheses are done with these abundances, so if the resulting abundances deviate significantly from these, you may wish to iterate.</li></ul><p><strong>Keyword arguments:</strong></p><ul><li><code>ew_window_size</code> (default: 2): the farthest (in Å) to consider equivalent width contributions for each line.</li><li><code>wl_step</code> (default: 0.01): the resolution in Å at which to synthesize the spectrum around each line.</li><li><code>blend_warn_threshold</code> (default: 0.01): the minimum depth between two lines allowed before triggering a warning that they may be blended.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/Fit/fit_via_EWs.jl#L4-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Fit.ews_to_abundances-NTuple{4, Any}" href="#Korg.Fit.ews_to_abundances-NTuple{4, Any}"><code>Korg.Fit.ews_to_abundances</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ews_to_abundances(atm, linelist, A_X, measured_EWs; kwargs... )</code></pre><p>Compute per-line abundances on the linear part of the curve of growth given a model atmosphere and a list of lines with equivalent widths.</p><p><strong>Arguments:</strong></p><ul><li><code>atm</code>: the model atmosphere (see <a href="../API/#Korg.read_model_atmosphere"><code>Korg.read_model_atmosphere</code></a> and <a href="../API/#Korg.interpolate_marcs"><code>Korg.interpolate_marcs</code></a>).</li><li><code>linelist</code>: A vector of <a href="#Korg.Line-Union{Tuple{F6}, Tuple{F5}, Tuple{F4}, Tuple{F3}, Tuple{F2}, Tuple{F1}, Tuple{F1, F2, Korg.Species, F3}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}, Union{Missing, Tuple{F6, F6}, F6}}} where {F1&lt;:Real, F2&lt;:Real, F3&lt;:Real, F4&lt;:Real, F5&lt;:Real, F6&lt;:Real}"><code>Korg.Line</code></a>s (see <a href="../API/#Korg.read_linelist"><code>Korg.read_linelist</code></a>).  The lines must be sorted by wavelength.</li><li><code>A_X</code>: a vector containing the A(X) abundances (log(n<em>X/n</em>H) + 12) for elements from hydrogen to uranium (see <a href="../API/#Korg.format_A_X"><code>Korg.format_A_X</code></a>). All syntheses are done with these abundances, so if the resulting abundances deviate significantly from these, you may wish to iterate.</li><li><code>measured_EWs</code>: a vector of equivalent widths (in mÅ)</li></ul><p><strong>Returns</strong></p><p>A vector of abundances (<code>A(X) = log10(n_X/n_H) + 12</code> format) for each line in <code>linelist</code>.</p><p><strong>Optional arguments:</strong></p><ul><li><code>wl_step</code> (default: 0.01) is the resolution in Å at which to synthesize the spectrum around each line.</li><li><code>ew_window_size</code> (default: 2): the farthest (in Å) to consider equivalent width contributions for each line.  It&#39;s very important that this is large enough to include each line entirely.</li><li><code>blend_warn_threshold</code> (default: 0.01) is the minimum absorption between two lines allowed before triggering a warning that they may be blended. All other keyword arguments are passed to <a href="../API/#Korg.synthesize"><code>Korg.synthesize</code></a> when synthesizing each line.</li><li><code>finite_difference_delta_A</code> (default: 0.01): the step size in A(X) to use for the finite difference calculation of the curve of growth slope.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/Fit/fit_via_EWs.jl#L83-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Fit.ews_to_abundances_approx-NTuple{4, Any}" href="#Korg.Fit.ews_to_abundances_approx-NTuple{4, Any}"><code>Korg.Fit.ews_to_abundances_approx</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ews_to_abundances_approx(atm, linelist, A_X, measured_EWs; kwargs...)</code></pre><p>A very approximate method for fitting abundances from equivalent widths.  It assumes that all lines are on the linear part of the curve of growth, and that the lines are not blended. Arguments and keyword arguments are the same as for <a href="../API/#Korg.Fit.ews_to_abundances"><code>ews_to_abundances</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/Fit/fit_via_EWs.jl#L168-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Fit.ews_to_stellar_parameters" href="#Korg.Fit.ews_to_stellar_parameters"><code>Korg.Fit.ews_to_stellar_parameters</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ews_to_stellar_parameters(linelist, measured_EWs, [measured_EW_err]; kwargs...)</code></pre><p>Find stellar parameters from equivalent widths the &quot;old fashioned&quot; way.  This function finds the values of <span>$T_\mathrm{eff}$</span>, <span>$\log g$</span>, <span>$v_{mic}$</span>, and [m/H] which satisfy the following conditions (using a Newton-Raphson solver):</p><ul><li>The slope of the abundances of neutral lines with respect to lower excitation potential is zero.</li><li>The difference between the mean abundances of neutral and ionized lines is zero.</li><li>The slope of the abundances of neutral lines with respect to reduced equivalent width is zero.</li><li>The difference between the mean abundances of all lines and the model-atmosphere input [m/H] is zero. Here the &quot;slope&quot; refers to the slope of a linear fit to the abundances of the lines in question.</li></ul><p><strong>Arguments:</strong></p><ul><li><code>linelist</code>: A vector of <a href="#Korg.Line-Union{Tuple{F6}, Tuple{F5}, Tuple{F4}, Tuple{F3}, Tuple{F2}, Tuple{F1}, Tuple{F1, F2, Korg.Species, F3}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}}, Tuple{F1, F2, Korg.Species, F3, Union{Missing, F4}, Union{Missing, F5}, Union{Missing, Tuple{F6, F6}, F6}}} where {F1&lt;:Real, F2&lt;:Real, F3&lt;:Real, F4&lt;:Real, F5&lt;:Real, F6&lt;:Real}"><code>Korg.Line</code></a> objects (see <a href="../API/#Korg.read_linelist"><code>Korg.read_linelist</code></a>).  The lines must be sorted by wavelength.</li><li><code>measured_EWs</code>: a vector of equivalent widths (in mÅ).</li><li><code>measured_EW_err</code> (optional): the uncertainty in <code>measured_EWs</code>.  If not specified, all lines are assumed to have the same uncertainty. These uncertainties are used when evaluating the equations above, and are propagated to provide uncertainties in the resulting parameters.</li></ul><p><strong>Returns:</strong></p><p>A tuple containing:</p><ul><li>the best-fit parameters: <code>[Teff, logg, vmic, [m/H]]</code> as a vector (with vmic in km/s)</li><li>the statistical uncertainties in the parameters, propagated from the uncertainties in the equivalent widths. This is zero when EW uncertainties are not specified.</li><li>the systematic uncertainties in the parameters, estimated from the scatter the abundances computed from each line not accounted for by the EW uncertainties.</li></ul><div class="admonition is-info" id="Info-a27382d494986687"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-a27382d494986687" title="Permalink"></a></header><div class="admonition-body"><p>For now, this function is limited to the parameters supported by the SDSS MARCS grid, i.e. down to [m/H] = -2.5 at the lowest metallicity grid point.</p></div></div><p><strong>Keyword arguments:</strong></p><ul><li><p><code>Teff0</code> (default: 5000.0) is the starting guess for Teff</p></li><li><p><code>logg0</code> (default: 3.5) is the starting guess for logg</p></li><li><p><code>vmic0</code> (default: 1.0) is the starting guess for vmic. Note that this must be nonzero in order to avoid null derivatives. Very small values are fine.</p></li><li><p><code>m_H0</code> (default: 0.0) is the starting guess for [m/H]</p></li><li><p><code>tolerances</code> (default: <code>[1e-3, 1e-3, 1e-4, 1e-3]</code>) is the tolerance for the residuals each equation listed above. The solver stops when all residuals are less than the corresponding tolerance.</p></li><li><p><code>max_step_sizes</code> (default: <code>[1000.0, 1.0, 0.3, 0.5]</code>) is the maximum step size to take in each parameter direction.  This is used to prevent the solver from taking too large of a step and missing the solution.  Be particularly cautious with the vmic (third) parameter, as the unadjusted step size is often too large.</p></li><li><p><code>parameter_ranges</code> (default: <code>[(2800.0, 8000.0), (-0.5, 5.5), (1e-3, 10.0), (-2.5, 1.0)]</code>) is the allowed range for each parameter. This is used to prevent the solver from wandering into unphysical parameter space, or outside the range of the SDSS MARCS grid supported by <a href="../API/#Korg.interpolate_marcs"><code>Korg.interpolate_marcs</code></a>. The default ranges for <span>$T_\mathrm{eff}$</span>, <span>$\log g$</span>, and [m/H] are the widest supported by the MARCS grid. The minimum value for <code>vmic</code> is set to 1e-3 km/s to avoid null derivatives in the optimization.</p></li><li><p><code>fix_params</code> (default: <code>[false, false, false, false]</code>) is a vector of booleans indicating which parameters should be held fixed during the optimization. The order is [Teff, logg, vmic, [m/H]].</p></li><li><p><code>callback</code>: is a function which is called at each step of the optimization. It is passed three arguments:</p><ul><li>the current values of the parameters [Teff, logg, vmic, [m/H]]</li><li>the residuals of each equation being solved</li><li>the abundances of each line computed with the current parameters You can pass a callback function, to e.g. make a plot of the residuals at each step.</li></ul></li><li><p><code>max_iterations</code> (default: 30) is the maximum number of iterations to allow before stopping the optimization.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/Fit/fit_via_EWs.jl#L201-L269">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Fit.fit_spectrum" href="#Korg.Fit.fit_spectrum"><code>Korg.Fit.fit_spectrum</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_spectrum(obs_wls, obs_flux, obs_err, linelist, initial_guesses, fixed_params; kwargs...)</code></pre><p>Find the parameters and abundances that best match a rectified observed spectrum.</p><p><strong>Arguments:</strong></p><ul><li><code>obs_wls</code>: the wavelengths of the observed spectrum in Å.  These must be vacuum wavelengths.</li><li><code>obs_flux</code>: the rectified flux of the observed spectrum</li><li><code>obs_err</code>: uncertainty in <code>flux</code></li><li><code>linelist</code>: a linelist to use for the synthesis</li><li><code>initial_guesses</code>: a NamedTuple specifying initial guesses for the parameters to be fit.  See &quot;Specifying parameters&quot; below.</li><li><code>fixed_params</code>: a NamedTuple specifying parameters to be held fixed. See &quot;Specifying parameters&quot; below.</li></ul><p><code>initial_guesses</code> and <code>fixed_params</code> can also be specified as Dicts instead of NamedTuples, which is more convenient when calling Korg from python.</p><p><strong>Specifying parameters</strong></p><p>Parameters are specified as named tuples or dictionaries. Named tuples look like this: <code>(Teff=5000, logg=4.5, m_H=0.0)</code>.  Single-element named tuples require a semicolon: <code>(; Teff=5000)</code>.</p><p><strong>Required parameters</strong></p><p><code>Teff</code> and <code>logg</code> <em>must</em> be specified in either <code>initial_guesses</code> or <code>fixed_params</code>.</p><p><strong>Optional Parameters</strong></p><p>These can be specified in either <code>initial_guesses</code> or <code>fixed_params</code>, but if they are not default values are used.</p><ul><li><code>m_H</code>: the metallicity of the star, in dex. Default: <code>0.0</code></li><li><code>alpha_H</code>: the alpha enhancement of the star, in dex. Default: <code>m_H</code>.  Note that, because of the parameter range supported by <a href="../API/#Korg.interpolate_marcs"><code>Korg.interpolate_marcs</code></a>, only values within ±1 of <code>m_H</code> are supported.</li><li><code>vmic</code>: the microturbulence velocity, in km/s. Default: <code>1.0</code></li><li><code>vsini</code>: the projected rotational velocity of the star, in km/s. Default: <code>0.0</code>. See <a href="#Korg.apply_rotation"><code>Korg.apply_rotation</code></a> for details.</li><li><code>epsilon</code>: the linear limb-darkening coefficient. Default: <code>0.6</code>. Used for applying rotational broadening only.  See <a href="#Korg.apply_rotation"><code>Korg.apply_rotation</code></a> for details.</li><li>Individual elements, e.g. <code>Na</code>, specify the solar-relative ([X/H]) abundance of that element.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>R</code>, the resolution of the observed spectrum. This is required.  It can be specified as a function of wavelength, in which case it will be evaluated at the observed wavelengths.</li><li><code>windows</code> is a vector of wavelength pairs, each of which specifies a wavelength &quot;window&quot; to synthesize and contribute to the total χ². If not specified, the entire spectrum is used. Overlapping windows are automatically merged.</li><li><code>adjust_continuum</code> (default: <code>false</code>) if true, adjust the continuum with the best-fit linear correction within each window, minimizing the chi-squared between data and model at every step of the optimization.</li><li><code>wl_buffer</code> is the number of Å to add to each side of the synthesis range for each window.</li><li><code>time_limit</code> is the maximum number of seconds to spend in the optimizer. (default: <code>10_000</code>). The optimizer will only checks against the time limit after each step, so the actual wall time may exceed this limit.</li><li><code>precision</code> specifies the tolerance for the solver to accept a solution. The solver operates on transformed parameters, so <code>precision</code> doesn&#39;t translate straightforwardly to Teff, logg, etc, but the default value, <code>1e-4</code>, provides a theoretical worst-case tolerance of about 0.15 K in <code>Teff</code>, 0.0002 in <code>logg</code>, 0.0001 in <code>m_H</code>, and 0.0004 in detailed abundances. In practice the precision achieved by the optimizer is about 10x bigger than this.</li><li><code>postprocess</code> can be used to arbitrarilly transform the synthesized (and LSF-convolved) spectrum before calculating the chi2.  It should take the form <code>postprocess(flux, data, err)</code> and write its changes in-place to the flux array.</li><li><code>LSF_matrix</code>: this can be provedided along with <code>synthesis_wls</code> in place of specifying <code>R</code> if you have a precomputed custom LSF matrix.</li><li><code>synthesis_wls</code>: see <code>LSF_matrix</code> above. This can be a Korg.Wavelengths object or any arguments that can be passed to its constructor, e.g. a range or vector of ranges. Wavelengths are in Å.</li><li>Any additional keyword arguments will be passed to <a href="../API/#Korg.synthesize"><code>Korg.synthesize</code></a> when synthesizing the spectra for the fit.</li></ul><p><strong>Returns</strong></p><p>A NamedTuple with the following fields:</p><ul><li><code>best_fit_params</code>: the best-fit parameters</li><li><code>best_fit_flux</code>: the best-fit flux, with LSF applied, resampled, and rectified.</li><li><code>obs_wl_mask</code>: a bitmask for <code>obs_wls</code> which selects the wavelengths used in the fit (i.e. those in the <code>windows</code>)</li><li><code>solver_result</code>: the result object from <code>Optim.jl</code></li><li><code>trace</code>: a vector of NamedTuples, each of which contains the parameters at each step of the optimization. This is empty for single parameter fits, because the underlying solver doesn&#39;t supply it.</li><li><code>covariance</code>: a pair <code>(params, Σ)</code> where <code>params</code> is vector of parameter name (providing an order), and <code>Σ</code> is an estimate of the covariance matrix of the parameters.  It is the approximate inverse hessian of the log likelihood at the best-fit parameter calculated by the BGFS algorithm, and should be interpreted with caution.</li></ul><div class="admonition is-success" id="Tip-7447347818bd4ff3"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-7447347818bd4ff3" title="Permalink"></a></header><div class="admonition-body"><p>This function takes a long time to compile the first time it is called. Compilation performance is significantly better on Julia 1.10+ than previous versions, so if you are using an older version of Julia, you may want to upgrade.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/Fit/fit_via_synthesis.jl#L214-L309">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Fit.linear_continuum_adjustment!-NTuple{5, Any}" href="#Korg.Fit.linear_continuum_adjustment!-NTuple{5, Any}"><code>Korg.Fit.linear_continuum_adjustment!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linear_continuum_adjustment!(obs_wls, windows, model_flux, obs_flux, obs_err)</code></pre><p>Adjust the model flux to match the observed flux by fitting a line (as a function of wavelength) to the residuals, and dividing it out. This can compensate for poorly done continuum normalization.</p><p>Note, obs_wls must be masked.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/Fit/fit_via_synthesis.jl#L387-L394">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Fit.postprocessed_synthetic_spectrum-NTuple{11, Any}" href="#Korg.Fit.postprocessed_synthetic_spectrum-NTuple{11, Any}"><code>Korg.Fit.postprocessed_synthetic_spectrum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Synthesize a spectrum, apply the LSF, and postprocess it, catching and potentially rethrowing errors. This is used by <a href="../API/#Korg.Fit.fit_spectrum"><code>fit_spectrum</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/Fit/fit_via_synthesis.jl#L86-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Fit.scale-Tuple{Dict}" href="#Korg.Fit.scale-Tuple{Dict}"><code>Korg.Fit.scale</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Rescale each parameter so that it lives on (-∞, ∞).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/Fit/fit_via_synthesis.jl#L30-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Fit.synthetic_spectrum-NTuple{5, Any}" href="#Korg.Fit.synthetic_spectrum-NTuple{5, Any}"><code>Korg.Fit.synthetic_spectrum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Synthesize a spectrum, returning the flux, with LSF applied, resampled, and rectified.  This is an internal function oned by fitting routines. See <a href="../API/#Korg.synthesize"><code>Korg.synthesize</code></a> to synthesize spectra as a Korg user.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/Fit/fit_via_synthesis.jl#L58-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Fit.unscale-Tuple{Dict}" href="#Korg.Fit.unscale-Tuple{Dict}"><code>Korg.Fit.unscale</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Unscale each parameter so that it lives on the appropriate range instead of (-∞, ∞).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/Fit/fit_via_synthesis.jl#L43-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.Fit.validate_params-Tuple{AbstractDict, AbstractDict}" href="#Korg.Fit.validate_params-Tuple{AbstractDict, AbstractDict}"><code>Korg.Fit.validate_params</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Validate fitting parameters, and insert default values when needed. Used by <a href="../API/#Korg.Fit.fit_spectrum"><code>fit_spectrum</code></a>.</p><p>these can be specified in either initial<em>guesses or fixed</em>params, but if they are not, these values are inserted into fixed_params</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/Fit/fit_via_synthesis.jl#L129-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.CubicSplines.CubicSpline-Tuple{Any, Any}" href="#Korg.CubicSplines.CubicSpline-Tuple{Any, Any}"><code>Korg.CubicSplines.CubicSpline</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CubicSpline(xs, ys; extrapolate=false)</code></pre><p>Construct a interpolant using <code>xs</code> and <code>ys</code> as the knot coordinates. Assumes <code>xs</code> is sorted. Apply this object as a function to interpolate at any x value in the domain. If <code>extrapolate</code> is false, x values outside [<code>xs[1]</code>, <code>xs[end]</code>] throw errors, if <code>extrapolate</code> is true, the interpolant uses flat extrapolation, i.e. it returns the extreme value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/CubicSplines.jl#L44-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.CubicSplines.cumulative_integral!-Tuple{Any, Korg.CubicSplines.CubicSpline, Any, Any}" href="#Korg.CubicSplines.cumulative_integral!-Tuple{Any, Korg.CubicSplines.CubicSpline, Any, Any}"><code>Korg.CubicSplines.cumulative_integral!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cumulative_integral!(out, A, t1, t2)</code></pre><p>Given a curve described by the spine, A, Calculates the integral from t1 to t for all t = t1, t2, and all spline knots in between.  So if <code>t1</code> is <code>A.t[1]</code> and <code>t2</code> is <code>A.t[end]</code>, <code>out</code> should have the same length as <code>A.t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/CubicSplines.jl#L85-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.H2plus_bf_and_ff" href="#Korg.ContinuumAbsorption.H2plus_bf_and_ff"><code>Korg.ContinuumAbsorption.H2plus_bf_and_ff</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">H2plus_bf_and_ff(ν, T, nH_I_div_partition, n_HII; kwargs...)</code></pre><p>Compute the combined H₂⁺ bound-free and free-free linear absorption coefficient α using the tables from <a href="https://ui.adsabs.harvard.edu/abs/1994ApJ...430..360S/abstract">Stancil 1994</a>. Note that this refers to interactions between free-protons and neutral hydrogen, not electrons and doubly ionized H2, i.e. the b-f interaction is photodissociation, not photoionization.</p><p><strong>Arguments</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nH_I</code>: the total number density of H I divided by its partition function.</li><li><code>nH_II</code>: the number density of H II (not of H₂⁺).</li></ul><p>For a description of the kwargs, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</p><p><strong>Notes</strong></p><p>This computes the H₂⁺ number density from those of H I and H II, since ionized molecules are not included in the molecular equlibrium calculation.  Stancil provides approximate equilibrium constants, K, for the molecule, but the Barklem and Collet values used elsewhere by Korg may be more reliable.  Once ionized molecules are fully supported, those values should be used instead. While cross sections are tabulated down to only 3150 K, the cross sections could be linearly interpolated 1000 K or so lower, if reliable K values are availble.</p><p>Because n(H₂⁺) is computed on the fly, the &quot;cross-sections&quot; used (internally) by this function have units of cm^-5, since they must be multiplied by n(H I) and n(H II) to obtain absorption coefficients.</p><p>Stancil, <a href="https://ui.adsabs.harvard.edu/abs/1952MNRAS.112...40B/abstract">Bates (1952)</a>, and Gray (2005) all use n(H I), but Kurucz (1970) notes in section 5.2 that the photodisociation of H₂⁺ produces a ground state H atom and that we should therefore use n(H I, n=1) instead. This difference causes a descrepancy of a fraction of a percent (at most) for T ≤ 1.2e4 K. Here we use n(H I).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/absorption_H.jl#L370-L404">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.H_I_bf-NTuple{6, Any}" href="#Korg.ContinuumAbsorption.H_I_bf-NTuple{6, Any}"><code>Korg.ContinuumAbsorption.H_I_bf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">H_I_bf(νs, T, nH, nHe, ne, invU_H; n_max_MHD=6, use_hubeny_generalization=false, 
       taper=false, use_MHD_for_Lyman=false)</code></pre><p>The bound-free linear absorption coefficient contributed by all energy states of a neutral Hydrogen atom. Even though the Mihalas-Hummer-Daeppen (MHD) occupation probability formalism is not used in Korg when computing the hydrogen partition function, it is used here. That means that series limit jumps (e.g. the Balmer jump), are &quot;rounded off&quot;, as photons with less than the &quot;classical&quot; ionization energy can ionize if the upper level is dissolved into the continuum.</p><p><strong>Required Arguments</strong></p><ul><li><code>νs</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nH_I</code>: the total number density of neutral Hydrogen (in cm⁻³)</li><li><code>nHe_I</code>: the total number density of neutral Helium (in cm⁻³)</li><li><code>ne</code>: the number density of electrons (in cm⁻³)</li><li><code>invU_H</code>: The inverse of the neutral hydrogen partition function (neglecting contributions from the MHD formalism)</li></ul><p>For n=1 through n=<code>n_max_MHD</code> (default: 6), the cross-sections are computed using <a href="https://ui.adsabs.harvard.edu/abs/2021Atoms...9...73N/abstract">Nahar 2021</a>. These are modified using the MHD formalism to account for level dissolution. For larger n, the cross-sections are calculated with a simple analytic formula (see <a href="#Korg.ContinuumAbsorption.simple_hydrogen_bf_cross_section-Tuple{Integer, Real}"><code>simple_hydrogen_bf_cross_section</code></a>).</p><p>Because MHD level dissolution applied to the the Lyman series limit leads to inflated cross-sections in the visible, we don&#39;t use MHD for bf absorption from n=1.  This can be overridden by setting <code>use_MHD_for_Lyman=true</code>, in which case you will also want to set <code>taper=true</code>, which the same tapering of the cross-section as <a href="https://github.com/barklem/hlinop/blob/master/hbop.f">HBOP</a> to fix the problem.</p><p>The <code>use_hubeny_generalization</code> keyword argument enables the generalization of the MHD from Hubeny 1994. It is experimental and switched off by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/absorption_H.jl#L21-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.Heminus_ff" href="#Korg.ContinuumAbsorption.Heminus_ff"><code>Korg.ContinuumAbsorption.Heminus_ff</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Heminus_ff(ν, T, nHe_I_div_partition, ne; kwargs...)</code></pre><p>Compute the He⁻ free-free opacity κ.</p><p>The naming scheme for free-free absorption is counter-inutitive. This actually refers to the reaction:  <code>photon + e⁻ + He I -&gt; e⁻ + He I.</code></p><p><strong>Arguments</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nHe_I_div_partition</code>: the total number density of H I divided by its partition function.</li><li><code>ne</code>: the number density of free electrons.</li></ul><p>For a description of the kwargs, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</p><p><strong>Notes</strong></p><p>This uses the tabulated values from <a href="https://ui.adsabs.harvard.edu/abs/1994MNRAS.269..871J/abstract">John (1994)</a>.  The quantity K is the same used by <a href="https://doi.org/10.1088/0022-3700/20/4/019">Bell and Berrington (1987)</a>.  See <a href="#Korg.ContinuumAbsorption.Hminus_ff"><code>Hminus_ff</code></a> for an explanation.</p><p>According to John (1994), improved calculations are unlikely to alter the tabulated data for λ &gt; 1e4Å, &quot;by more than about 2%.&quot; The errors introduced by the approximations for 5.06e3 Å ≤ λ ≤ 1e4 Å &quot;are expected to be well below 10%.&quot;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/absorption_He.jl#L65-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.Hminus_bf" href="#Korg.ContinuumAbsorption.Hminus_bf"><code>Korg.ContinuumAbsorption.Hminus_bf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Hminus_bf(ν, T, nH_I_div_partition, ne; kwargs...)</code></pre><p>Compute the H⁻ bound-free linear absorption coefficient α, <span>$\alpha_\nu = \sigma_{bf}(H^-) n(H⁻) (1 - \exp \left( \frac{-h\nu}{k T}\right))$</span></p><p><strong>Arguments</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nH_I_div_partition</code>: the total number density of H I divided by its partition function.</li><li><code>ne</code>: the electron number density</li></ul><p>This uses cross-sections from <a href="https://ui.adsabs.harvard.edu/abs/2017JPhB...50k4001M/abstract">McLaughlin 2017</a>. For a description of the kwargs, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</p><p><strong>Notes</strong></p><p>This function assumes that n(H⁻) ≪ n(H I) + n(H II). The number density of n(H⁻) isn&#39;t precomputed as part of Korg&#39;s molecular equlibrium, it&#39;s computed here instead.</p><div class="admonition is-info" id="Note-62252fe65a6357f5"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-62252fe65a6357f5" title="Permalink"></a></header><div class="admonition-body"><p>The McLaughlin tabulated values (downloaded as a text file) contained a stray line out of monotonic order.  A version of the data file with the line deleted is saved at <code>data/McLaughlin2017Hminusbf.dat</code> for archival purposes.  (Korg doesn&#39;t read this file, it reads <code>data/McLaughlin2017Hminusbf.h5</code>.)</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/absorption_H.jl#L232-L260">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.Hminus_ff" href="#Korg.ContinuumAbsorption.Hminus_ff"><code>Korg.ContinuumAbsorption.Hminus_ff</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Hminus_ff(ν, T, nH_I_div_partition, ne; kwargs...)</code></pre><p>Compute the H⁻ free-free linear absorption coefficient α</p><p>The naming scheme for free-free absorption is counter-inutitive. This actually refers to the reaction:  photon + e⁻ + H I -&gt; e⁻ + H I.</p><p><strong>Arguments</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nH_I_div_partition::Flt</code>: the total number density of H I divided by its partition function.</li><li><code>ne</code>: the number density of free electrons.</li></ul><p>For a description of the kwargs, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</p><p><strong>Notes</strong></p><p>This is based on Table 1, in <a href="https://doi.org/10.1088/0022-3700/20/4/019">Bell &amp; Berrington (1987)</a>, which tabulates values for &quot;the H⁻ absorption coefficient&quot;, K (including the correction for stimulated emission). This quantity is in units of cm^4/dyn, and must be multiplied by the electron partial pressure and the ground-state neutral hydrogen number density to obtain a linear absorption coefficent, α.</p><p>The stipulation that the hydrogen should be ground-state only is based on the beginning of Section 2 in Bell and Berrington (1987), or alternately, Section 5.3 from Kurucz (1970).  When Gray (2005) refers to this, it implicitly assumes that <code>n(H I, n = 1) ≈ n(H I)</code>.  Note that</p><pre><code class="nohighlight hljs"> n(H I, n = 1) = n(H I)*gₙ₌₁/U(T)*exp(-Eₙ₌₁/(k*T)) = n(H I) * 2/U(T)*exp(0) = n(H I) * 2/U(T).</code></pre><p>Since U(T) ≈ 2 up to fairly large temperatures, this is not unreasonable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/absorption_H.jl#L318-L352">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption._load_gauntff_table" href="#Korg.ContinuumAbsorption._load_gauntff_table"><code>Korg.ContinuumAbsorption._load_gauntff_table</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_load_gauntff_table([fname])</code></pre><p>Returns a table of thermally-averaged free-free Gaunt factors, and the values of log₁₀(γ²) and log₁₀(u) associated with each point.</p><p>This loads the non-relativistic free-free data published by <a href="https://ui.adsabs.harvard.edu/abs/2014MNRAS.444..420V/abstract">van Hoof et al. (2014)</a>.</p><p>Note: This function code could trivially be adapted to load the relativistic free-free gaunt factors published by <a href="https://ui.adsabs.harvard.edu/abs/2015MNRAS.449.2112V/abstract">van Hoof et al (2015)</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/hydrogenic_bf_ff.jl#L3-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption._ndens_Hminus" href="#Korg.ContinuumAbsorption._ndens_Hminus"><code>Korg.ContinuumAbsorption._ndens_Hminus</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_ndens_Hminus(nH_I_div_partition, ne, T, ion_energy = _H⁻_ion_energy)</code></pre><p>Compute the number density of H⁻ (implements eqn 5.10 of Kurucz 1970). This is an application of the saha equation where the &quot;ground state&quot; is H⁻ and the &quot;first ionization state&quot; is H I. The partition function of H⁻ is 1 at all temperatures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/absorption_H.jl#L176-L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.bounds_checked_absorption-Tuple{Any}" href="#Korg.ContinuumAbsorption.bounds_checked_absorption-Tuple{Any}"><code>Korg.ContinuumAbsorption.bounds_checked_absorption</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bounds_checked_absorption(func; ν_bound, temp_bound)</code></pre><p>Constructs a wrapped function that implements bounds checking and extrapolation</p><p><strong>Parameters</strong></p><ul><li><code>func</code>: a function that has a signature <code>f(ν::Real, T::Real, args...)::Real</code>, where <code>ν</code> is frequency (in Hz) and <code>T</code> is temperature (in K)</li><li><code>ν_bound::Interval</code>: Interval of frequencies (in Hz) over which <code>func</code> is valid.</li><li><code>temp_bound::Interval</code>: Interval of temperatures (in K) over which <code>func</code> is valid.</li></ul><p>The resulting function will have this signature:</p><pre><code class="nohighlight hljs">wrapped_func(ν::AbstractVector{&lt;:Real}, T::Real, args...; kwargs...)</code></pre><p><strong>Wrapped Function Parameters</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted vector of frequencies (in Hz)</li><li><code>T::Real</code>: temperature (in K)</li><li><code>args...</code>: function-specific arguments</li></ul><p>For a description for the <code>kwargs...</code>, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.    # if generating the inner function in this way involves too much overhead, we could:</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/bounds_checking.jl#L17-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.electron_scattering-Tuple{F} where F&lt;:Real" href="#Korg.ContinuumAbsorption.electron_scattering-Tuple{F} where F&lt;:Real"><code>Korg.ContinuumAbsorption.electron_scattering</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">electron_scattering(nₑ)</code></pre><p>Compute the linear absorption coefficient, α, from scattering off of free electrons. This has no wavelength dependence. It assumes isotropic scattering.  (See, e.g. Gray p 160.)</p><p><strong>Arguments</strong></p><ul><li><code>nₑ::F</code>: number density of free electrons (in cgs)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/scattering.jl#L44-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.gaunt_ff_vanHoof-Tuple{Any, Any}" href="#Korg.ContinuumAbsorption.gaunt_ff_vanHoof-Tuple{Any, Any}"><code>Korg.ContinuumAbsorption.gaunt_ff_vanHoof</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gaunt_ff_vanHoof(log_u, log_γ2)</code></pre><p>computes the thermally averaged, non-relativistic free-free gaunt factor by interpolating the table provided by <a href="https://ui.adsabs.harvard.edu/abs/2014MNRAS.444..420V">van Hoof et al. (2014)</a>.</p><p><strong>Arguments</strong></p><ul><li><code>log_u</code>: Equal to log₁₀(u) = log₁₀(h<em>ν/(k</em>Tₑ))</li><li><code>log_γ2</code>: Equal to log₁₀(γ²) = log₁₀(Rydberg<em>Z²/(k</em>Tₑ))</li></ul><p><code>Rydberg</code> is the &quot;infinite mass unit of energy&quot; and <code>Tₑ</code> is the temperature of free electrons (for our purposes, we assume that free electrons are in thermal equilibrium with ions and neutral species).</p><p><strong>Notes</strong></p><p>van Hoof et al. (2014) computed the associated data table with a non-relativistic approach, which is invalid at very high temperatures. They conclude (from comparisons with a different paper) that their &quot;results should be accurate up to electron temperatures of roughly 100 MK&quot;. This is more than adequate for stellar atmospheres. In <a href="https://ui.adsabs.harvard.edu/abs/2015MNRAS.449.2112V">van Hoof et al. (2015)</a>, they find that relativistic effects introduce a ∼0.75% at 100MK, for Z = 1 (when Z &gt; 1, the change is smaller).</p><p>This function currently uses linear interpolation. However, van Hoof et al. (2014) provides an implementation of a third-order Lagrange scheme, which &quot;reaches a relative precision better than 1.5e-4 everywhere.&quot; The C and Fortran implementations of this scheme can be found <a href="http://data.nublado.org/gauntff/">here</a>, and are copyrighted by a BSD-style license.</p><p>Earlier variants of this function used less-accurate data from section 5.1 of Kurucz (1970) that extended over a smaller interval of data. That table was originally derived from a figure in Karsas and Latter (1961) and it&#39;s now used for testing purposes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/hydrogenic_bf_ff.jl#L81-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.hydrogenic_ff_absorption-Tuple{Real, Real, Integer, Real, Real}" href="#Korg.ContinuumAbsorption.hydrogenic_ff_absorption-Tuple{Real, Real, Integer, Real, Real}"><code>Korg.ContinuumAbsorption.hydrogenic_ff_absorption</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hydrogenic_ff_absorption(ν, T, Z, ni, ne)</code></pre><p>computes the free-free linear absorption coefficient for a hydrogenic species</p><p>The naming convention for free-free absorption is counter-intuitive. A free-free interaction is named as though the species interacting with the free electron had one more bound electron (in other words it&#39;s named as though the free-electron and ion were bound together). In practice, this means that <code>ni</code> should refer to:</p><ul><li>the number density of H II if computing the H I free-free absorption</li><li>the number density of He III if computing the He II free-free absorption</li><li>the number density of Li IV if computing the Li III free-free absorption</li></ul><p><strong>Arguments</strong></p><ul><li><code>Z::Integer</code>: the charge of the ion. For example, this is 1 for ionized H.</li><li><code>ni</code>: the number density of the ion species in cm⁻³.</li><li><code>ne</code>: the number density of free electrons.</li><li><code>ν</code>: frequency in Hz</li><li><code>T</code>: temperature in K</li></ul><p><strong>Note</strong></p><p>This approach was adopted from equation 5.8 from section 5.1 of Kurucz (1970). Comparison against equation 5.18b of Rybicki &amp; Lightman (2004), reveals that the equation in Kurucz (1970) omits the dependence on ρ. According to Rybicki &amp; Lightman (2004) the free-free absorption coefficient (corrected for stimulated emission) is:</p><pre><code class="nohighlight hljs">    α = coef * Z² * ne * ni * (1 - exp(-hplanck*ν/(kboltz*T))) * g_ff / (sqrt(T) * ν³)</code></pre><p>Note that the g_ff is the free-free gaunt factor and coef is ∼3.7e8 (a more exact coefficient can be computed from eqn 5.18a).</p><p>With this in mind, equation 5.8 of Kurucz (1970) should actually read</p><pre><code class="nohighlight hljs">    κ = ne * n(H II) * F_ν(T) * (1 - exp(-hplanck*ν/(kboltz*T))) / ρ</code></pre><p>where F<em>ν(T) = coef * Z² * g</em>ff / (sqrt(T) * ν³).</p><p>See <code>gaunt_ff_vanHoof</code> for details about where our gaunt factor data comes from. For simplicity, we enforce temperature and ν bounds constraints that don&#39;t include all of the available gaunt factor data. In practice, this should never be a concern for stellar spectroscopy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/hydrogenic_bf_ff.jl#L116-L163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.metal_bf_absorption!-NTuple{4, Any}" href="#Korg.ContinuumAbsorption.metal_bf_absorption!-NTuple{4, Any}"><code>Korg.ContinuumAbsorption.metal_bf_absorption!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">metal_bf_absorption!(α, νs, T, number_densities)</code></pre><p>Adds to α the contributions of bf metal opacities.  Uses precomputed tables from <a href="http://cdsweb.u-strasbg.fr/topbase/topbase.html">TOPBase</a> for Li, Be, B, C, N, O, F, Ne, Na, Mg, Al, Si, S, Ar, and Ca. Uses tables from <a href="https://www.astronomy.ohio-state.edu/nahar.1/nahar_radiativeatomicdata/index.html">NORAD</a> for Fe.  For these elements, tables have been precomputed for the neutral and singly ionized species assuming and LTE distribution of energy levels.  See <code>Korg/data/metal_bf_cross-sections/</code> for the scripts which generate the tables.</p><p>Cross sections were computed for 100 K &lt; T &lt; 100,000 K and frequencies corresponding to 500 Å &lt; λ &lt; 30,000 Å.  Outside of either of those ranges, flat extrapolation is used (i.e. the extreme value is returned).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/absorption_metals_bf.jl#L20-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.positive_ion_ff_absorption!-Tuple{AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}, Real, Dict, Real}" href="#Korg.ContinuumAbsorption.positive_ion_ff_absorption!-Tuple{AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}, Real, Dict, Real}"><code>Korg.ContinuumAbsorption.positive_ion_ff_absorption!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">positive_ion_ff_absorption!(α_out::Vector{Real}, ν::Real, T::Real, number_densities::Dict, 
                            ne::Real, departure_coefficients=Peach1970.departure_coefficients)</code></pre><p>Computes the linear absorption coefficient (in cm⁻¹) for all free-free interactions involving positively charged atomic species. Uses the provided departure coefficients when they are available, and the uncorrected hydrogenic approximation when they are not.</p><p><strong>Arguments</strong></p><ul><li><code>ν</code>: frequency in Hz</li><li><code>T</code>: temperature in K</li><li><code>number_densities</code> is a <code>Dict</code> mapping each <code>Species</code> to its number density.</li><li><code>ne</code>: the number density of free electrons.</li><li><code>departure_coefficients</code> (optional, defaults to <code>ContinuumAbsorption.Peach1970.departure_coefficients</code>: a dictionary mapping species to the departure coefficients for the ff process it participates in (e.g. <code>species&quot;C II&quot;</code> maps to the C III ff departure coefficients–see note below).  Departure coefficients should be callables taking temperature and (photon energy / RydbergH / Zeff^2).</li></ul><div class="admonition is-info" id="Note-76e73baaec19adce"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-76e73baaec19adce" title="Permalink"></a></header><div class="admonition-body"><p>A free-free interaction is named as though the species interacting with the free electron had one more bound electron (in other words it&#39;s named as though the free-electron and ion were bound together). To make matters more confusing, some sources present the free-free linear absorption coefficient&#39;s formula in terms of the number density of the species in the interaction&#39;s name (by including the Saha equation in the formula).</p><p>To compute the absorption for a given free-free interaction, this function accesses elements from the dictionary arguments that are associated with the species that participates in the interaction. For example:</p><ul><li>Si I ff absorption: uses the number density of Si II (<code>number_densities[species&quot;Si II&quot;]</code>) and checks <code>departure_coefficients[species&quot;Si II&quot;]</code> for departure coefficients.</li><li>Si II ff absorption: uses the number density of Si III (<code>number_densities[species&quot;Si III&quot;]</code>) and checks <code>departure_coefficients[species&quot;Si III&quot;]</code> for departure coefficients.</li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/absorption_ff_positive_ion.jl#L3-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.rayleigh-Tuple{AbstractVector{&lt;:Real}, Any, Any, Any}" href="#Korg.ContinuumAbsorption.rayleigh-Tuple{AbstractVector{&lt;:Real}, Any, Any, Any}"><code>Korg.ContinuumAbsorption.rayleigh</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rayleigh(λs, nH_I, nHe_II, nH2)</code></pre><p>Absorption coefficient from Rayleigh scattering by neutral H, He, and H2.  Formulations for H and He are via <a href="https://ui.adsabs.harvard.edu/abs/2016ApJ...817..116C/abstract">Colgan+ 2016</a>.  Formulation for H2 from <a href="https://ui.adsabs.harvard.edu/abs/1962ApJ...136..690D/abstract">Dalgarno and Williams 1962</a>.</p><p>The Dalgarno and Williams H2 is applicable redward of 1300 Å.  Since Rayleigh scattering breaks down when the particle size to wavelength ratio gets large, we that all frequencies passed to this function be equivalent to 1300 Å or greater.</p><p>The formulations for H is adapted from <a href="https://ui.adsabs.harvard.edu/abs/1962ApJ...136..690D/abstract">Lee 2005</a>, which states that it is applicable redward of Lyman alpha. See Colgan 2016 for details on He.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/scattering.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.simple_hydrogen_bf_cross_section-Tuple{Integer, Real}" href="#Korg.ContinuumAbsorption.simple_hydrogen_bf_cross_section-Tuple{Integer, Real}"><code>Korg.ContinuumAbsorption.simple_hydrogen_bf_cross_section</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simple_hydrogen_bf_cross_section(n::Integer, ν::Real)</code></pre><p>Calculate the H I bf cross section in megabarns using a very simple approximation.  See, for example, Kurucz 1970 equation 5.5 (though see note below).  This implementation is used to extrapolate the cross-section past the ionization energy of an unperturbed hydrogen atom, as is required to take level dissolution into account with the MHD formalism.</p><p>Equation 5.5 of Kurucz had a typo in it. In the numerator of the fraction that is multiplied by the entire polynomial, Z² should be Z⁴. This was discovered during comparisons with data from the Opacity Project, and can be confirmed by looking at eqn 5.6 of Kurucz (it uses Z⁴ instead of Z²) or by comparison against equation 10.54 of Rybicki &amp; Lightman.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/absorption_H.jl#L135-L147">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.total_continuum_absorption-Tuple{Any, Any, Any, Dict, Dict}" href="#Korg.ContinuumAbsorption.total_continuum_absorption-Tuple{Any, Any, Any, Dict, Dict}"><code>Korg.ContinuumAbsorption.total_continuum_absorption</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">total_continuum_absorption(νs, T, nₑ, number_densities, partition_funcs; error_oobounds)</code></pre><p>The total continuum linear absoprtion coefficient, α, at many frequencies, ν.</p><p><strong>Arguments</strong></p><ul><li><code>νs</code> are frequencies in Hz</li><li><code>T</code> is temperature in K</li><li><code>nₑ</code> is the electron number density in cm^-3</li><li><code>number_densities</code> is a <code>Dict</code> mapping each <code>Species</code> to its number density</li><li><code>partition_funcs</code> is a <code>Dict</code> mapping each <code>Species</code> to its partition function (e.g. <code>Korg.partition_funcs</code>)</li><li><code>error_oobounds::Bool</code> specifies the behavior of most continnum absorption sources when passed frequencies or temperature values that are out of bounds for their implementation. When <code>false</code> (the default), those absorption sources are ignored at those values. Otherwise, an error is thrown.</li></ul><div class="admonition is-info" id="Note-e6c45efbb7045fc6"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-e6c45efbb7045fc6" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency reasons, <code>νs</code> must be sorted. While this function technically supports any sorted <code>AbstractVector</code>, it is most effient when passed an  <code>AbstractRange</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/ContinuumAbsorption.jl#L16-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.Stancil1994" href="#Korg.ContinuumAbsorption.Stancil1994"><code>Korg.ContinuumAbsorption.Stancil1994</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This module contains transcriptions of the tables from <a href="https://ui.adsabs.harvard.edu/abs/1994ApJ...430..360S/abstract">Stancil 1994</a>, who calculated ff and bf absorption coefficients for H₂⁺ and He₂⁺.</p><p>It also contains pre-constructed interpolation objects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/Stancil1994.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.ContinuumAbsorption.Peach1970.departure_coefficients-Tuple{}" href="#Korg.ContinuumAbsorption.Peach1970.departure_coefficients-Tuple{}"><code>Korg.ContinuumAbsorption.Peach1970.departure_coefficients</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Peach1970.departure_coefficients()</code></pre><p>This module contains interpolators of the tabulated ff departure coeffients from <a href="https://ui.adsabs.harvard.edu/abs/1970MmRAS..73....1P/abstract">Peach+ 1970</a>, which we use to correct the hydrogenic ff absorption coefficient for H I ff, C I ff, Si I ff, and Mg I ff. It contains a dictionary (returned by <code>departure_coefficients()</code>), which maps <code>Species</code> to interpolator objects.  Crucially, the dictionary is indexed by the species which actually participates in the interaction, not the one after which the interaction is named.</p><p>Outside the regime in which Peach 1970 provides data, the interpolators return 0, falling back to the hydreogenic approximation.</p><p>The species for which we use corrections are the same species which get corrected in MARCS/Turbospectrum (see Table 1 of <a href="https://ui.adsabs.harvard.edu/abs/2008A%26A...486..951G/abstract">Gustafsson+ 2008</a>). The choices seem are largely motivated by which species have departure terms at normal stellar atmosphere conditions and which species are most abundant in the sun. For C II ff, we include only the contribution from the ¹S parent term, even though (in contrast to other speices) information is available for the ³Pᵒ term as well.</p><p>The free-free absorption coefficient (including stimulated emission) is given by:</p><p><span>$\alpha_{ m ff} = \alpha_{ m hydrogenic, ff}(\nu, T, n_i, n_e; Z) (1 + D(T, \sigma))$</span>,</p><p>where</p><ul><li><span>$\alpha_{ m hydrogenic, ff}(\nu, T, n_i, n_e; Z)$</span> should include the correction for stimulated emission.</li><li><span>$n_i$</span> is the number density fo the ion species that participates in the interation, not the species the interaction is named after.</li><li><span>$n_e$</span> is the number density of free electrons.</li><li><span>$D(T, \sigma)$</span> is specified as the <code>departure</code> arg, and is expected to interpolate over the tabulated values specified in Table III of Peach (1970).</li><li>σ denotes the energy of the photon in units of RydbergH*Zeff²</li></ul><p>It might not be immediately obvious how the above equation relates to the equations presented in Peach (1970). Peach describes the calculation for <span>$k_ u^F$</span>, the free-free absorption coefficient (uncorrected for stimulated emission) per particle of the species that the interaction is named after. In other words, he computes:</p><p><span>$k_ u^F = \alpha_{ m ff}/n_{i-1} \left(1 - e^\frac{-h\nu}{k T}\right)^{-1}$</span>,</p><p>where <span>$n_{i-1}$</span> is the number density of the species that the interaction is named after. <span>$k_ u^F$</span> can directly be computed, under LTE, from just <span>$u$</span>, <span>$T$</span>, and <span>$n_{i-1}$</span> (the Saha Equation relates <span>$\alpha_{ m ff}$</span>&#39;s dependence on <span>$n_e$</span> and <span>$n_i$</span> to <span>$n_{i-1}$</span> and <span>$T$</span>.  Gray (2005) follows a similar convention when describing free-free absorption.</p><div class="admonition is-warning" id="Warning-5792800d629de09"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-5792800d629de09" title="Permalink"></a></header><div class="admonition-body"></div></div><p>The tabulated data in this module was taken from Peach 1970 using OCR software, and may contain mis-read values, although they produce reasonable behavior and there are no obvious problems.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/ContinuumAbsorption/Peach1970.jl#L276-L334">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RadiativeTransfer.calculate_rays-Tuple{Any, Any, Any}" href="#Korg.RadiativeTransfer.calculate_rays-Tuple{Any, Any, Any}"><code>Korg.RadiativeTransfer.calculate_rays</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_rays(μ_surface_grid, spatial_coord, spherical)</code></pre><p><strong>Arguments</strong></p><ul><li><code>μ_surface_grid</code>: the μ values at the surface of the star corresponding to the rays along which the optical depth and intensity will be calculated.</li><li><code>spatial_coord</code>: a physical distance coordinate.  This is radius for a spherical atmosphere, and height above the photosphere for a plane-parallel atmosphere.</li></ul><p><strong>Returns</strong></p><p>A vector of pairs <code>(s, ds/dz)</code>, where <code>s</code> is the distance along the ray and z is the model atmosphere spatial coordinate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/RadiativeTransfer/RadiativeTransfer.jl#L199-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RadiativeTransfer.compute_F_flux_only_expint-Tuple{Any, Any}" href="#Korg.RadiativeTransfer.compute_F_flux_only_expint-Tuple{Any, Any}"><code>Korg.RadiativeTransfer.compute_F_flux_only_expint</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_F_flux_only_expint(τ, S)</code></pre><p>Compute the astrophysical flux, F, by linearly interpolating the source function, <code>S</code> across optical depths <code>τ</code>.  Handle the integral over μ analytically using E₂.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/RadiativeTransfer/RadiativeTransfer.jl#L369-L374">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RadiativeTransfer.compute_I_bezier!-Tuple{Any, Any, Any}" href="#Korg.RadiativeTransfer.compute_I_bezier!-Tuple{Any, Any, Any}"><code>Korg.RadiativeTransfer.compute_I_bezier!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_I_bezier!(I, τ, S)</code></pre><p>Given τ and S along a ray (at a particular wavelength), compute the intensity at the end of the ray (the surface of the star).  This uses the method from <a href="https://ui.adsabs.harvard.edu/abs/2013ApJ...764...33D/abstract">de la Cruz Rodríguez and Piskunov 2013</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/RadiativeTransfer/RadiativeTransfer.jl#L322-L328">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RadiativeTransfer.compute_I_linear!-Tuple{Any, Any, Any}" href="#Korg.RadiativeTransfer.compute_I_linear!-Tuple{Any, Any, Any}"><code>Korg.RadiativeTransfer.compute_I_linear!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_I_linear!(I, τ, S)</code></pre><p>Compute exactly the solution to the transfer integral obtained be linearly interpolating the source function, <code>S</code> across optical depths <code>τ</code>, without approximating the factor of exp(-τ).</p><p>This breaks the integral into the sum of integrals of the form <span>$\int (m\tau + b) \exp(-\tau)$</span> d\tau$ , which is equal to $ -\exp(-\tau) (m*\tau + b + m)$.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/RadiativeTransfer/RadiativeTransfer.jl#L271-L281">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RadiativeTransfer.compute_I_linear_flux_only-Tuple{Any, Any}" href="#Korg.RadiativeTransfer.compute_I_linear_flux_only-Tuple{Any, Any}"><code>Korg.RadiativeTransfer.compute_I_linear_flux_only</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_I_linear_flux_only(τ, S)</code></pre><p>Returns the intensity at the end of the ray (the surface of the star) given τ and S along the ray. Uses the same numerical method as <a href="#Korg.RadiativeTransfer.compute_I_linear!-Tuple{Any, Any, Any}"><code>compute_I_linear!</code></a>, but doesn&#39;t retain the intensity at each layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/RadiativeTransfer/RadiativeTransfer.jl#L296-L302">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RadiativeTransfer.compute_tau_bezier!-Tuple{Any, Any, Any}" href="#Korg.RadiativeTransfer.compute_tau_bezier!-Tuple{Any, Any, Any}"><code>Korg.RadiativeTransfer.compute_tau_bezier!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_tau_bezier(τ, s, α)</code></pre><p>Compute optical depth (write to τ) along a ray with coordinate s and absorption coefficient α.  This is the method proposed in <a href="https://ui.adsabs.harvard.edu/abs/2013ApJ...764...33D/abstract">de la Cruz Rodríguez and Piskunov 2013</a>, but the</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/RadiativeTransfer/RadiativeTransfer.jl#L251-L258">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RadiativeTransfer.expint_transfer_integral_core-Tuple{Any, Any, Any}" href="#Korg.RadiativeTransfer.expint_transfer_integral_core-Tuple{Any, Any, Any}"><code>Korg.RadiativeTransfer.expint_transfer_integral_core</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">expint_transfer_integral_core(τ, m, b)</code></pre><p>The exact solution to <span>$\int (m\tau + b) E_2(\tau)$</span> d\tau$. The exponential integral function, expint, captures the integral over the disk of the star to get the emergent astrophysical flux. You can verify it by substituting the variable of integration in the exponential integal, t, with mu=1/t.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/RadiativeTransfer/RadiativeTransfer.jl#L386-L393">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RadiativeTransfer.exponential_integral_2-Tuple{Any}" href="#Korg.RadiativeTransfer.exponential_integral_2-Tuple{Any}"><code>Korg.RadiativeTransfer.exponential_integral_2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exponential_integral_2(x)</code></pre><p>Approximate second order exponential integral, E_2(x).  This stitches together several series expansions to get an approximation which is accurate within 1% for all <code>x</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/RadiativeTransfer/RadiativeTransfer.jl#L398-L403">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RadiativeTransfer.fritsch_butland_C-Tuple{Any, Any}" href="#Korg.RadiativeTransfer.fritsch_butland_C-Tuple{Any, Any}"><code>Korg.RadiativeTransfer.fritsch_butland_C</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fritsch_butland_C(x, y)</code></pre><p>Given a set of x and y values, compute the bezier control points using the method of <a href="https://doi.org/10.1137/0905021">Fritch &amp; Butland 1984</a>, as suggested in <a href="https://ui.adsabs.harvard.edu/abs/2013ApJ...764...33D/abstract">de la Cruz Rodríguez and Piskunov 2013</a>.</p><p>Used in <a href="#Korg.RadiativeTransfer.compute_I_bezier!-Tuple{Any, Any, Any}"><code>compute_I_bezier!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/RadiativeTransfer/RadiativeTransfer.jl#L348-L356">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RadiativeTransfer.generate_mu_grid-Tuple{Integer}" href="#Korg.RadiativeTransfer.generate_mu_grid-Tuple{Integer}"><code>Korg.RadiativeTransfer.generate_mu_grid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_mu_grid(n_points)
generate_mu_grid(μ_values)</code></pre><p>Used by both radiative transfer schemes to compute quadrature over μ. Returns <code>(μ_grid, μ_weights)</code>. If an integer is passed, generate a grid of Gauss-Legendre quadrature points of corresponding size. Otherwise, use the provided μ values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/RadiativeTransfer/RadiativeTransfer.jl#L5-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RadiativeTransfer.radiative_transfer-Tuple{Korg.PlanarAtmosphere, Any, Any, Any}" href="#Korg.RadiativeTransfer.radiative_transfer-Tuple{Korg.PlanarAtmosphere, Any, Any, Any}"><code>Korg.RadiativeTransfer.radiative_transfer</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">radiative_transfer(atm, α, S, n_μ_points; kwargs...)
radiative_transfer(α, S, spatial_coord, n_μ_points, spherical; kwargs...)</code></pre><p><strong>Arguments (note that some of these are only required for one method):</strong></p><ul><li><code>atm</code>: the model atmosphere.</li><li><code>α</code>: a matrix (atmospheric layers × wavelengths) containing the absorption coefficient</li><li><code>S</code>: the source function as a matrix of the same shape. rescale the total absorption to match the model atmosphere. This value should be calculated by Korg.</li><li><code>μ_points</code>: the number of quadrature points to use when integrating over I_surface(μ) to obtain the astrophysical flux, or, alternatively, the specific μ values to use (in which case the integral is done with the trapezoid rule).</li><li><code>spatial_coord</code>: a physical distance coordinate (radius for a spherical atmosphere, height above the photosphere for a plane-parallel atmosphere).</li><li><code>spherical</code>: whether the atmosphere is spherical or plane-parallel.</li></ul><p><strong>Keyword Arguments:</strong></p><ul><li><code>include_inward_rays</code> (default: <code>false</code>): if true, light propagating into the star (negative μs) is included.  If false, only those which are needed to seed the intensity at the bottom of the atmosphere are included.</li><li><code>τ_scheme</code> (default: &quot;anchored&quot;): how to compute the optical depth.  Options are &quot;linear&quot; and &quot;bezier&quot; (not recommended).</li><li><code>I_scheme</code> (default: &quot;linear<em>flux</em>only&quot;): how to compute the intensity.  Options are &quot;linear&quot;, &quot;linear<em>flux</em>only&quot;, and &quot;bezier&quot;.  &quot;linear<em>flux</em>only&quot; is the fastest, but does not return the intensity values anywhere except at the top of the atmosphere.  &quot;linear&quot; performs an equivalent calculation, but stores the intensity at every layer.  &quot;bezier&quot; is not recommended.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/RadiativeTransfer/RadiativeTransfer.jl#L28-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Korg.RadiativeTransfer.radiative_transfer_core-NTuple{15, Any}" href="#Korg.RadiativeTransfer.radiative_transfer_core-NTuple{15, Any}"><code>Korg.RadiativeTransfer.radiative_transfer_core</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute the intensity along a single ray.</p><p>n.b. this function has an additional I<em>scheme (&quot;linear</em>flux<em>only</em>expint&quot;) that radiative_transfer will automatically switch to when appropriate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/c7ad45834a8bab433e457f22106ca5b8ba88f05e/src/RadiativeTransfer/RadiativeTransfer.jl#L137-L142">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../changelog/">« Changelog</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.3 on <span class="colophon-date" title="Thursday 15 May 2025 15:12">Thursday 15 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
