<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Function Reference · Korg</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Korg logo"/></a><div class="docs-package-name"><span class="docs-autofit">Korg</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Quickstart</a></li><li class="is-active"><a class="tocitem" href>Function Reference</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Secondary-functions"><span>Secondary functions</span></a></li><li><a class="tocitem" href="#Postprocessing"><span>Postprocessing</span></a></li><li><a class="tocitem" href="#Line-absorption"><span>Line absorption</span></a></li><li><a class="tocitem" href="#Continuum-absorption"><span>Continuum absorption</span></a></li><li><a class="tocitem" href="#Statistical-mechanics"><span>Statistical mechanics</span></a></li><li><a class="tocitem" href="#Misc"><span>Misc</span></a></li></ul></li><li><a class="tocitem" href="../devdocs/">Developer Documentation</a></li><li><a class="tocitem" href="../install/">Install</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Function Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Function Reference</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ajwheeler/Korg.jl/blob/master/docs/src/API.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>This page docuements the Korg API for users of the package. Low-level functions that only people  digging into the guts of Korg will be interested in can be found on the  <a href="../devdocs">developer documentation</a>.</p><h1 id="Top-level-functions"><a class="docs-heading-anchor" href="#Top-level-functions">Top-level functions</a><a id="Top-level-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Top-level-functions" title="Permalink"></a></h1><p>If you are synthesize a spectrum Korg, these are the functions you will call.   These functions are exported, so if you do <code>using Korg</code>, you can call them unquallified (i.e. <code>synthesize</code> instead of <code>Korg.synthesize</code>).  </p><article class="docstring"><header><a class="docstring-binding" id="Korg.synthesize" href="#Korg.synthesize"><code>Korg.synthesize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">synthesize(atm, linelist, λ_start, λ_stop, [λ_step=0.01]; metallicity=0, abundances=Dict(), vmic=0, ... )</code></pre><p>Solve the transfer equation in the model atmosphere <code>atm</code> with the transitions in <code>linelist</code> at the  from <code>λ_start</code> to <code>λ_stop</code> in steps of <code>λ_step</code> (all Å) to get the resultant astrophysical flux at  each wavelength.  An <code>AbstractRange</code> can also be probvided directly in place of <code>λ_start</code>, <code>λ_stop</code>, and <code>λ_step</code>.</p><p>Returns a named tuple with keys:     - <code>flux</code>: the output spectrum     - <code>alpha</code>: the linear absorption coefficient at each wavelenth and atmospheric layer a Matrix of         size (layers x wavelengths)     - <code>number_densities</code>: A dictionary mapping <code>Species</code> to vectors of number densities at each         atmospheric layer     - <code>wavelengths</code>: The vacuum wavelenths (in Å) over which the synthesis was performed.  If        <code>air_wavelengths=true</code> this will not be the same as the input wavelenths.</p><p>Optional arguments:</p><ul><li><code>metallicity</code>, i.e. [metals/H] is log_10 solar relative</li><li><code>abundances</code> is a <code>Dict</code> mapping atomic symbols to <span>$A(X)$</span> format abundances, i.e.   <span>$A(x) = \log_{10}(n_X/n_\mathrm{H}) + 12$</span>, where <span>$n_X$</span> is the number density of <span>$X$</span>.  These override <code>metallicity</code>.</li><li><code>vmic</code> (default: 0) is the microturbulent velocity, <span>$\xi$</span>, in km/s.</li><li><code>air_wavelengths</code> (default: <code>false</code>): Whether or not the input wavelengths are air wavelenths to   be converted to vacuum wavelengths by Korg.  The conversion will not be exact, so that the   wavelenth range can internally be represented by an evenly-spaced range.  If the approximation   error is greater than <code>wavelength_conversion_warn_threshold</code>, an error will be thrown.</li><li><code>wavelength_conversion_warn_threshold</code> (default: 1e-4): see <code>air_wavelengths</code>.</li><li><code>line_buffer</code> (default: 10): the farthest (in Å) any line can be from the provided wavelenth range   before it is discarded.  If the edge of your window is near a strong line, you may have to turn   this up.</li><li><code>cntm_step</code> (default 1): the distance (in Å) between point at which the continuum opacity is  calculated.</li><li><code>hydrogen_lines</code> (default: <code>true</code>): whether or not to include H lines in the synthesis.</li><li><code>mu_grid</code>: the range of (surface) μ values at which to calculate the surface flux when doing   transfer in spherical geometry (when <code>atm</code> is a <code>ShellAtmosphere</code>).</li><li><code>line_cutoff_threshold</code> (default: <code>1e-3</code>): the fraction of the continuum absorption coefficient   at which line profiles are truncated.  This has major performance impacts, since line absorption  calculations dominate more syntheses.  Turn it down for more precision at the expense of runtime.  The default value should effect final spectra below the 10^-3 level.</li><li><code>ionization_energies</code>, a <code>Dict</code> mapping <code>Species</code> to their first three ionization energies,   defaults to <code>Korg.ionization_energies</code>.</li><li><code>partition_funcs</code>, a <code>Dict</code> mapping <code>Species</code> to partition functions. Defaults to data from   Barklem &amp; Collet 2016, <code>Korg.partition_funcs</code>.</li><li><code>equilibrium_constants</code>, a <code>Dict</code> mapping <code>Species</code> representing diatomic molecules to their   molecular equilbrium constants in partial pressure form.  Defaults to data from   Barklem and Collet 2016, <code>Korg.equilibrium_constants</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/synthesize.jl#L4-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.read_linelist" href="#Korg.read_linelist"><code>Korg.read_linelist</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">read_linelist(filename; format=&quot;vald&quot;, isotopic_abundances=Korg.isotopic_abundances)</code></pre><p>Parse a linelist file, returning a vector of <a href="#Korg.Line-Union{Tuple{F}, Tuple{F, F, Korg.Species, F}, Tuple{F, F, Korg.Species, F, Union{Missing, F}}, Tuple{F, F, Korg.Species, F, Union{Missing, F}, Union{Missing, F}}, Tuple{F, F, Korg.Species, F, Union{Missing, F}, Union{Missing, F}, Union{Missing, Tuple{F, F}, F}}} where F&lt;:Real"><code>Line</code></a>s.</p><p>Pass <code>format=&quot;kurucz&quot;</code> for a <a href="http://kurucz.harvard.edu/linelists.html">Kurucz linelist</a>  (<code>format=kurucz_vac</code> if it uses vacuum wavelengths; Be warned that Korg will not assume that  wavelengths are vacuum below 2000 Å),<code>format=&quot;vald&quot;</code> for a  <a href="http://vald.astro.uu.se/~vald/php/vald.php">VALD</a> linelist, and <code>format=&quot;moog&quot;</code> for a MOOG linelist (doesn&#39;t support broadening parameters or dissociation energies).  </p><p>VALD linelists (the default and preferred format) can be either &quot;short&quot; or &quot;long&quot; format,  &quot;extract all&quot; or &quot;extract stellar&quot;.  Air wavelengths will automatically be converted into vacuum wavelengths, and energy levels will be automatically converted from cm<span>$^{-1}$</span> to eV.</p><p>When they are not pre-scaled by isotopic abundace (which VALD does by default), Korg will  automatically adjust the log<em>gf of each line according to the `isotopic</em>abundances<code>, which defaults  to the values from [NIST](https://www.nist.gov/pml/atomic-weights-and-isotopic-compositions-relative-atomic-masses). To use custom isotopic abundances, just pass</code>isotopic_abundances<code>as a dictionary mapping</code>(atomic number, atomic weight)` pairs to abundances between 0 and 1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/linelist.jl#L289-L309">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.read_model_atmosphere" href="#Korg.read_model_atmosphere"><code>Korg.read_model_atmosphere</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">read_model_atmosphere(filename; truncate_at_10000K=true)</code></pre><p>Parse the provided model atmosphere file in  <a href="https://marcs.astro.uu.se/krz_format.html">&quot;Kurucz&quot; format</a>. Returns either a <code>PlanarAtmosphere</code> or a <code>ShellAtmosphere</code>.</p><p>When <code>truncate_at_10000K</code> is true, layers with temperatures greater than 10,000 Kelvin will be  elided.  These are typically at the deepest level, where optical depth is very large, and have  minimal impact on the surface spectrum.  They are ignored by default because Korg&#39;s default  partition and molecular equillibrium functions are tabulated only up to that tempurature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/atmosphere.jl#L59-L70">source</a></section></article><h1 id="Secondary-functions"><a class="docs-heading-anchor" href="#Secondary-functions">Secondary functions</a><a id="Secondary-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Secondary-functions" title="Permalink"></a></h1><p>You don&#39;t need use these to synthesize spectra, but they might be relevant depending on what you are  doing.</p><h2 id="Postprocessing"><a class="docs-heading-anchor" href="#Postprocessing">Postprocessing</a><a id="Postprocessing-1"></a><a class="docs-heading-anchor-permalink" href="#Postprocessing" title="Permalink"></a></h2><p>These are used to transform observational or synthetic spectra.</p><article class="docstring"><header><a class="docstring-binding" id="Korg.rectify" href="#Korg.rectify"><code>Korg.rectify</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rectify(flux, wls; bandwidth=50, q=0.95, wl_step=1.0)</code></pre><p>Rectify the spectrum with flux vector <code>flux</code> and wavelengths <code>wls</code> by dividing out a moving <code>q</code>-quantile with window size <code>bandwidth</code>.  <code>wl_step</code> controls the size of the grid that the moving  quantile is calculated on and interpolated from.  Setting <code>wl_step</code> to 0 results in the exact  calculation with no interpolation, but note that this is very slow.  </p><p>Experiments on real spectra show an agreement between the interpolated rectified spectrum and the  &quot;exact&quot; one (with default values) at the 3 × 10^-4 level.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/utils.jl#L33-L43">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.constant_R_LSF" href="#Korg.constant_R_LSF"><code>Korg.constant_R_LSF</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">constant_R_LSF(flux, wls, R)</code></pre><p>Applies a gaussian line spread function the the spectrum with flux vector <code>flux</code> and wavelength vector <code>wls</code> with constant spectral resolution, <span>$R = \lambda/\Delta\lambda.$</span></p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This is a naive, slow implementation.  Do not use it when performance matters.</p><p><code>constant_R_LSF</code> will have weird behavior if your wavelength grid is not locally linearly-spaced. It is intended to be run on a fine wavelength grid, then downsampled to the observational (or  otherwise desired) grid.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/utils.jl#L6-L18">source</a></section></article><h2 id="Line-absorption"><a class="docs-heading-anchor" href="#Line-absorption">Line absorption</a><a id="Line-absorption-1"></a><a class="docs-heading-anchor-permalink" href="#Line-absorption" title="Permalink"></a></h2><p>These functions can be used to directly compute line opacities. </p><article class="docstring"><header><a class="docstring-binding" id="Korg.line_absorption!" href="#Korg.line_absorption!"><code>Korg.line_absorption!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">line_absorption(linelist, λs, temp, nₑ, n_densities, partition_fns, ξ
               ; α_cntm=nothing, cutoff_threshold=1e-3, window_size=20.0*1e-8)</code></pre><p>Calculate the opacity coefficient, α, in units of cm^-1 from all lines in <code>linelist</code>, at wavelengths <code>λs</code> [cm^-1]. </p><p>other arguments:</p><ul><li><code>temp</code> the temerature in K</li><li><code>n_densities</code>, a Dict mapping species to absolute number density [cm^-3].</li><li><code>partition_fns</code>, a Dict containing the partition function of each species</li><li><code>ξ</code> is the microturbulent velocity in cm/s (n.b. NOT km/s)</li></ul><p>The three keyword arguments specify how the size of the window over which each line is calculated  is chosen.  </p><ul><li>If <code>α_cntm</code> is passed as a callable returning the continuum opacity as a function of  wavelength, the line window will extend to 4 doppler widths or the wavelength at which the Lorentz wings of the line are at <code>cutoff_threshold * α_cntm[line.wl]</code>, whichever is greater.    <code>cutoff_threshold</code> defaults to 1e-3.  </li><li>if <code>α_cntm</code> is not passed, defaults to <code>window_size</code>, which is 2e-7 (in cm, i.e. 20 Å) unless otherwise specified</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/line_opacity.jl#L5-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.line_profile" href="#Korg.line_profile"><code>Korg.line_profile</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">line_profile(λ₀, invΔλ_D, Δλ_L, line_amplitude, λ)</code></pre><p>A voigt profile centered on λ₀ with doppler width <code>invΔλ_D</code> = 1/Δλ<em>D and lorentz width `Δλ</em>L<code>evaluated at</code>λ` (cm).  Note that this returns values in units of cm^-1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/line_opacity.jl#L287-L292">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.hydrogen_line_absorption" href="#Korg.hydrogen_line_absorption"><code>Korg.hydrogen_line_absorption</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">hydrogen_line_absorption(λs, T, nₑ, nH_I, UH_I, hline_stark_profiles, ξ; 
                              stark_window_size=3e-7, self_window_size=1e-6)</code></pre><p>Calculate contribution to the the absorption coefficient, α, from hydrogen lines in units of cm^-1, at wavelengths <code>λs</code>.</p><p>Arguments:</p><ul><li><code>T</code>: temperature [K]</li><li><code>nₑ</code>: electron number density [cm^-3]</li><li><code>nH_I</code>: neutral hydrogen number density [cm^-3]</li><li><code>hline_stark_profiles</code>: (returned by setup<em>hline</em>stark_profiles`)</li><li><code>ξ</code>: microturbulent velocity [cm/s]. This is only applied to Hα-Hγ.  Other hydrogen lines profiles   are dominated by stark broadening, and the stark broadened profiles are pre-convolved with a   doppler profile.</li><li><code>stark_window_size</code>: the max distance from each line center [cm] at which to calculate the line   absorption for lines besides Hα-Hγ (those dominated by stark broadening).</li><li><code>self_window_size</code>: the max distance from each line center [cm] at which to calculate the line   absorption for Hα-Hγ (those dominated by self-broadening).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/line_opacity.jl#L145-L164">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.setup_hydrogen_stark_profiles" href="#Korg.setup_hydrogen_stark_profiles"><code>Korg.setup_hydrogen_stark_profiles</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">load_hydrogen_stark_profiles()</code></pre><p>Load the (doppler-convolved) Stark-broadening profiles from disk.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/line_opacity.jl#L110-L114">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.voigt" href="#Korg.voigt"><code>Korg.voigt</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">voigt(α, v)</code></pre><p>The <a href="https://en.wikipedia.org/wiki/Voigt_profile#Voigt_functions">voigt function</a>, <span>$H$</span>. Approximation from Hunger 1965.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/line_opacity.jl#L316-L321">source</a></section></article><h2 id="Continuum-absorption"><a class="docs-heading-anchor" href="#Continuum-absorption">Continuum absorption</a><a id="Continuum-absorption-1"></a><a class="docs-heading-anchor-permalink" href="#Continuum-absorption" title="Permalink"></a></h2><p>These function can be used to directly compute continuum absorption coefficients.</p><h5 id="Continuum-Absorption-Kwargs"><a class="docs-heading-anchor" href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a><a id="Continuum-Absorption-Kwargs-1"></a><a class="docs-heading-anchor-permalink" href="#Continuum-Absorption-Kwargs" title="Permalink"></a></h5><p>All bound-free and free-free absorption functions (other than <code>absorption_coef_bf_TOPBase</code>) support the following keyword arguments:</p><ul><li><code>error_oobounds::Bool</code>: specifies the function&#39;s behavior when it encounters invalid <code>ν</code> or <code>T</code> values. When <code>false</code> (the default), the function assumes that the absorption coefficient for these invalid <code>ν</code> or <code>T</code> values is <code>0.0</code>. Otherwise, a <code>DomainError</code> is thrown when invalid <code>ν</code> or <code>T</code> values are encountered.</li><li><code>out_α::Union{Nothing,AbstractVector}</code>: When this is <code>nothing</code> (the default case), the function will simply allocate a new vector to store the output continuum absorption coefficients. Alternatively, this can be a vector (with the same length as the function&#39;s <code>ν</code> argument). In this case, the function will directly add the computed continuum absorption to the elements of this vector, in-place (the vector is also returned by the function).</li></ul><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.total_continuum_absorption" href="#Korg.ContinuumAbsorption.total_continuum_absorption"><code>Korg.ContinuumAbsorption.total_continuum_absorption</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">total_continuum_absorption(νs, T, nₑ, number_densities, partition_funcs; error_oobounds)</code></pre><p>The total continuum linear absoprtion coefficient, α, at many frequencies, ν.</p><p><strong>Arguments</strong></p><ul><li><code>νs</code> are frequencies in Hz</li><li><code>T</code> is temperature in K</li><li><code>nₑ</code> is the electron number density in cm^-3</li><li><code>number_densities</code> is a <code>Dict</code> mapping each <code>Species</code> to its number density</li><li><code>partition_funcs</code> is a <code>Dict</code> mapping each <code>Species</code> to its partition function (e.g. <code>Korg.partition_funcs</code>)</li><li><code>error_oobounds::Bool</code> specifies the behavior of most continnum absorption sources when passed  frequencies or temperature values that are out of bounds for their implementation. When <code>false</code>  (the default), those absorption sources are ignored at those values. Otherwise, an error is  thrown.</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For efficiency reasons, <code>νs</code> must be sorted. While this function technically supports any  sorted <code>AbstractVector</code>, it is most effient when passed an  <code>AbstractRange</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/ContinuumAbsorption.jl#L27-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.H_I_bf" href="#Korg.ContinuumAbsorption.H_I_bf"><code>Korg.ContinuumAbsorption.H_I_bf</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">H_I_bf(ν, T, nH_I_div_partition, [ion_energy], [nmax_explicit_sum], [integrate_high_n];
       kwargs...)</code></pre><p>Compute the bound-free linear absorption coefficient contributed by all energy states of a neutral Hydrogen atom.</p><p><strong>Required Arguments</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nH_I_div_partition</code> is the total number density of neutral Hydrogen divided by the its  partition function.</li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>ion_energy</code>: The ionization energy of Hydrogen. By default, this is set to the values loaded  into the global <code>ionization_energies</code> list.</li><li><code>nmax_explicit_sum</code>: The highest energy level whose absorption contribution is included  in the explicit sum. The contributions from higher levels are included in an integral.</li><li><code>integrate_high_n::bool</code>: When this is <code>false</code>, bf absorption from higher energy states are not  estimated at all. Default is <code>true</code>.</li></ul><p>For a description of the kwargs, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</p><p><strong>Notes</strong></p><p>This function wraps <a href="#Korg.ContinuumAbsorption.hydrogenic_ff_absorption"><code>hydrogenic_ff_absorption</code></a>. See that function for implementation details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/absorption_H.jl#L15-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.H_I_ff" href="#Korg.ContinuumAbsorption.H_I_ff"><code>Korg.ContinuumAbsorption.H_I_ff</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">H_I_ff(ν, T, nH_II, ne; kwargs...)</code></pre><p>Compute the H I free-free linear absorption coefficient α.</p><p>The naming scheme for free-free absorption is counter-inutitive. This actually refers to the reaction:  <code>photon + e⁻ + H II -&gt; e⁻ + H II</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nH_II</code>: the number density of ionized Hydrogen in cm⁻³.</li><li><code>ne</code>: the number density of free electrons.</li></ul><p>For a description of the kwargs, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</p><p><strong>Notes</strong></p><p>This function wraps <a href="#Korg.ContinuumAbsorption.hydrogenic_ff_absorption"><code>hydrogenic_ff_absorption</code></a>. See that function for implementation details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/absorption_H.jl#L47-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.Hminus_bf" href="#Korg.ContinuumAbsorption.Hminus_bf"><code>Korg.ContinuumAbsorption.Hminus_bf</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Hminus_bf(ν, T, nH_I_div_partition, ne, [ion_energy_H⁻]; kwargs...)</code></pre><p>Compute the H⁻ bound-free linear absorption coefficient α</p><p><strong>Arguments</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nH_I_div_partition</code>: the total number density of H I divided by its partition function.</li><li><code>ne</code>: the electron number density</li><li><code>ion_energy_H⁻</code>: Specifies the ionization energy of the single state of H⁻ in eV. This is  roughly 0.7552 eV.</li></ul><p>For a description of the kwargs, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</p><p><strong>Notes</strong></p><p>This function assumes that n(H⁻) ≪ n(H I) + n(H II). The number density of n(H⁻) should not be pre-computed (instead it&#39;s computed internally by this function).</p><p>This function is adapted from equation 8.12 from Grey (2005). That equation specifies the absorption coefficient per H I atom (uncorrected by stimulated emission) as:</p><p><span>$8.316 \times 10^{-10} \sigma_{bf}(H^-) P_e \theta^{2.5} 10^{(\theta \chi_{\mathrm{H}^-})} U(H⁻,T)/ U(H I,T)$</span></p><p>where:</p><ul><li><span>$\sigma_{bf}(\mathrm{H}^-)$</span> is the photo dissociation cross-section (Grey uses the variable <span>$\alpha_{bf}$</span> in place of <span>$\sigma_{bf}$</span>). We estimate this by linearly interpolating data from [Wishart (1979)].</li><li><span>$\chi_{\mathrm{H}^-}$</span> is the ionization enrgy of H⁻.</li><li>θ = log10(e)/(k*T) or θ = 5040/T in units of eV⁻¹</li><li>U(H⁻,T) is the partition function of H⁻ at temperature T. This is always 1</li><li>U(H I,T) is the partition function of H I at temperature T. This is 2 at low to intermediate T.</li></ul><p>Eqn 8.12 of Grey (2005) implicitly assumes that (U(H⁻,T)/ U(H I,T)) is always equal to 0.5.</p><p>This expression is simply a rewritten form of <span>$\sigma_{bf}(H^-) n(H^-)/n(H I),$</span> where <span>$n(H^-)/n(H I)$</span> has been replaced with the expanded form of the saha equation, in which n₀ = n(H⁻) and n₁ = n(H I).</p><p>Equations 8.18 and 8.19 of Gray (2005), indicate that the H⁻ bound-free opacity (with the stimulated emission correction) is given by:</p><p><span>$\kappa_\nu = \sigma_{bf}(H^-) \frac{n(H^-)}{n(H I)} (1 - \exp \left( \frac{-h\nu}{k T}\right)) \frac{n(H I)}{n(H I) + n(H II)} \frac{n(H I) + n(H II)}{\rho}$</span></p><p>In other words, the linear absorption coefficient is: <span>$\alpha_\nu = \sigma_{bf}(H^-) n(H⁻) (1 - \exp \left( \frac{-h\nu}{k T}\right))$</span></p><p>Wishart (1979) expects the tabulated data to have better than 1% percent accuracy. Mathisen (1984) suggests that this data has better than 3% accuracy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/absorption_H.jl#L159-L206">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.Hminus_ff" href="#Korg.ContinuumAbsorption.Hminus_ff"><code>Korg.ContinuumAbsorption.Hminus_ff</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Hminus_ff(ν, T, nH_I_div_partition, ne; kwargs...)</code></pre><p>Compute the H⁻ free-free linear absorption coefficient α</p><p>The naming scheme for free-free absorption is counter-inutitive. This actually refers to the reaction:  photon + e⁻ + H I -&gt; e⁻ + H I.</p><p><strong>Arguments</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nH_I_div_partition::Flt</code>: the total number density of H I divided by its partition function.</li><li><code>ne</code>: the number density of free electrons.</li></ul><p>For a description of the kwargs, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</p><p><strong>Notes</strong></p><p>This is taken from equation 8.13 of Gray (2005). The equation uses a polynomial fig against Table 1 of <a href="https://doi.org/10.1088/0022-3700/20/4/019">Bell &amp; Berrington&#39;s (1987)</a>, which tabulates values for &quot;the H⁻ absorption coefficient&quot; (the values include the correction for stimulated emission). We denote this quantity as <code>f(H⁻)</code> (Grey instead denotes it with the variable, <span>$\alpha_{ff}(H^-)$</span>). The polynomial fits <code>f(H⁻)</code> in the range 2520 K ≤ T ≤ 10080 K and 2604 Å ≤ λ ≤ 113918 Å. According to Grey, the polynomial fit to the tabulated data typically has 1% precision. We find that at worst, the discrepancy never exceeds 2.25%.</p><p>Based on equations 8.13, 8.18, and 8.19 of Gray (2005), the free-free linear absorption coefficient of H⁻ is given by: <code>α = f(H⁻) * Pₑ * n(H I)</code>.</p><p>Based on Section 5.3 from Kurucz (1970), I&#39;m fairly confident that the &quot;more correct&quot; version of this equation should actually read <code>α = f(H⁻) * Pₑ * n(H I, n = 1)</code>, and that the form inferred from Gray (2005) implicitly assumes that <code>n(H I, n = 1) ≈ n(H I)</code>. In detail, the Boltzmann equation relates <code>n(H I, n = 1)</code> and <code>n(H I)</code> as: <code>n(H I, n = 1) = n(H I)*gₙ₌₁/U(T)*exp(-Eₙ₌₁/(k*T)) = n(H I) * 2/U(T)*exp(0) = n(H I) * 2/U(T).</code> Based on the values of the partition function in Table D.2 of Grey, this approximation seems fairly good. It only introduces a ≤0.5% overestimate in n(H I, n = 1) over the temperature range where the polynomial is valid.</p><p>We also considered the polynomial fit in Section 5.3 from Kurucz (1970). Unfortunately, it seems to be wrong (it gives lots of negative numbers).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/absorption_H.jl#L241-L282">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.H2plus_bf_and_ff" href="#Korg.ContinuumAbsorption.H2plus_bf_and_ff"><code>Korg.ContinuumAbsorption.H2plus_bf_and_ff</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">H2plus_bf_and_ff(ν, T, nH_I_div_partition, n_HII; kwargs...)</code></pre><p>Compute the combined H₂⁺ bound-free and free-free linear absorption coefficient α using the tables  from <a href="https://ui.adsabs.harvard.edu/abs/1994ApJ...430..360S/abstract">Stancil 1994</a>.</p><p><strong>Arguments</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nH_I</code>: the total number density of H I divided by its partition   function.</li><li><code>nH_II</code>: the number density of H II (not of H₂⁺).</li></ul><p>For a description of the kwargs, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</p><p><strong>Notes</strong></p><p>This computes the H₂⁺ number density from those of H I and H II, since ionized molecules  are not included in the molecular equlibrium calculation.  Stancil provides approximate equilibrium  constants, K, for the molecule, but the Barklem and Collet values used elsewhere by Korg may be more  reliable.  Once ionized molecules are fully supported, those values should be used instead. While  cross sections are tabulated down to only 3150 K, the cross sections could be linearly interpolated  1000 K or so lower, if reliable K values are availble.</p><p>Because n(H₂⁺) is computed on the fly, the &quot;cross-sections&quot; used (internally) by this function have units of  cm^-5, since they must be multiplied by n(H I) and n(H II) to obtain absorption coefficients.</p><p>Stancil, <a href="https://ui.adsabs.harvard.edu/abs/1952MNRAS.112...40B/abstract">Bates (1952)</a>, and Gray (2005) all use n(H I), but Kurucz (1970) notes in section 5.2 that the photodisociation of H₂⁺  produces a ground state H atom and that we should therefore use n(H I, n=1) instead. This difference  causes a descrepancy of a fraction of a percent (at most) for T ≤ 1.2e4 K. Here we use n(H I).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/absorption_H.jl#L299-L329">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.He_II_bf" href="#Korg.ContinuumAbsorption.He_II_bf"><code>Korg.ContinuumAbsorption.He_II_bf</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">He_II_bf(ν, T, nHe_I_div_partition, [ion_energy], [nmax_explicit_sum], [integrate_high_n];
         kwargs...)</code></pre><p>Compute the bound-free linear absorption coefficient contributed by all energy states of a singly-ionized Helium atom.</p><p><strong>Required Arguments</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nHe_II_div_partition</code> is the total number density of singly-ionized Helium divided by the its  partition function.</li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>ion_energy</code>: The ionization energy of Helium. By default, this is set to the values loaded  into the global <code>ionization_energies</code> list.</li><li><code>nmax_explicit_sum</code>: The highest energy level whose absorption contribution is included  in the explicit sum. The contributions from higher levels are included in an integral.</li><li><code>integrate_high_n::bool</code>: When this is <code>false</code>, bf absorption from higher energy states are not  estimated at all. Default is <code>true</code>.</li></ul><p>For a description of the kwargs, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</p><p><strong>Notes</strong></p><p>This function simply wraps <a href="#Korg.ContinuumAbsorption.hydrogenic_ff_absorption"><code>hydrogenic_ff_absorption</code></a>. See that function for additional details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/absorption_He.jl#L16-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.He_II_ff" href="#Korg.ContinuumAbsorption.He_II_ff"><code>Korg.ContinuumAbsorption.He_II_ff</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">He_II_ff(ν, T, nHe_III, ne; kwargs...)</code></pre><p>Compute the He II free-free linear absorption coefficient α.</p><p>The naming scheme for free-free absorption is counter-inutitive. This actually refers to the reaction:  <code>photon + e⁻ + He III -&gt; e⁻ + He III</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nH_III</code>: the number density of doubly-ionized Helium in cm⁻³.</li><li><code>ne</code>: the number density of free electrons.</li></ul><p>For a description of the kwargs, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</p><p><strong>Notes</strong></p><p>This function wraps <a href="#Korg.ContinuumAbsorption.hydrogenic_ff_absorption"><code>hydrogenic_ff_absorption</code></a>. See that function for implementation details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/absorption_He.jl#L48-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.Heminus_ff" href="#Korg.ContinuumAbsorption.Heminus_ff"><code>Korg.ContinuumAbsorption.Heminus_ff</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Heminus_ff(ν, T, nHe_I_div_partition, ne; kwargs...)</code></pre><p>Compute the He⁻ free-free opacity κ.</p><p>The naming scheme for free-free absorption is counter-inutitive. This actually refers to the reaction:  <code>photon + e⁻ + He I -&gt; e⁻ + He I.</code></p><p><strong>Arguments</strong></p><ul><li><code>ν::AbstractVector{&lt;:Real}</code>: sorted frequency vector in Hz</li><li><code>T</code>: temperature in K</li><li><code>nHe_I_div_partition</code>: the total number density of H I divided by its partition function.</li><li><code>ne</code>: the number density of free electrons.</li></ul><p>For a description of the kwargs, see <a href="#Continuum-Absorption-Kwargs">Continuum Absorption Kwargs</a>.</p><p><strong>Notes</strong></p><p>This follows equation 8.16 of Grey (2005) which provides a polynomial fit absorption to data tabulated in <a href="https://ui.adsabs.harvard.edu/abs/1994MNRAS.269..871J/abstract">John (1994)</a>. According to that equation, the &quot;continuous absorption coefficient per Hydrogen&quot; is given by:</p><pre><code class="language-none">    f(He⁻_ff)*Pₑ*A(He) / (1 + Φ(He)/Pₑ)</code></pre><p>in which</p><ul><li><code>log_10(f(He⁻_ff))</code> is the polynomial term (Grey actually uses the variable α in place of f)</li><li>A(He) is the number abundance of Helium particles relative to Hydrogen particles. For reference,<pre><code class="language-none">A(He) = [n(He I) + n(He II) + n(He III)] / [n(H I) + n(H II)]</code></pre></li><li>Pₑ is the partial pressure contributed by electrons. For reference, <code>Pₑ = nₑ*kb * T</code>.</li><li><code>1/(1 + Φ(He)/Pₑ)</code> comes from the Saha equation and expresses <code>n(He I) / [n(He I) + n(He II)]</code>.</li></ul><p>In the above expression, f(He⁻_ff)*Pₑ specifies the free-free atomic absorption coefficient per ground state He I atom. The expression seems to implicitly assume that</p><ul><li>approximately all He I is in the ground state</li><li><code>n(He I) / [n(He I) + n(He II)]</code> is roughly <code>n(He I) / [n(He I) + n(He II) + n(HeIII)]</code></li></ul><p>(at least for the range of temperatures where f can be accurately computed).</p><p>To convert the expression to opacity, Grey divided it by the product of the mean molecular weight and the Hydrogen mass. With that in mind, we can write the equation for linear absorption coefficient, α<em>ν, (removing the apparent assumptions) as `α</em>ν = f(He⁻_ff)<em>Pₑ</em>n(He I, n=1).`</p><p>For 5063 Å ≤ λ ≤ 151878 Å and 2520 K ≤ T ≤ 10080 K, Gray (2005) claims that the polynomial fit the tabulated data at a precision of 1% or better. In practice, we found that it only fits the data to better than 3.1% (it&#39;s possible that for smaller λ the fit may be better). For reference, the tabulated data in these ranges of values consist of an irregularly spaced rectangular grid with 15 λ values and 9 Temperature values. According to John (1994), improved calculations are unlikely to alter the tabulated data for λ &gt; 1e4Å, &quot;by more than about 2%.&quot; The errors introduced by the approximations for 5.06e3 Å ≤ λ ≤ 1e4 Å &quot;are expected to be well below 10%.&quot;</p><p>An alternative approach using a fit to older data is provided in section 5.7 of Kurucz (1970).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/absorption_He.jl#L119-L171">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.electron_scattering" href="#Korg.ContinuumAbsorption.electron_scattering"><code>Korg.ContinuumAbsorption.electron_scattering</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">electron_scattering(nₑ)</code></pre><p>Compute the linear absorption coefficient, α, from scattering off of free electrons. This has no wavelength dependence. It assumes isotropic scattering.  (See, e.g. Gray p 160.)</p><p><strong>Arguments</strong></p><ul><li><code>nₑ::F</code>: number density of free electrons (in cgs)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/scattering.jl#L44-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.rayleigh" href="#Korg.ContinuumAbsorption.rayleigh"><code>Korg.ContinuumAbsorption.rayleigh</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rayleigh(λs, nH_I, nHe_II, nH2)</code></pre><p>Absorption coefficient from Rayleigh scattering by neutral H, He, and H2.  Formulations for H and He are via <a href="https://ui.adsabs.harvard.edu/abs/2016ApJ...817..116C/abstract">Colgan+ 2016</a>.  Formulation  for H2 from  <a href="https://ui.adsabs.harvard.edu/abs/1962ApJ...136..690D/abstract">Dalgarno and Williams 1962</a>.</p><p>The Dalgarno and Williams H2 is applicable redward of 1300 Å.  Since Rayleigh scattering breaks down when the particle size to wavelength ratio gets large, we that all frequencies passed to this  function be equivalent to 1300 Å or greater.</p><p>The formulations for H is adapted from  <a href="https://ui.adsabs.harvard.edu/abs/1962ApJ...136..690D/abstract">Lee 2005</a>, which states that it is  applicable redward of Lyman alpha. See Colgan 2016 for details on He.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/scattering.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.hydrogenic_bf_absorption" href="#Korg.ContinuumAbsorption.hydrogenic_bf_absorption"><code>Korg.ContinuumAbsorption.hydrogenic_bf_absorption</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">hydrogenic_bf_absorption(ν, T, Z, nmax_explicit_sum, nsdens_div_partition,
                         ion_energy, [integrate_high_n])</code></pre><p>Compute the bound-free linear absorption coefficient contributed by all energy states of a Hydrogenic species</p><p>The calculation is broken into 2 parts: (i) the contributions of the lowest energy states are  explicitly summed and (ii) the contributions of the higher energy states are estimated with an  integral.</p><p><strong>Arguments</strong></p><ul><li><code>ν</code>: frequency in Hz</li><li><code>T</code>: temperature in K</li><li><code>Z::Integer</code>: Z is the atomic number of the species (e.g. 1 for H I or 2 for He II)</li><li><code>nsdens_div_partition</code> is the total number density of the species divided by the species&#39;s  partition function.</li><li><code>ion_energy</code>: the ionization energy from the ground state (in eV). This can be   estimated as Z²*Rydberg<em>H (Rydberg</em>H is the ionization energy of Hydrogen)</li><li><code>nmax_explicit_sum::Integer</code>: The highest energy level whose absorption contribution is included  in the explicit sum. The contributions from higher levels are included in the integral.</li><li><code>integrate_high_n::bool</code>: When this is <code>false</code>, bf absorption from higher energy states are not  estimated at all. Default is <code>true</code>.</li></ul><p><strong>Notes</strong></p><p>This follows the approach described in section 5.1 of Kurucz (1970).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/hydrogenic_bf_ff.jl#L142-L168">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.ContinuumAbsorption.hydrogenic_ff_absorption" href="#Korg.ContinuumAbsorption.hydrogenic_ff_absorption"><code>Korg.ContinuumAbsorption.hydrogenic_ff_absorption</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">hydrogenic_ff_absorption(ν, T, Z, ni, ne)</code></pre><p>computes the free-free linear absorption coefficient for a hydrogenic species</p><p>The naming convention for free-free absorption is counter-intuitive. A free-free interaction is named as though the species interacting with the free electron had one more bound electron (in  other words it&#39;s named as though the free-electron and ion were bound together). In practice, this means that <code>ni</code> should refer to:</p><ul><li>the number density of H II if computing the H I free-free absorption</li><li>the number density of He III if computing the He II free-free absorption</li><li>the number density of Li IV if computing the Li III free-free absorption</li></ul><p><strong>Arguments</strong></p><ul><li><code>Z::Integer</code>: the charge of the ion. For example, this is 1 for ionized H.</li><li><code>ni</code>: the number density of the ion species in cm⁻³.</li><li><code>ne</code>: the number density of free electrons.</li><li><code>ν</code>: frequency in Hz</li><li><code>T</code>: temperature in K</li></ul><p><strong>Note</strong></p><p>This approach was adopted from equation 5.8 from section 5.1 of Kurucz (1970). Comparison against equation 5.18b of Rybicki &amp; Lightman (2004), reveals that the equation in Kurucz (1970) omits the dependence on ρ. According to Rybicki &amp; Lightman (2004) the free-free absorption coefficient (corrected for stimulated emission) is:</p><pre><code class="language-none">    α = coef * Z² *ne * ni * (1 - exp(-hplanck*ν/(kboltz*T))) * g_ff / (sqrt(T) * ν³)</code></pre><p>Note that the g_ff is the free-free gaunt factor and coef is ∼3.7e8 (a more exact coefficient can be computed from eqn 5.18a).</p><p>With this in mind, equation 5.8 of Kurucz (1970) should actually read</p><pre><code class="language-none">    κ = ne * n(H II) * F_ν(T) * (1 - exp(-hplanck*ν/(kboltz*T))) / ρ</code></pre><p>where F<em>ν(T) = coef * Z² * g</em>ff / (sqrt(T) * ν³).</p><p>See <code>gaunt_ff_vanHoof</code> for details about where our gaunt factor data comes from. For simplicity, we enforce temperature and ν bounds constraints that don&#39;t include all of the available gaunt factor data. In practice, this should never be a concern for stellar spectroscopy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/continuum_absorption/hydrogenic_bf_ff.jl#L307-L347">source</a></section></article><h2 id="Statistical-mechanics"><a class="docs-heading-anchor" href="#Statistical-mechanics">Statistical mechanics</a><a id="Statistical-mechanics-1"></a><a class="docs-heading-anchor-permalink" href="#Statistical-mechanics" title="Permalink"></a></h2><p>These functions can be used to calculate the number densities of all species in a given atospheric  layer, or other statmech calculations. </p><article class="docstring"><header><a class="docstring-binding" id="Korg.saha_ion_weights" href="#Korg.saha_ion_weights"><code>Korg.saha_ion_weights</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">saha_ion_weights(T, nₑ, atom, ionization_energies, partition_functions)</code></pre><p>Returns <code>(wII, wIII)</code>, where <code>wII</code> is the ratio of singly ionized to neutral atoms of a given  element, and <code>wIII</code> is the ration of doubly ionized to neutral atoms.</p><p>arguments:</p><ul><li>temperature <code>T</code> [K]</li><li>electron number density <code>nₑ</code> [cm^-3]</li><li>atom, the atomic number of the element </li><li><code>ionization_energies</code> is a collection indexed by integers (e.g. a <code>Vector</code>) mappping elements&#39;   atomic numbers to their first three ionization energies</li><li><code>partition_funcs</code> is a <code>Dict</code> mapping species to their partition functions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/statmech.jl#L3-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.molecular_equilibrium_equations" href="#Korg.molecular_equilibrium_equations"><code>Korg.molecular_equilibrium_equations</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">molecular_equilibrium_equations(absolute_abundances, ironization_energies, partiation_fns, equilibrium_constants)</code></pre><p>Returns a NamedTuple representing the system of equations specifying molecular equilibrium.</p><p>arguments:</p><ul><li>A Dict of <code>absolute_abundances</code>, N<em>X/N</em>total</li><li>a Dict of ionization energies, <code>ionization_energies</code>.  The keys of act as a list of all atoms.</li><li>a Dict of partition functions, <code>partition_fns</code></li><li>a Dict of log molecular equilibrium constants, <code>equilibrium_constants</code>, in partial pressure form.  The keys of <code>equilibrium_constants</code> act as a list of all molecules.</li></ul><p>The system of equations is specified with the number densities of the neutral atoms as free  parameters.  Each equation specifies the conservation of a particular species, e.g. (simplified)</p><pre><code class="language-none">n(O) = n(CO) + n(OH) + n(O I) + n(O II) + n(O III).</code></pre><p>In this equation:</p><ul><li><code>n(O)</code>, the number density of oxygen atoms in any form comes <code>absolute_abundances</code> and the total</li></ul><p>number density (supplied later)</p><ul><li><code>n(O I)</code> is a free parameter.  The numerical solver is varying this to satisfy the system of  equations.</li><li><code>n(O II)</code>, and <code>n(O III)</code> come from the Saha (ionization) equation given <code>n(O I)</code></li><li><code>n(CO)</code> and <code>n(OH)</code> come from the molecular equilibrium constants K, which are precomputed  over a range of temperatures. </li></ul><p>Equilibrium constants are defined in terms of partial pressures, so e.g.</p><pre><code class="language-none">K(OH)  ==  (p(O) p(H)) / p(OH)  ==  (n(O) n(H)) / n(OH)) kT</code></pre><p>This could also be computed via a Saha equation involving the molecular partition function and  dissolution energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/statmech.jl#L52-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.molecular_equilibrium" href="#Korg.molecular_equilibrium"><code>Korg.molecular_equilibrium</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">molecular_equilibrium(MEQS, T, nₜ, nₑ; x0)</code></pre><p>Iteratively solve for the number density of each species. Returns a <code>Dict</code> mapping species to number  densities.</p><p>arguments:</p><ul><li>the system of molecular equilibrium equations <code>MEQs</code> (the thing returned by </li></ul><p><code>molecular_equilibrium_equations</code>)</p><ul><li>the temperature <code>T</code>, </li><li>the number density of non-electron particles <code>nₜ</code></li><li>the electron number density <code>nₑ</code></li><li>optionally, <code>x0</code>, a starting point for the solver</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/statmech.jl#L120-L133">source</a></section></article><h2 id="Misc"><a class="docs-heading-anchor" href="#Misc">Misc</a><a id="Misc-1"></a><a class="docs-heading-anchor-permalink" href="#Misc" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Korg.blackbody" href="#Korg.blackbody"><code>Korg.blackbody</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">blackbody(T, λ)</code></pre><p>The value of the Planck blackbody function for temperature <code>T</code> at wavelength <code>λ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/synthesize.jl#L186-L190">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.get_absolute_abundances" href="#Korg.get_absolute_abundances"><code>Korg.get_absolute_abundances</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">get_absolute_abundances(metallicity, A_X)</code></pre><p>Calculate <span>$n_X/n_\mathrm{total}$</span> for each element X given some specified abundances, <span>$A(X)$</span>.  Use the  metallicity [<span>$X$</span>/H] to calculate those remaining from the solar values (except He).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/synthesize.jl#L152-L157">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.air_to_vacuum" href="#Korg.air_to_vacuum"><code>Korg.air_to_vacuum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">air_to_vacuum(λ; cgs=λ&lt;1)</code></pre><p>Convert λ from an air wavelength to a vacuum wavelength.   λ is assumed to be in Å if it is ⩾ 1, in cm otherwise. Formula from Birch and Downs (1994) via the VALD website.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/utils.jl#L57-L63">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Korg.vacuum_to_air" href="#Korg.vacuum_to_air"><code>Korg.vacuum_to_air</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">vacuum_to_air(λ; cgs=λ&lt;1)</code></pre><p>convert λ from a vacuum wavelength to an air wavelength λ is assumed to be in Å if it is ⩾ 1, in cm otherwise. Formula from Birch and Downs (1994) via the VALD website.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ajwheeler/Korg.jl/blob/f670ac271790d8b4895cc4445443268e626a8ec2/src/utils.jl#L76-L82">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Quickstart</a><a class="docs-footer-nextpage" href="../devdocs/">Developer Documentation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 30 November 2021 21:53">Tuesday 30 November 2021</span>. Using Julia version 1.6.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
